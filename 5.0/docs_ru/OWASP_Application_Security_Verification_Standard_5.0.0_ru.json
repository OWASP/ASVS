{
  "Name": "Application Security Verification Standard Project",
  "ShortName": "ASVS",
  "Version": "5.0.0",
  "Description": "The Application Security Verification Standard is a list of application security requirements that architects, developers, testers, security professionals, tool vendors, and consumers can use to define, build, test, and verify secure applications.",
  "Requirements": [
    {
      "Shortcode": "V1",
      "Ordinal": 1,
      "ShortName": "Кодировка",
      "Name": "Кодировка и нейтрализация",
      "Items": [
        {
          "Shortcode": "V1.1",
          "Ordinal": 1,
          "Name": "Архитектура кодировки и нейтрализации",
          "Items": [
            {
              "Shortcode": "V1.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что входные данные декодируются или деэкранируются в каноническую форму (в стандартное представление) только один раз. Декодирование происходит только тогда, когда ожидаются закодированные данные в этой форме, и что это делается перед дальнейшей обработкой входных данных, например, это не выполняется после проверки или нейтрализации.",
              "L": "2"
            },
            {
              "Shortcode": "V1.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что приложение выполняет кодирование и экранирование выходных данных либо в качестве последнего шага перед использованием интерпретатором, для которого оно предназначено, либо самим интерпретатором.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V1.2",
          "Ordinal": 2,
          "Name": "Предотвращение инъекций",
          "Items": [
            {
              "Shortcode": "V1.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что выходная кодировка для ответа HTTP, документа HTML или документа XML соответствует требуемому контексту, например, кодировка соответствующих символов для элементов HTML, атрибутов HTML, комментариев HTML, CSS или полей заголовка HTTP делается таким способом, чтобы избежать изменения структуры сообщения или документа.",
              "L": "1"
            },
            {
              "Shortcode": "V1.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при динамическом построении URL-адресов недоверенные данные кодируются в соответствии с их контекстом (например, кодирование URL-адресов или кодирование base64url для query или path параметров или пути). Убедитесь, что разрешены только безопасные протоколы URL-адресов (например, запрещен javascript: или data:).",
              "L": "1"
            },
            {
              "Shortcode": "V1.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что при динамическом построении содержимого JavaScript (включая JSON) используется кодирование или экранирование выходных данных, чтобы избежать изменения структуры сообщения или документа (чтобы избежать JavaScript и JSON-инъекций).",
              "L": "1"
            },
            {
              "Shortcode": "V1.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что выборка данных (Redis, Memcached, чтение из файлов, обращение по API) или запросы к базе данных (например, SQL, HQL, NoSQL, Cypher) используют параметризованные запросы, ORM, Entity Frameworks или иным образом защищены от SQL-инъекций и других атак. Это также актуально при написании хранимых процедур.",
              "L": "1"
            },
            {
              "Shortcode": "V1.2.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что приложение защищено от внедрения команд ОС и что вызовы операционной системы используют параметризованные запросы к ОС или используют контекстное кодирование вывода командной строки.",
              "L": "1"
            },
            {
              "Shortcode": "V1.2.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что приложение защищено от LDAP-инъекций, или что реализованы специальные меры безопасности для их предотвращения.",
              "L": "2"
            },
            {
              "Shortcode": "V1.2.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что приложение защищено от атак с использованием XPath-инъекций с помощью параметризации запросов или предварительно скомпилированных запросов.",
              "L": "2"
            },
            {
              "Shortcode": "V1.2.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что процессоры LaTeX настроены безопасно (например, не используется флаг \"--shell-escape\") и используется разрешенный список команд для предотвращения LaTeX-инъекций.",
              "L": "2"
            },
            {
              "Shortcode": "V1.2.9",
              "Ordinal": 9,
              "Description": "Убедитесь, что приложение экранирует специальные символы в регулярных выражениях (обычно с помощью обратной косой черты), чтобы предотвратить их ошибочную интерпретацию как метасимволов.",
              "L": "2"
            },
            {
              "Shortcode": "V1.2.10",
              "Ordinal": 10,
              "Description": "Убедитесь, что приложение защищено от внедрения формул CSV (CSV Injection). Приложение должно следовать правилам экранирования, определенным в RFC 4180, разделы 2.6 и 2.7, при экспорте содержимого CSV. Кроме того, при экспорте в CSV или другие форматы электронных таблиц (такие как XLS, XLSX или ODF) специальные символы (включая '=', '+', '-', '@', '\\t' (табуляция), and '\\0' (нулевой символ)) должны экранироваться одинарной кавычкой, если они появляются в качестве первого символа в значении поля.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V1.3",
          "Ordinal": 3,
          "Name": "Нейтрализация",
          "Items": [
            {
              "Shortcode": "V1.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что все ненадежные входные данные HTML из редакторов WYSIWYG или аналогичных программ санитизируются с помощью известных и безопасных библиотек или функций фреймворка для санитизации HTML.",
              "L": "1"
            },
            {
              "Shortcode": "V1.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что приложение избегает использования eval() или других динамических функций выполнения кода, таких как Spring Expression Language (SpEL). Если нет альтернативы, любой пользовательский ввод должен быть санитизирован перед выполнением.",
              "L": "1"
            },
            {
              "Shortcode": "V1.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что данные, передаваемые в потенциально опасный контекст, предварительно санитизированы, чтобы обеспечить соблюдение мер безопасности, таких как разрешение только тех символов, которые безопасны для данного контекста, и обрезка слишком длинного ввода.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что предоставленный пользователем файл .SVG проверен или санитизирован, чтобы он содержал только теги и атрибуты (например, относящиеся к рисованию), которые безопасны для приложения, например, не содержат скриптов и foreignObject.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что приложение санитизирует или отключает предоставленные пользователем скриптовые данные или выражения шаблонных языков, такие как таблицы стилей Markdown, CSS или XSL, BBCode или аналогичные.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что приложение защищено от атак с подделкой запросов на стороне сервера (SSRF), проверяя ненадежные данные по разрешенному списку протоколов, доменов, путей и портов, а также санитизируя потенциально опасные символы перед использованием данных для вызова другой службы.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что приложение защищено от атак с внедрением шаблонов (template injection), не позволяя создавать шаблоны на основе недоверенных входных данных. Если нет альтернативы, любые недоверенные входные данные, включаемые динамически во время создания шаблона, должны быть санитизированы или тщательно провалидированы.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что приложение надлежащим образом санитизирует недоверенные входные данные перед использованием в запросах Java Naming and Directory Interface (JNDI) и что JNDI настроен безопасно для предотвращения атак с использованием JNDI-инъекций.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.9",
              "Ordinal": 9,
              "Description": "Убедитесь, что приложение санитизирует данные перед отправкой в Memcache, чтобы предотвратить атаки методом инъекций.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.10",
              "Ordinal": 10,
              "Description": "Убедитесь, что строки форматирования, которые могут быть использованы неожидаемым или вредоносным образом, санитизируются перед дальнейшим использованием.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.11",
              "Ordinal": 11,
              "Description": "Убедитесь, что приложение санитизирует вводимые пользователем данные перед передачей в почтовые системы для защиты от SMTP или IMAP-инъекций.",
              "L": "2"
            },
            {
              "Shortcode": "V1.3.12",
              "Ordinal": 12,
              "Description": "Убедитесь, что регулярные выражения не содержат элементов, вызывающих экспоненциальный возврат, и убедитесь в санитизации недоверенных входных данных для предотвращения атак ReDoS или Runaway Regex.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V1.4",
          "Ordinal": 4,
          "Name": "Память, строки и неуправляемый код",
          "Items": [
            {
              "Shortcode": "V1.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что для обнаружения или предотвращения ситуаций переполнения стека, буфера или кучи приложение учитывает размер доступной области памяти при строковых операциях, копировании в память, в арифметике указателей и т.п.",
              "L": "2"
            },
            {
              "Shortcode": "V1.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что для предотвращения целочисленного переполнения применяется контроль знака, диапазона и типа допустимых входных данных.",
              "L": "2"
            },
            {
              "Shortcode": "V1.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что динамически выделенная память и ресурсы освобождены, а ссылки или указатели на освобожденную память удалены или установлены в значение null, чтобы предотвратить появление висячих указателей и уязвимостей, связанных с использованием памяти после освобождения.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V1.5",
          "Ordinal": 5,
          "Name": "Безопасная десериализация",
          "Items": [
            {
              "Shortcode": "V1.5.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение настраивает XML-парсеры на использование строгой конфигурации и что небезопасные функции, такие как разрешение внешних сущностей, отключены для предотвращения атак XML eXternal Entity (XXE).",
              "L": "1"
            },
            {
              "Shortcode": "V1.5.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что десериализация недоверенных данных обеспечивает безопасную обработку ввода, например, используя список разрешенных типов объектов или ограничивая типы объектов, определяемые клиентом, для предотвращения атак десериализации. Механизмы десериализации, которые явно определены как небезопасные, не должны использоваться с недоверенным вводом.",
              "L": "2"
            },
            {
              "Shortcode": "V1.5.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что различные парсеры, используемые в приложении для одного и того же типа данных (например, парсеры JSON, XML, URL), выполняют парсинг согласованным образом и используют один и тот же механизм кодирования символов, чтобы избежать таких проблем, как уязвимости взаимодействия JSON (JSON Interoperability) или различное поведение анализа URI или файлов, которые могут использоваться в атаках удаленного включения файлов (RFI) или подделки запросов на стороне сервера (SSRF).",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V2",
      "Ordinal": 2,
      "ShortName": "Валидация",
      "Name": "Валидация и бизнес-логика",
      "Items": [
        {
          "Shortcode": "V2.1",
          "Ordinal": 1,
          "Name": "Документация валидации и бизнес-логики",
          "Items": [
            {
              "Shortcode": "V2.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что в документации приложения определены правила проверки входных данных на соответствие ожидаемой структуре. Это могут быть распространённые форматы данных, такие как номера кредитных карт, адреса электронной почты, номера телефонов, или внутренний формат данных.",
              "L": "1"
            },
            {
              "Shortcode": "V2.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что в документации приложения указано, как проверять логическую и контекстную согласованность объединенных  данных, например, проверять соответствие района и почтового индекса.",
              "L": "2"
            },
            {
              "Shortcode": "V2.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что ожидания относительно ограничений и проверок бизнес-логики задокументированы как для уровня отдельного пользователя, так и для глобального уровня всего приложения.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V2.2",
          "Ordinal": 2,
          "Name": "Валидация ввода",
          "Items": [
            {
              "Shortcode": "V2.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что входные данные провалидированы для обеспечения соответствия бизнес- или функциональным ожиданиям. Валидация должна осуществляться либо по списку допустимых значений, шаблонов и диапазонов, либо путем сравнения входных данных с ожидаемой структурой и логическими ограничениями в соответствии с предопределенными правилами. Для L1 валидация может быть сосредоточена на входных данных, используемых для принятия конкретных бизнес-решений или решений, связанных с безопасностью. Для L2 и выше это должно применяться ко всем входным данным.",
              "L": "1"
            },
            {
              "Shortcode": "V2.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что приложение разработано с принудительной валидацией входных данных на уровне доверенного сервиса. Хотя проверка на стороне клиента повышает удобство использования и должна поощряться, на неё не следует полагаться как на средство контроля безопасности.",
              "L": "1"
            },
            {
              "Shortcode": "V2.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение обеспечивает обоснованность комбинаций данных в соответствии с предопределенными правилам. Например: возраст должен соответствовать дате рождения; страна и почтовый индекс; количество товара в заказе и на складе.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V2.3",
          "Ordinal": 3,
          "Name": "Безопасность бизнес-логики",
          "Items": [
            {
              "Shortcode": "V2.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение обрабатывает потоки бизнес-логики для одного и того же пользователя в ожидаемом последовательном порядке шагов и без пропуска шагов.",
              "L": "1"
            },
            {
              "Shortcode": "V2.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что ограничения бизнес-логики реализованы в соответствии с документацией приложения, чтобы избежать эксплуатации её недостатков.",
              "L": "2"
            },
            {
              "Shortcode": "V2.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что транзакции используются на уровне бизнес-логики таким образом, что операция бизнес-логики либо выполняется полностью, либо откатывается к предыдущему корректному состоянию.",
              "L": "2"
            },
            {
              "Shortcode": "V2.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что на уровне бизнес-логики используются механизмы блокировки, чтобы гарантировать невозможность двойного бронирования ограниченных по количеству ресурсов (например, мест в театре или слотов доставки) путем манипулирования логикой приложения.",
              "L": "2"
            },
            {
              "Shortcode": "V2.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что для важных потоков бизнес-логики требуется многопользовательское (multi-user) одобрение, чтобы предотвратить несанкционированные или случайные действия. Потоки бизнес-логики могут включать, помимо прочего, крупные денежные переводы, утверждение контрактов, доступ к секретной информации или обход ограничений безопасности на производстве.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V2.4",
          "Ordinal": 4,
          "Name": "Анти-автоматизация",
          "Items": [
            {
              "Shortcode": "V2.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что используются средства противодействия автоматизации для защиты от чрезмерных вызовов функций приложения, которые могут привести к утечке данных, созданию ненужных данных, исчерпанию квот, нарушению ограничений скорости, отказу в обслуживании или чрезмерному использованию дорогостоящих ресурсов.",
              "L": "2"
            },
            {
              "Shortcode": "V2.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что потоки бизнес-логики требуют реалистичного человеческого времени, предотвращая чрезмерно быструю отправку транзакций.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V3",
      "Ordinal": 3,
      "ShortName": "Веб",
      "Name": "Безопасность веб-интерфейса",
      "Items": [
        {
          "Shortcode": "V3.1",
          "Ordinal": 1,
          "Name": "Документация по безопасности веб-интерфейса",
          "Items": [
            {
              "Shortcode": "V3.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что в документации приложения описаны ожидаемые функции безопасности, которые должны поддерживать браузеры, использующие приложение (такие как HTTPS, HTTP Strict Transport Security (HSTS), Content Security Policy (CSP) и другие соответствующие механизмы безопасности HTTP). В документации также должно быть обязательно определено, как приложение должно себя вести, если некоторые из этих функций недоступны (например, предупреждать пользователя или блокировать доступ).",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V3.2",
          "Ordinal": 2,
          "Name": "Непреднамеренная интерпретация контента",
          "Items": [
            {
              "Shortcode": "V3.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что реализованы меры безопасности, предотвращающие отображение контента или функций браузерами в HTTP-ответах в некорректном контексте (например, запрос API, загруженный пользователем файл или другой ресурс запрашивается напрямую). Возможные способы контроля включают: не обрабатывать содержимое, если поля заголовка HTTP-запроса (например, Sec-Fetch-*) не указывают на корректность контекста; использование заголовка и значения Content-Security-Policy: sandbox directive; или использование заголовка и значения Content-Disposition: attachment.",
              "L": "1"
            },
            {
              "Shortcode": "V3.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что данные, предназначенные для отображения в виде текста, а не визуализации в виде HTML, обрабатывается с использованием безопасных функций визуализации (таких как createTextNode или textContent), чтобы предотвратить непреднамеренное выполнение содержимого, такого как HTML или JavaScript.",
              "L": "1"
            },
            {
              "Shortcode": "V3.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение избегает затирания DOM при использовании JavaScript на стороне клиента, применяя явные объявления переменных, выполняя строгую проверку типов, избегая сохранения глобальных переменных в объекте документа и реализуя изоляцию пространства имен.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V3.3",
          "Ordinal": 3,
          "Name": "Настройка файлов cookie",
          "Items": [
            {
              "Shortcode": "V3.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что у файлов cookie установлен атрибут «Secure», и если префикс '\\__Host‑' не используется в названии cookie, необходимо использовать префикс '__Secure‑'.",
              "L": "1"
            },
            {
              "Shortcode": "V3.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что значение атрибута SameSite каждой cookie установлено в соответствии с назначением cookie, чтобы ограничить подверженность атакам на восстановление пользовательского интерфейса и атакам с подделкой запросов на уровне браузера, обычно называемым подделкой межсайтовых запросов (CSRF).",
              "L": "2"
            },
            {
              "Shortcode": "V3.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что cookie имеют префикс «__Host‑» в названии, если только они явно не предназначены для совместного использования с другими хостами.",
              "L": "2"
            },
            {
              "Shortcode": "V3.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что если значение cookie не должно быть доступно для клиентских скриптов (например, сессионный токен), для cookie должен быть установлен атрибут «HttpOnly», а само значение должно передаваться клиенту только через поле заголовка «Set-Cookie».",
              "L": "2"
            },
            {
              "Shortcode": "V3.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что при записи cookie приложением общая длина имени и значения cookie не превышает 4096 байт. Слишком большие cookie не будут сохраняться браузером и, следовательно, не будут отправляться с запросами, что помешает пользователю использовать функции приложения, зависящие от этого cookie.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V3.4",
          "Ordinal": 4,
          "Name": "Заголовки механизма безопасности браузера",
          "Items": [
            {
              "Shortcode": "V3.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что поле заголовка Strict‑Transport‑Security включено во все ответы для реализации политики HTTP Strict Transport Security (HSTS). Необходимо указать максимальное время не менее 1 года, а для L2 и выше политика должна применяться также ко всем поддоменам.",
              "L": "1"
            },
            {
              "Shortcode": "V3.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что поле заголовка Cross‑Origin Resource Sharing (CORS) 'Access‑Control‑Allow‑Origin' имеет фиксированное значение, заданное приложением, или, если используется заголовок Origin, оно проверяется по списку доверенных источников. При необходимости использования 'Access‑Control‑Allow‑Origin: *' убедитесь, что ответ не содержит конфиденциальной информации.",
              "L": "1"
            },
            {
              "Shortcode": "V3.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что HTTP-ответы содержат поле заголовка Content-Security-Policy, которое определяет директивы, гарантирующие загрузку и выполнение браузером только доверенного контента или ресурсов, чтобы ограничить выполнение вредоносного JavaScript. Как минимум, необходимо использовать глобальную политику, включающую директивы object-src «none» и base-uri «none», а также определяющую список разрешенных адресов или использующую одноразовые коды или хэши. Для приложений L3 необходимо определить политику использования 'nonce' или hash-конструкций для каждого ответа.",
              "L": "2"
            },
            {
              "Shortcode": "V3.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что все HTTP-ответы содержат поле заголовка «X‑Content‑Type‑Options: nosniff». Это предписывает браузерам не использовать анализ контента и определение типа MIME для данного ответа, а также требовать, чтобы значение поля заголовка Content‑Type в ответе соответствовало целевому ресурсу. Например, ответ на запрос стиля принимается только в том случае, если Content‑Type в ответе — «text/css». Это также позволяет браузеру использовать функцию Cross‑Origin Read Blocking (CORB).",
              "L": "2"
            },
            {
              "Shortcode": "V3.4.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что приложение устанавливает политику реферера для предотвращения утечки технически конфиденциальных данных сторонним сервисам через поле заголовка HTTP-запроса «Referer». Это можно сделать с помощью поля заголовка HTTP-ответа «Referrer‑Policy» или через атрибуты HTML-элемента. Конфиденциальные данные могут включать путь и данные запроса в URL-адресе, а для внутренних непубличных приложений также имя хоста.",
              "L": "2"
            },
            {
              "Shortcode": "V3.4.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что веб-приложение использует директиву frame‑ancestors поля заголовка Content‑Security‑Policy для каждого HTTP-ответа, чтобы гарантировать невозможность его внедрения по умолчанию и внедрение определённых ресурсов разрешено только при необходимости. Обратите внимание, что поле заголовка X‑Frame‑Options, хотя и поддерживается браузерами, устарело и не может быть использовано в качестве основы.",
              "L": "2"
            },
            {
              "Shortcode": "V3.4.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что в поле заголовка Content‑Security‑Policy указано место, куда следует сообщать о нарушениях.",
              "L": "3"
            },
            {
              "Shortcode": "V3.4.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что все HTTP-ответы, инициирующие рендеринг документа (например, ответы с типом содержимого text/html), включают поле заголовка Cross-Origin-Opener-Policy с директивой same-origin или same-origin-allow-popups (при необходимости). Это предотвращает атаки, злоупотребляющие общим доступом к объектам Window, такие как Tabnabbing и Frame Counting.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V3.5",
          "Ordinal": 5,
          "Name": "Браузерное разделение источников",
          "Items": [
            {
              "Shortcode": "V3.5.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что, если приложение не использует механизм предварительной проверки CORS для предотвращения запрещённых кросс-доменных запросов на использование чувствительного функционала, эти запросы валидируются на предмет их происхождения от самого приложения. Это можно сделать, используя и проверяя специальные токены для защиты от подделки или требуя дополнительные поля HTTP-заголовка, не входящие в список 'простых заголовков' (CORS-safelisted request-header). Это необходимо для защиты от атак с подделкой запросов через браузер, широко известных как межсайтовая подделка запросов (CSRF).",
              "L": "1"
            },
            {
              "Shortcode": "V3.5.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что если приложение использует механизм предварительной проверки CORS для предотвращения неразрешённого использования чувствительного функционала между источниками, вызов этого функционала невозможен с помощью запроса, который не запускает предварительную проверку CORS. Для этого может потребоваться проверка значений полей заголовка запроса «Origin» и «Content-Type» или использование дополнительного поля заголовка, не входящего в безопасный список CORS.",
              "L": "1"
            },
            {
              "Shortcode": "V3.5.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что HTTP-запросы к чувствительному функционалу используют соответствующие HTTP-методы, такие как POST, PUT, PATCH или DELETE, а не методы, определённые спецификацией HTTP как «безопасные», такие как HEAD, OPTIONS или GET. В качестве альтернативы можно использовать строгую валидацию полей заголовка запроса Sec‑Fetch‑*, чтобы убедиться, что запрос не исходит из недопустимого кросс-доменного вызова, навигационного запроса или загрузки ресурса (например, источника изображения), где это не ожидается.",
              "L": "1"
            },
            {
              "Shortcode": "V3.5.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что отдельные приложения размещены на разных именах хостов, чтобы использовать ограничения, предусмотренные политикой same-origin, включая то, как документы или скрипты, загруженные одним источником, могут взаимодействовать с ресурсами из другого источника, а также ограничения на cookie на основе имени хоста.",
              "L": "2"
            },
            {
              "Shortcode": "V3.5.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что сообщения, полученные интерфейсом postMessage, отвергаются, если источник сообщения не является доверенным или если синтаксис сообщения недействителен.",
              "L": "2"
            },
            {
              "Shortcode": "V3.5.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что функциональность JSONP не включена нигде в приложении, чтобы избежать атак с использованием межсайтового включения скриптов (XSSI).",
              "L": "3"
            },
            {
              "Shortcode": "V3.5.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что данные, требующие авторизации, не включены в ответы ресурсов скриптов, таких как файлы JavaScript, чтобы предотвратить атаки с использованием межсайтового включения скриптов (XSSI).",
              "L": "3"
            },
            {
              "Shortcode": "V3.5.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что аутентифицированные ресурсы (такие как изображения, видео, скрипты и другие документы) могут быть загружены или внедрены от имени пользователя только по назначению. Этого можно добиться путём строгой валидации полей заголовка HTTP-запроса Sec‑Fetch‑*, чтобы убедиться, что запрос не исходит из недопустимого кросс-доменного вызова, или путём установки ограничительного поля заголовка HTTP-ответа Cross‑Origin‑Resource‑Policy, чтобы браузер блокировал возвращаемый контент.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V3.6",
          "Ordinal": 6,
          "Name": "Целостность внешних ресурсов",
          "Items": [
            {
              "Shortcode": "V3.6.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что клиентские ресурсы, такие как библиотеки JavaScript, CSS или веб-шрифты, размещаются только на внешнем сервере (например, в сети доставки контента (Content Delivery Network)), если ресурс статический и имеет версии, а для проверки целостности ресурса используется механизм проверки целостности подресурсов (SRI). Если это невозможно, для каждого ресурса должно быть задокументировано решение по безопасности, обосновывающее это.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V3.7",
          "Ordinal": 7,
          "Name": "Другие соображения по безопасности браузера",
          "Items": [
            {
              "Shortcode": "V3.7.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение использует только те клиентские технологии, которые по-прежнему поддерживаются и считаются безопасными. Примерами технологий, не соответствующих этому требованию, являются плагины NSAPI, Flash, Shockwave, ActiveX, Silverlight, NACL или клиентские Java-апплеты.",
              "L": "2"
            },
            {
              "Shortcode": "V3.7.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что приложение будет автоматически перенаправлять пользователя на другое имя хоста или домен (который не контролируется приложением), только если этот хост или домен указаны в списке разрешенных.",
              "L": "2"
            },
            {
              "Shortcode": "V3.7.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение отображает уведомление, что пользователь перенаправляется на URL-адрес, находящийся вне контроля приложения, с возможностью отмены навигации.",
              "L": "3"
            },
            {
              "Shortcode": "V3.7.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что домен верхнего уровня приложения (например, site.tld) ​​добавлен в публичный список предварительной загрузки (preload list) для HTTP Strict Transport Security (HSTS). Это гарантирует, что использование TLS для приложения будет встроено непосредственно в основные браузеры, а не будет полагаться только на поле заголовка ответа Strict-Transport-Security.",
              "L": "3"
            },
            {
              "Shortcode": "V3.7.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что приложение ведет себя так, как описано в документации (например, предупреждает пользователя или блокирует доступ), если браузер, используемый для доступа к приложению, не поддерживает ожидаемые функции безопасности.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V4",
      "Ordinal": 4,
      "ShortName": "API",
      "Name": "API и Веб-сервис",
      "Items": [
        {
          "Shortcode": "V4.1",
          "Ordinal": 1,
          "Name": "Общая безопасность веб-сервисов",
          "Items": [
            {
              "Shortcode": "V4.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что каждый HTTP-ответ с телом сообщения содержит заголовок Content-Type, который соответствует фактическому содержимому ответа, таким как \"text/\", \"/+xml\" and \"/xml\", включая параметр charset для указания безопасной кодировки символов (например, UTF-8, ISO-8859-1) согласно IANA Media Types.",
              "L": "1"
            },
            {
              "Shortcode": "V4.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что только конечные точки, предназначенные для взаимодействия с пользователем через веб-браузер, автоматически перенаправляют HTTP на HTTPS, в то время как другие сервисы или конечные точки не реализуют прозрачные редиректы. Это необходимо, чтобы избежать ситуации, когда клиент ошибочно отправляет незашифрованные HTTP-запросы, а из-за того, что запрос по HTTP автоматически перенаправляется на HTTPS другим сервисом без обработки на входе, утечка чувствительных данных остаётся незамеченной.",
              "L": "2"
            },
            {
              "Shortcode": "V4.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что любой HTTP-заголовок, используемый приложением и устанавливаемый промежуточным уровнем, таким как балансировщик нагрузки, веб-прокси или backend-for-frontend сервис, не может быть переопределён конечным пользователем. Примеры заголовков: X-Real-IP, X-Forwarded-*, X-User-ID.",
              "L": "2"
            },
            {
              "Shortcode": "V4.1.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что разрешены только HTTP-методы, которые явно поддерживаются приложением или его API (включая OPTIONS для preflight-запросов), а неиспользуемые методы заблокированы.",
              "L": "3"
            },
            {
              "Shortcode": "V4.1.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что для особо чувствительных запросов или транзакций, проходящих через несколько систем, используются цифровые подписи на уровне сообщений, дополнительно к транспортным средствам защиты.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V4.2",
          "Ordinal": 2,
          "Name": "Валидация структуры HTTP-сообщений",
          "Items": [
            {
              "Shortcode": "V4.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что все компоненты приложения (включая балансировщики нагрузки, файрволы и серверы приложений) определяют границы входящих HTTP-сообщений с использованием механизма, соответствующего версии HTTP, чтобы предотвратить HTTP request smuggling. В HTTP/1.x, если присутствует заголовок Transfer-Encoding, заголовок Content-Length должен игнорироваться согласно RFC 2616. При использовании HTTP/2 или HTTP/3, если присутствует Content-Length, веб-сервер должен убедиться, что он совпадает с длиной DATA-фреймов.",
              "L": "2"
            },
            {
              "Shortcode": "V4.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при генерации HTTP-сообщений заголовок Content-Length не конфликтует с длиной содержимого, определяемой рамками протокола HTTP, чтобы предотвратить HTTP Request Smuggling.",
              "L": "3"
            },
            {
              "Shortcode": "V4.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение не отправляет и не принимает HTTP/2 и HTTP/3 сообщения с заголовками, специфичными для соединения, такими как Transfer-Encoding, чтобы предотвратить HTTP Response Splitting и HTTP Header Injection.",
              "L": "3"
            },
            {
              "Shortcode": "V4.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что приложение принимает HTTP/2 и HTTP/3 запросы только в случае, если поля заголовков и их значения не содержат последовательностей CR (\\r) LF (\\n) или CRLF (\\r\\n), чтобы предотвратить HTTP Header Injection.",
              "L": "3"
            },
            {
              "Shortcode": "V4.2.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что если приложение (бекенд или фронтенд) формирует и отправляет запросы, оно использует валидацию, очистку или другие механизмы, чтобы не создавать URI (например, для API-вызовов) или HTTP-заголовки (например, Authorization или Cookie) слишком большой длины, чтобы их не принимал приёмник. Это может привести к отказу в обслуживании, например, при отправке слишком длинного запроса (длинный cookie-заголовок), из-за чего сервер постоянно возвращает ошибку.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V4.3",
          "Ordinal": 3,
          "Name": "GraphQL",
          "Items": [
            {
              "Shortcode": "V4.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что используется белый список запросов, ограничение глубины вложенности, ограничение количества или анализ стоимости запроса, чтобы предотвратить DoS-атаки на уровне GraphQL или слоя данных из-за дорогостоящих вложенных запросов.",
              "L": "2"
            },
            {
              "Shortcode": "V4.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что introspection-запросы GraphQL отключены в продакшен-среде, если GraphQL API не предназначен для использования сторонними клиентами.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V4.4",
          "Ordinal": 4,
          "Name": "WebSocket",
          "Items": [
            {
              "Shortcode": "V4.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что для всех WebSocket-соединений используется WebSocket поверх TLS (WSS).",
              "L": "1"
            },
            {
              "Shortcode": "V4.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при первоначальном HTTP WebSocket handshake заголовок Origin проверяется на соответствие списку разрешённых источников для приложения.",
              "L": "2"
            },
            {
              "Shortcode": "V4.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что если стандартное управление сессиями приложения не может быть использовано, применяются специальные токены, соответствующие требованиям безопасности управления сессиями",
              "L": "2"
            },
            {
              "Shortcode": "V4.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что специальные токены управления сессиями WebSocket изначально получаются или валидируются через ранее аутентифицированную HTTPS-сессию при переходе от HTTPS к WebSocket.",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V5",
      "Ordinal": 5,
      "ShortName": "File",
      "Name": "Работа с файлами",
      "Items": [
        {
          "Shortcode": "V5.1",
          "Ordinal": 1,
          "Name": "Документация по работе с файлами",
          "Items": [
            {
              "Shortcode": "V5.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что документация определяет допустимые типы файлов, ожидаемые расширения и максимальный размер (включая распакованный размер) для каждой функции загрузки. Также убедитесь, что в документации указано, как файлы обезвреживаются для конечных пользователей (например, как приложение ведёт себя при обнаружении вредоносного файла).",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V5.2",
          "Ordinal": 2,
          "Name": "Загрузка файлов и содержимое",
          "Items": [
            {
              "Shortcode": "V5.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение принимает только те файлы, которые может обработать без потери производительности или отказа в обслуживании.",
              "L": "1"
            },
            {
              "Shortcode": "V5.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при загрузке файла (включая файлы внутри архивов, таких как ZIP) приложение проверяет, соответствует ли расширение ожидаемому, и валидирует, соответствует ли содержимое типу, указанному в расширении. Это включает проверку начальных 'magic bytes', перезапись изображений, использование специализированных библиотек. Для уровня 1 — достаточно проверок для файлов, критичных с точки зрения бизнеса или безопасности. Для уровней 2 и выше — для всех файлов.",
              "L": "1"
            },
            {
              "Shortcode": "V5.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение проверяет архивы (например, zip, gz, docx, odt) на максимально допустимый распакованный размер и максимальное количество файлов до распаковки.",
              "L": "2"
            },
            {
              "Shortcode": "V5.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что для каждого пользователя установлены квоты на общий размер и количество файлов, чтобы один пользователь не мог переполнить хранилище.",
              "L": "3"
            },
            {
              "Shortcode": "V5.2.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что приложение не позволяет загружать архивы с символьными ссылками (symlinks), если это не требуется по бизнес-логике. Если требуется — разрешён только строго определённый список допустимых символьных ссылок.",
              "L": "3"
            },
            {
              "Shortcode": "V5.2.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что приложение отклоняет изображения с числом пикселей выше допустимого, чтобы предотвратить атаки 'pixel flood'.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V5.3",
          "Ordinal": 3,
          "Name": "Хранение файлов",
          "Items": [
            {
              "Shortcode": "V5.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что загруженные или сгенерированные из недоверенного ввода файлы, находящиеся в публичной директории, не исполняются как серверный код при обращении к ним по HTTP.",
              "L": "1"
            },
            {
              "Shortcode": "V5.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при создании путей к файлам приложение использует внутренние или доверенные данные, а не пользовательские имена файлов. Если использование пользовательских имён или метаданных необходимо — требуется строгая проверка и очистка. Это защита от path traversal, LFI, RFI и SSRF.",
              "L": "1"
            },
            {
              "Shortcode": "V5.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что при обработке файлов на сервере (например, при распаковке) игнорируются пути, заданные пользователем, во избежание уязвимостей типа 'zip slip'.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V5.4",
          "Ordinal": 4,
          "Name": "Скачивание файлов",
          "Items": [
            {
              "Shortcode": "V5.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение валидирует или игнорирует имена файлов, переданных пользователем (включая в JSON, JSONP или URL-параметре), и указывает имя файла в заголовке Content-Disposition при ответе.",
              "L": "2"
            },
            {
              "Shortcode": "V5.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что имена файлов, передаваемые (например, в HTTP-заголовках или вложениях в email), кодируются или очищаются (например, по RFC 6266), чтобы сохранить структуру документа и предотвратить инъекции.",
              "L": "2"
            },
            {
              "Shortcode": "V5.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что файлы, полученные из недоверенных источников, сканируются антивирусом, чтобы не распространять известное вредоносное содержимое.",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V6",
      "Ordinal": 6,
      "ShortName": "Аутентификация",
      "Name": "Аутентификация",
      "Items": [
        {
          "Shortcode": "V6.1",
          "Ordinal": 1,
          "Name": "Документация по аутентификации",
          "Items": [
            {
              "Shortcode": "V6.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что в документации приложения описано, как используются механизмы, такие как ограничение частоты запросов (rate limiting), защита от автоматизации и адаптивные реакции, для защиты от атак, таких как подстановка учётных данных и перебор паролей. Документация должна ясно описывать конфигурацию этих механизмов и предотвращение злонамеренной блокировки аккаунтов.",
              "L": "1"
            },
            {
              "Shortcode": "V6.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что задокументирован список контекстно-зависимых слов, запрещённых к использованию в паролях. В него могут входить производные от названий организаций, продуктов, идентификаторов систем, кодовых названий проектов, названий отделов или ролей и тому подобное.",
              "L": "2"
            },
            {
              "Shortcode": "V6.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что задокументирован список контекстно-зависимых слов, запрещённых к использованию в паролях. В него могут входить производные от названий организаций, продуктов, идентификаторов систем, кодовых названий проектов, названий отделов или ролей и тому подобное.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V6.2",
          "Ordinal": 2,
          "Name": "Безопасность паролей",
          "Items": [
            {
              "Shortcode": "V6.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что пользовательские пароли содержат не менее 8 символов. Рекомендуется минимальная длина в 15 символов.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что пользователи могут менять свои пароли.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что для смены пароля требуется ввести как текущий, так и новый пароль.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что при регистрации или смене пароля введённый пароль проверяется по списку как минимум из 3000 самых популярных паролей, соответствующих политике (например, минимальной длине).",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что допускаются пароли любой структуры, без ограничений на использование определённых символов. Не должно быть требований по обязательному наличию заглавных/строчных букв, цифр или специальных символов.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что поля ввода пароля используют type=password для скрытия символов. Разрешено временное отображение всего пароля или последнего введённого символа.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что разрешены вставка (paste), использование менеджеров паролей браузера и внешних менеджеров паролей.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что пароль проверяется строго в том виде, в котором он был введён пользователем — без обрезки, изменения регистра и других модификаций.",
              "L": "1"
            },
            {
              "Shortcode": "V6.2.9",
              "Ordinal": 9,
              "Description": "Убедитесь, что система позволяет использовать пароли длиной не менее 64 символов.",
              "L": "2"
            },
            {
              "Shortcode": "V6.2.10",
              "Ordinal": 10,
              "Description": "Убедитесь, что пароль остаётся действительным, пока не будет скомпрометирован или не будет изменён пользователем. Приложение не должно требовать регулярной смены пароля.",
              "L": "2"
            },
            {
              "Shortcode": "V6.2.11",
              "Ordinal": 11,
              "Description": "Убедитесь, что используется документированный список контекстно-зависимых слов (например, названия компаний, проектов и т.д.) для предотвращения использования легко угадываемых паролей.",
              "L": "2"
            },
            {
              "Shortcode": "V6.2.12",
              "Ordinal": 12,
              "Description": "Убедитесь, что при регистрации или смене пароля проверяется, не входит ли он в список скомпрометированных (утёкших) паролей.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V6.3",
          "Ordinal": 3,
          "Name": "Общие требования к безопасности аутентификации",
          "Items": [
            {
              "Shortcode": "V6.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что реализованы меры защиты от атак типа credential stuffing (массовая подстановка учётных данных) и brute-force (перебор паролей), согласно документации по безопасности приложения.",
              "L": "1"
            },
            {
              "Shortcode": "V6.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что в приложении отсутствуют или отключены учётные записи по умолчанию (например, \"root\", \"admin\", \"sa\").",
              "L": "1"
            },
            {
              "Shortcode": "V6.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что для доступа к приложению используется либо механизм многофакторной аутентификации, либо комбинация однофакторных. Для уровня L3 один из факторов должен быть аппаратным, обеспечивающим защиту от фишинга, устойчивость к компрометации и подтверждение намерения аутентификации через явное действие пользователя (например, нажатие кнопки на FIDO-ключе или телефоне). Ослабление этих требований допускается только при наличии обоснования и компенсирующих мер.",
              "L": "2"
            },
            {
              "Shortcode": "V6.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что при наличии нескольких путей аутентификации, они все задокументированы, и для них единообразно применяются меры защиты и уровни доверия.",
              "L": "2"
            },
            {
              "Shortcode": "V6.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что пользователи получают уведомления о подозрительных попытках аутентификации (удачных и неудачных). Это может включать попытки (например, подключения) с необычного устройства или места, частично успешную MFA, попытку после долгого отсутствия или успешную аутентификацию после серии неудачных.",
              "L": "3"
            },
            {
              "Shortcode": "V6.3.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что email не используется ни как однофакторный, ни как многофакторный механизм аутентификации.",
              "L": "3"
            },
            {
              "Shortcode": "V6.3.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что пользователи получают уведомление при изменении данных аутентификации, таких как сброс пароля или изменение логина/email.",
              "L": "3"
            },
            {
              "Shortcode": "V6.3.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что из сообщений об ошибке, HTTP-кодов ответа или различий во времени ответа нельзя определить, существует ли пользователь с таким логином. Это правило также должно применяться к функциям регистрации и восстановления пароля.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V6.4",
          "Ordinal": 4,
          "Name": "Жизненный цикл и восстановление факторов аутентификации",
          "Items": [
            {
              "Shortcode": "V6.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что начальные пароли или коды активации, генерируемые системой, создаются с использованием надёжного генератора случайных чисел, соответствуют текущей политике паролей и истекают через короткий период времени либо после первого использования. Эти секреты не должны использоваться как постоянные пароли.",
              "L": "1"
            },
            {
              "Shortcode": "V6.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что в системе отсутствуют подсказки к паролю или вопросы на знание (\"секретные вопросы\").",
              "L": "1"
            },
            {
              "Shortcode": "V6.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что реализован безопасный процесс сброса забытого пароля, который не обходит активные механизмы многофакторной аутентификации.",
              "L": "2"
            },
            {
              "Shortcode": "V6.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что реализован безопасный процесс сброса забытого пароля, который не обходит активные механизмы многофакторной аутентификации.",
              "L": "2"
            },
            {
              "Shortcode": "V6.4.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что инструкции по обновлению истекающих механизмов аутентификации отправляются заранее, с достаточным запасом времени для выполнения замены, при необходимости с настройкой автоматических напоминаний.",
              "L": "3"
            },
            {
              "Shortcode": "V6.4.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что администраторы могут инициировать процесс сброса пароля, но не могут задать или выбрать новый пароль за пользователя. Это исключает ситуацию, при которой администратор знает пароль пользователя.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V6.5",
          "Ordinal": 5,
          "Name": "Общие требования к многофакторной аутентификации",
          "Items": [
            {
              "Shortcode": "V6.5.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что lookup-секреты, внеполосные коды/запросы и TOTP-коды можно использовать только один раз.",
              "L": "2"
            },
            {
              "Shortcode": "V6.5.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при хранении lookup-секретов с энтропией менее 112 бит (например, 19 случайных буквенно-цифровых символов или 34 случайные цифры) они хэшируются с использованием разрешённого алгоритма хеширования паролей и случайной соли минимум 32 бита. Если у секрета ≥112 бит энтропии — допустимо использовать стандартный хэш.",
              "L": "2"
            },
            {
              "Shortcode": "V6.5.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что lookup-секреты, коды внеполосной аутентификации и сиды для TOTP генерируются с использованием криптографически стойкого генератора случайных чисел (CSPRNG), чтобы избежать предсказуемых значений.",
              "L": "2"
            },
            {
              "Shortcode": "V6.5.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что lookup-секреты и внеполосные коды аутентификации имеют минимум 20 бит энтропии (достаточно, например, 4 случайных алфавитно-цифровых символов или 6 случайных цифр).",
              "L": "2"
            },
            {
              "Shortcode": "V6.5.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что все внеполосные запросы, коды и токены, а также TOTP-коды имеют ограниченный срок действия. Максимум для out-of-band — 10 минут, для TOTP — 30 секунд.",
              "L": "2"
            },
            {
              "Shortcode": "V6.5.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что любой фактор аутентификации (включая физические устройства) может быть отозван в случае кражи или утери.",
              "L": "3"
            },
            {
              "Shortcode": "V6.5.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что биометрические механизмы аутентификации используются только как вторичный фактор — в сочетании с «чем-то, что вы знаете» или «чем-то, что у вас есть».",
              "L": "3"
            },
            {
              "Shortcode": "V6.5.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что TOTP-коды проверяются по источнику времени, полученному от доверенного сервиса, а не от клиента или недоверенного источника.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V6.6",
          "Ordinal": 6,
          "Name": "Внеполосные механизмы аутентификации",
          "Items": [
            {
              "Shortcode": "V6.6.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что механизмы аутентификации через телефонную сеть общего пользования (PSTN) для доставки одноразовых паролей (OTP) по телефону или SMS используются только в случае предварительной валидации номера, при этом предлагаются альтернативные более безопасные методы (например, TOTP), и пользователю сообщаются риски. Для приложений уровня L3 использование телефона и SMS недопустимо.",
              "L": "2"
            },
            {
              "Shortcode": "V6.6.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что внеполосные запросы, коды или токены привязаны к исходному запросу аутентификации, для которого они были сгенерированы, и не могут быть использованы повторно для других попыток.",
              "L": "2"
            },
            {
              "Shortcode": "V6.6.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что внеполосные механизмы на основе кода защищены от атак методом подбора (brute force) путём применения ограничения частоты запросов (rate limiting). Также рекомендуется использовать коды с энтропией не менее 64 бит.",
              "L": "2"
            },
            {
              "Shortcode": "V6.6.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что при использовании push-уведомлений для MFA применяется ограничение частоты (rate limiting), чтобы предотвратить атаки push-бомбинга. Также может помочь механизм сопоставления номеров (number matching).",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V6.7",
          "Ordinal": 7,
          "Name": "Криптографические механизмы аутентификации",
          "Items": [
            {
              "Shortcode": "V6.7.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что сертификаты, используемые для проверки криптографических утверждений об аутентификации, хранятся таким образом, чтобы исключить возможность их модификации.",
              "L": "3"
            },
            {
              "Shortcode": "V6.7.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что nonce (случайная строка), используемая в процессе вызова, имеет длину не менее 64 бит и является статистически уникальной или уникальной на протяжении всего срока службы криптографического устройства.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V6.8",
          "Ordinal": 8,
          "Name": "Аутентификация с использованием провайдера идентификаций (IdP)",
          "Items": [
            {
              "Shortcode": "V6.8.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что при поддержке несколькими IdP, невозможно подделать личность пользователя через другой IdP (например, с тем же user ID). Стандартным способом защиты является регистрация пользователя с использованием сочетания ID самого IdP (в качестве пространства имён) и пользовательского ID внутри IdP.",
              "L": "2"
            },
            {
              "Shortcode": "V6.8.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что наличие и целостность цифровой подписи в утверждениях аутентификации (например, в JWT или SAML) всегда проверяются, а неподписанные или недействительные утверждения отклоняются.",
              "L": "2"
            },
            {
              "Shortcode": "V6.8.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что SAML-утверждения обрабатываются только один раз в течение периода их действия, чтобы исключить атаки воспроизведения (replay attacks).",
              "L": "2"
            },
            {
              "Shortcode": "V6.8.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что если приложение использует внешний поставщик идентификации (IdP) и для определенных функций требуется особый уровень, метод или срок действия аутентификации, то приложение использует данные, возвращаемые IdP, для проверки этих условий. Например, при использовании OIDC можно проверить значения полей ID Token — acr, amr, auth_time (если они есть). Если IdP не предоставляет эти данные, приложение должно иметь документированный план действий по умолчанию, предполагающий использование минимально допустимой силы аутентификации (например, одноступенчатая — логин и пароль).",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V7",
      "Ordinal": 7,
      "ShortName": "Сессия",
      "Name": "Управление сессиями",
      "Items": [
        {
          "Shortcode": "V7.1",
          "Ordinal": 1,
          "Name": "Документация по управлению сессиями",
          "Items": [
            {
              "Shortcode": "V7.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что тайм-аут бездействия и абсолютное максимальное время жизни сессии задокументированы, соответствуют другим контрольным мерам и сопровождаются обоснованием любых отклонений от требований повторной аутентификации NIST SP 800-63B.",
              "L": "2"
            },
            {
              "Shortcode": "V7.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что документация определяет допустимое количество одновременных (параллельных) сессий для одного аккаунта, а также поведение системы и действия при достижении этого лимита.",
              "L": "2"
            },
            {
              "Shortcode": "V7.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что все системы, создающие и управляющие сессиями пользователей в рамках федеративной идентификации (например, SSO), задокументированы вместе с механизмами координации сроков действия сессий, условий завершения и случаев, требующих повторной аутентификации.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V7.2",
          "Ordinal": 2,
          "Name": "Базовая безопасность сессий",
          "Items": [
            {
              "Shortcode": "V7.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что все проверки сессионных токенов выполняются на доверенной серверной стороне.",
              "L": "1"
            },
            {
              "Shortcode": "V7.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что приложение использует либо автономные токены, либо ссылочные токены, которые генерируются динамически, не используя статические API-секреты или ключи.",
              "L": "1"
            },
            {
              "Shortcode": "V7.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что ссылочные токены являются уникальными, создаются с использованием криптографически безопасного генератора псевдослучайных чисел (CSPRNG) и обладают энтропией не менее 128 бит.",
              "L": "1"
            },
            {
              "Shortcode": "V7.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что при аутентификации пользователя (включая повторную) создается новый токен сессии, а текущий — аннулируется.",
              "L": "1"
            }
          ]
        },
        {
          "Shortcode": "V7.3",
          "Ordinal": 3,
          "Name": "Тайм-ауты сессии",
          "Items": [
            {
              "Shortcode": "V7.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что есть тайм-аут бездействия, после которого требуется повторная аутентификация, в соответствии с анализом рисков и документированными решениями.",
              "L": "2"
            },
            {
              "Shortcode": "V7.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что установлено абсолютное максимальное время жизни сессии, по истечении которого требуется повторная аутентификация, в соответствии с анализом рисков и документированными решениями.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V7.4",
          "Ordinal": 4,
          "Name": "Завершение сессий",
          "Items": [
            {
              "Shortcode": "V7.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что после завершения сессии (logout, истечение срока) дальнейшее её использование невозможно. Для ссылочных токенов или сессий с сохранением состояния это означает аннулирование на сервере. Для self-contained токенов необходимо реализовать механизм отзыва, например, список отозванных токенов, проверку времени выпуска или ротацию ключей подписи для каждого пользователя.",
              "L": "1"
            },
            {
              "Shortcode": "V7.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при удалении или отключении пользователя все активные сессии немедленно завершаются.",
              "L": "1"
            },
            {
              "Shortcode": "V7.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что после изменения или удаления факторов аутентификации (например, смена пароля или MFA) приложение предлагает завершить все другие активные сессии.",
              "L": "2"
            },
            {
              "Shortcode": "V7.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что на всех страницах, требующих аутентификации, имеется простой и видимый способ выхода.",
              "L": "2"
            },
            {
              "Shortcode": "V7.4.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что администраторы могут завершать активные сессии конкретного пользователя или всех пользователей.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V7.5",
          "Ordinal": 5,
          "Name": "Защита от злоупотреблений сессией",
          "Items": [
            {
              "Shortcode": "V7.5.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение требует полной повторной аутентификации перед изменением чувствительных атрибутов аккаунта, которые могут влиять на аутентификацию (например, email, номер телефона, настройки MFA или данных восстановления доступа).",
              "L": "2"
            },
            {
              "Shortcode": "V7.5.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что пользователь может просматривать и (после повторной аутентификации хотя бы по одному фактору) завершать активные сессии.",
              "L": "2"
            },
            {
              "Shortcode": "V7.5.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что перед выполнением критически важных операций приложение требует повторной аутентификации (по крайней мере, одного фактора) или дополнительной проверки.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V7.6",
          "Ordinal": 6,
          "Name": "Федеративная повторная аутентификация",
          "Items": [
            {
              "Shortcode": "V7.6.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что срок действия и завершение сессий между RP и IdP соответствуют документации и включают повторную аутентификацию, если достигнут максимальный допустимый интервал между событиями аутентификации.",
              "L": "2"
            },
            {
              "Shortcode": "V7.6.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что создание сессии требует согласия пользователя или явного действия, предотвращающего несанкционированное создание сессий без участия пользователя.",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V8",
      "Ordinal": 8,
      "ShortName": "Авторизация",
      "Name": "Авторизация",
      "Items": [
        {
          "Shortcode": "V8.1",
          "Ordinal": 1,
          "Name": "Документация по авторизации",
          "Items": [
            {
              "Shortcode": "V8.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что документация по авторизации определяет правила ограничения доступа на уровне функций и на уровне данных на основе прав субъекта и атрибутов ресурса.",
              "L": "1"
            },
            {
              "Shortcode": "V8.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что документация по авторизации определяет правила ограничения доступа на уровне полей (как на чтение, так и на запись) на основе прав субъекта и атрибутов ресурса. Эти правила могут зависеть от других атрибутов объекта данных, например, статуса.",
              "L": "2"
            },
            {
              "Shortcode": "V8.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что документация определяет, какие атрибуты окружения и контекста (например, время суток, IP-адрес, местоположение, устройство) используются приложением для принятия решений в области аутентификации и авторизации.",
              "L": "3"
            },
            {
              "Shortcode": "V8.1.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что документация по аутентификации и авторизации определяет, как используются факторы окружения и контекста в принятии решений, наряду с правилами доступа к функциям, данным и полям. Документация должна содержать оцениваемые атрибуты, пороговые значения риска, действия (разрешить, отказать, повысить уровень аутентификации и др.).",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V8.2",
          "Ordinal": 2,
          "Name": "Архитектура авторизации",
          "Items": [
            {
              "Shortcode": "V8.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение обеспечивает доступ на уровне функций (function-level) только субъектам с явными разрешениями.",
              "L": "1"
            },
            {
              "Shortcode": "V8.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что приложение обеспечивает доступ на уровне данных (data-specific) только тем субъектам, которым явно предоставлены права к определённым элементам данных, чтобы предотвратить IDOR (Insecure Direct Object Reference) и BOLA-уязвимости (Broken Object Level Authorization).",
              "L": "1"
            },
            {
              "Shortcode": "V8.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение обеспечивает доступ на уровне полей (field-level) только субъектам тем субъектам, которым явно предоставлены права к определённым полям, чтобы предотвратить BOPLA (Broken Object Property Level Authorization).",
              "L": "2"
            },
            {
              "Shortcode": "V8.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что реализованы адаптивные меры безопасности, основанные на атрибутах окружения и контекста субъекта (время, местоположение, IP, устройство), которые используются для принятия решений об аутентификации и авторизации, как это определено в документации приложения. Эти меры должны применяться как при попытке субъекта начать новую сессию, так и во время существующей сессии.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V8.3",
          "Ordinal": 3,
          "Name": "Авторизация на уровне операций",
          "Items": [
            {
              "Shortcode": "V8.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что правила авторизации реализуются на доверенном сервисном уровне и не зависят от элементов, которые может контролировать клиент (например, JavaScript на стороне клиента).",
              "L": "1"
            },
            {
              "Shortcode": "V8.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что изменения значений, влияющих на авторизацию, применяются немедленно. Если это невозможно (например, при использовании автономных токенов), должны быть реализованы компенсирующие меры: оповещения о попытке несанкционированного действия и откат изменений. Обратите внимание, что данный подход не предотвращает утечку информации.",
              "L": "3"
            },
            {
              "Shortcode": "V8.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что доступ к объекту осуществляется на основе прав субъекта, инициировавшего запрос, а не прав промежуточного сервиса, действующего от его имени. Например, если пользователь обращается к веб-сервису с автономным токеном для аутентификации, а сервис затем запрашивает данные у другого сервиса, второй сервис должен использовать токен пользователя, а не токен первого сервиса для принятия решения о доступе.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V8.4",
          "Ordinal": 4,
          "Name": "Прочие аспекты авторизации",
          "Items": [
            {
              "Shortcode": "V8.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что в мультитенантных приложениях реализованы механизмы, предотвращающие действия потребителя в отношении арендаторов, к которым у него нет доступа.",
              "L": "2"
            },
            {
              "Shortcode": "V8.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что доступ к административным интерфейсам защищён несколькими уровнями контроля, включая непрерывную проверку личности, контроль защищённости устройства и анализ контекстных рисков. Недостаточно опираться только на IP-адрес или доверенные устройства.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V9",
      "Ordinal": 9,
      "ShortName": "Self",
      "Name": "Автономные токены",
      "Items": [
        {
          "Shortcode": "V9.1",
          "Ordinal": 1,
          "Name": "Источник токена и его целостность",
          "Items": [
            {
              "Shortcode": "V9.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что автономные токены проверяются на целостность с помощью цифровой подписи или MAC, прежде чем доверять их содержимому.",
              "L": "1"
            },
            {
              "Shortcode": "V9.1.2",
              "Ordinal": 2,
              "Description": "Проверяйте, что автономные токены создаются и проверяются исключительно с помощью алгоритмов из списка допустимых в данном контексте. Список допустимых алгоритмов должен включать только разрешенные алгоритмы (желательно либо только симметричные, либо только асимметричные) и ни в коем случае не содержать алгоритм None. Если необходимо поддерживать оба типа алгоритмов, потребуются дополнительные средства контроля для предотвращения путаницы с ключами (key confusion).",
              "L": "1"
            },
            {
              "Shortcode": "V9.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что ключи, используемые для проверки автономных токенов, получены из доверенных, предварительно настроенных источников. Это предотвращает возможность указания злоумышленниками ненадёжных источников и ключей.  Для JWT и других JWS структур заголовки 'jku', 'x5u' и 'jwk' должны проверяться по белому списку.",
              "L": "1"
            }
          ]
        },
        {
          "Shortcode": "V9.2",
          "Ordinal": 2,
          "Name": "Содержимое токена",
          "Items": [
            {
              "Shortcode": "V9.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что при указанном сроке действия токен и его содержимое принимаются только в том случае, если срок действия токена не истёк. Например, для JWT нужно проверить поля 'nbf' и 'exp'.",
              "L": "1"
            },
            {
              "Shortcode": "V9.2.2",
              "Ordinal": 2,
              "Description": "Прежде чем обрабатывать содержимое токена убедитесь в том, что сервис, принимающий токен, проверяет его тип и соответствие назначению. Например, для принятия решений об авторизации могут быть приняты только Access Token, а для подтверждения аутентификации пользователя — только ID Token.",
              "L": "2"
            },
            {
              "Shortcode": "V9.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что сервис принимает только токены, предназначенные для использования с этим сервисом (audience). Для JWT это можно сделать, проверив наличие утверждения «aud» по белому списку, определенному в сервисе.",
              "L": "2"
            },
            {
              "Shortcode": "V9.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что, если эмитент токенов использует один и тот же закрытый ключ для выпуска токенов различным сервисам (audiences), выпущенные токены содержат явное указание целевых сервисов. Это предотвратит повторное использования токенов в не предназначенных для них сервисах. Если идентификатор сервиса (audience identifier) назначается динамически, эмитент токенов должен проверить audiences для исключения подмены получателей (audience impersonation).",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V10",
      "Ordinal": 10,
      "ShortName": "OAuth",
      "Name": "OAuth и OIDC",
      "Items": [
        {
          "Shortcode": "V10.1",
          "Ordinal": 1,
          "Name": "Общие требования безопасности OAuth и OIDC",
          "Items": [
            {
              "Shortcode": "V10.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что токены передаются только тем компонентам, которым они действительно необходимы. Например, при использовании схемы backend-for-frontend для браузерных JavaScript-приложений, access и refresh токены должны быть доступны только на backend.",
              "L": "2"
            },
            {
              "Shortcode": "V10.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что клиент принимает значения от авторизационного сервера (например, authorization code или ID Token) только если они получены в результате авторизационного потока, инициированного в той же сессии пользовательского агента и в рамках той же транзакции. Для этого клиентские секреты, такие как proof key для code exchange (PKCE) — 'code_verifier', 'state' или OIDC 'nonce' — должны быть непредсказуемыми, специфичными для транзакции и надежно привязанными как к клиенту, так и к сессии пользовательского агента, в которой началась транзакция.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V10.2",
          "Ordinal": 2,
          "Name": "Клиент OAuth",
          "Items": [
            {
              "Shortcode": "V10.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что если используется механизм authorization code flow, OAuth клиент защищён от CSRF, вызывающих запросы токенов, либо за счёт использования механизма proof key for code exchange (PKCE), либо за счёт проверки параметра 'state', который был отправлен в запросе авторизации.",
              "L": "2"
            },
            {
              "Shortcode": "V10.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что если OAuth клиент может взаимодействовать с более чем одним сервером авторизации, у него есть защита от атак смешивания (mix-up attacks). Например, клиент должен требовать, чтобы сервер авторизации возвращал параметр 'iss' и проверять его в ответах на авторизацию и токены.",
              "L": "2"
            },
            {
              "Shortcode": "V10.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что OAuth клиент запрашивает только необходимые области доступа (scopes) или другие параметры авторизации в запросах к серверу авторизации.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V10.3",
          "Ordinal": 3,
          "Name": "Сервер ресурсов OAuth",
          "Items": [
            {
              "Shortcode": "V10.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что сервер ресурсов принимает только те access токены, которые предназначены для использования с этим сервисом (свойство audience). Эта принадлежность сервису может быть включена в структурированный access токен (например, в поле 'aud' в JWT) или проверяться через endpoint интроспекции токена.",
              "L": "2"
            },
            {
              "Shortcode": "V10.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что сервер ресурсов принимает решения по авторизации на основе claims из access токена, определяющих делегированную авторизацию. Если присутствуют claims, такие как 'sub', 'scope' и 'authorization_details', они должны участвовать в принятии решения.",
              "L": "2"
            },
            {
              "Shortcode": "V10.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что если для принятия решения по контролю доступа необходимо однозначно идентифицировать пользователя из access токена (JWT или ответа интроспекции), сервер ресурсов использует claims, которые не могут быть переприсвоены другим пользователям. Обычно это комбинация claims 'iss' и 'sub'.",
              "L": "2"
            },
            {
              "Shortcode": "V10.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что если сервер ресурсов требует определённой силы аутентификации, методов или свежести аутентификации, он проверяет, что предъявленный access токен удовлетворяет этим требованиям. Например, при наличии, могут использоваться claims OIDC 'acr', 'amr' и 'auth_time'.",
              "L": "2"
            },
            {
              "Shortcode": "V10.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что сервер ресурсов предотвращает использование украденных access токенов или их повторное использование (replay) неавторизованными лицами, требуя access токены с подтверждением отправителя — например, Mutual TLS для OAuth 2 или OAuth 2 Demonstration of Proof of Possession (DPoP).",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V10.4",
          "Ordinal": 4,
          "Name": "Сервер авторизации OAuth",
          "Items": [
            {
              "Shortcode": "V10.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что сервер авторизации проверяет URI перенаправления (redirect URI), сверяя его с заранее зарегистрированным списком разрешённых URI для данного клиента (allowlist), используя точное сравнение строк.",
              "L": "1"
            },
            {
              "Shortcode": "V10.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что если сервер авторизации возвращает authorization code в ответе авторизации, этот код может быть использован только один раз для запроса токена. При втором валидном запросе с уже использованным кодом сервер должен отклонить запрос и отозвать любые токены, связанные с этим кодом.",
              "L": "1"
            },
            {
              "Shortcode": "V10.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что authorization code имеет короткое время жизни. Максимальная продолжительность — до 10 минут для приложений L1 и L2 и до 1 минуты для приложений L3.",
              "L": "1"
            },
            {
              "Shortcode": "V10.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что сервер авторизации для конкретного клиента разрешает использование только тех типов авторизации, которые необходимы этому клиенту. Обратите внимание, что тип авторизации Implicit flow и Resource Owner Password Credentials flow больше не должны использоваться.",
              "L": "1"
            },
            {
              "Shortcode": "V10.4.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что сервер авторизации предотвращает атаки повторного использования refresh токенов для публичных клиентов, предпочтительно используя sender-constrained refresh токены, такие как DPoP или сертификат-связанные токены с mutual TLS (mTLS). Для L1 и L2 допускается ротация refresh токенов с обязательной их инвалидацией после использования. Если используется ротация, сервер должен отозвать все refresh токены при попытке использовать уже инвалидированный токен.",
              "L": "1"
            },
            {
              "Shortcode": "V10.4.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что при использовании типа авторизации \"Authorization Code\" сервер предотвращает атаки перехвата authorization code, требуя Proof Key for Code Exchange (PKCE). В запросах авторизации сервер должен требовать валидное значение 'code_challenge' и не принимать 'code_challenge_method' со значением 'plain'. В запросах токена обязательно валидировать параметр 'code_verifier'.",
              "L": "2"
            },
            {
              "Shortcode": "V10.4.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что если сервер авторизации поддерживает динамическую регистрацию клиентов без аутентификации, он минимизирует риски вредоносных клиентов. Сервер должен валидировать метаданные клиента (например, зарегистрированные URI), обеспечивать согласие пользователя и предупреждать пользователя перед обработкой запроса авторизации от недоверенного клиента.",
              "L": "2"
            },
            {
              "Shortcode": "V10.4.8",
              "Ordinal": 8,
              "Description": "Убедитесь, что refresh токены имеют абсолютный срок действия, включая случаи, когда применяется скользящее время истечения срока.",
              "L": "2"
            },
            {
              "Shortcode": "V10.4.9",
              "Ordinal": 9,
              "Description": "Убедитесь, что пользователи могут отзывать refresh токены и reference access токены через пользовательский интерфейс сервера авторизации для снижения риска от вредоносных клиентов или кражи токенов.",
              "L": "2"
            },
            {
              "Shortcode": "V10.4.10",
              "Ordinal": 10,
              "Description": "Убедитесь, что конфиденциальный клиент аутентифицируется при взаимодействии с сервером авторизации через backchannel, например при запросах токена, pushed authorization requests (PAR) и запросах на отзыв токенов.",
              "L": "2"
            },
            {
              "Shortcode": "V10.4.11",
              "Ordinal": 11,
              "Description": "Убедитесь, что конфигурация сервера авторизации назначает OAuth клиенту только необходимые области доступа (scopes).",
              "L": "2"
            },
            {
              "Shortcode": "V10.4.12",
              "Ordinal": 12,
              "Description": "Убедитесь, что для конкретного клиента сервер авторизации разрешает только те значения 'response_mode', которые необходимы этому клиенту. Например, сервер должен валидировать это значение против ожидаемых или использовать pushed authorization request (PAR) или JWT-secured Authorization Request (JAR).",
              "L": "3"
            },
            {
              "Shortcode": "V10.4.13",
              "Ordinal": 13,
              "Description": "Убедитесь, что грант типа 'code' всегда используется вместе с pushed authorization requests (PAR).",
              "L": "3"
            },
            {
              "Shortcode": "V10.4.14",
              "Ordinal": 14,
              "Description": "Убедитесь, что сервер авторизации выдаёт только sender-constrained (Proof-of-Possession) access токены, либо с сертификат-связанными токенами через mutual TLS (mTLS), либо DPoP-bound токены (Demonstration of Proof of Possession).",
              "L": "3"
            },
            {
              "Shortcode": "V10.4.15",
              "Ordinal": 15,
              "Description": "Убедитесь, что для серверного клиента (не выполняющегося на устройстве конечного пользователя) сервер авторизации проверяет, что значение параметра 'authorization_details' исходит из клиентского backend и что пользователь не изменял его. Например, это достигается использованием pushed authorization request (PAR) или JWT-secured Authorization Request (JAR).",
              "L": "3"
            },
            {
              "Shortcode": "V10.4.16",
              "Ordinal": 16,
              "Description": "Убедитесь, что клиент является конфиденциальным и сервер авторизации требует использования сильных методов аутентификации клиента (основанных на криптографии с открытым ключом и устойчивых к атакам повторного воспроизведения), таких как mutual TLS ('tls_client_auth', 'self_signed_tls_client_auth') или private key JWT ('private_key_jwt').",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V10.5",
          "Ordinal": 5,
          "Name": "Клиент OIDC",
          "Items": [
            {
              "Shortcode": "V10.5.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что клиент (relying party) защищается от повторного использования ID Token (replay-атак). Например, это достигается проверкой того, что значение 'nonce' в ID Token совпадает со значением 'nonce', отправленным в запросе аутентификации провайдеру OpenID (authorization server).",
              "L": "2"
            },
            {
              "Shortcode": "V10.5.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что клиент однозначно идентифицирует пользователя по утверждениям (claims) ID Token, обычно это 'sub', который не может быть переназначен другому пользователю (в пределах конкретного провайдера идентификации).",
              "L": "2"
            },
            {
              "Shortcode": "V10.5.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что клиент отклоняет попытки злоумышленного сервера авторизации выдавать себя за другой сервер авторизации через метаданные сервера авторизации. Клиент должен отклонить метаданные, если URL издателя (issuer) в метаданных не совпадает точно с преднастроенным URL издателя, ожидаемым клиентом.",
              "L": "2"
            },
            {
              "Shortcode": "V10.5.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что клиент проверяет, что ID Token предназначен для него (проверка audience), сравнивая значение 'aud' в токене с 'client_id' клиента.",
              "L": "2"
            },
            {
              "Shortcode": "V10.5.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что при использовании OIDC back-channel logout клиент снижает риск отказа в обслуживании, вызванный принудительным выходом из системы и путаницей между разными типами JWT (cross-JWT confusion) в процессе логаута. Клиент должен проверить, что токен выхода корректно типизирован со значением 'logout+jwt', содержит claim 'event' с правильным именем участника и не содержит 'nonce'. Также рекомендуется установить короткий срок действия токена (например, 2 минуты).",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V10.6",
          "Ordinal": 6,
          "Name": "Провайдер OpenID",
          "Items": [
            {
              "Shortcode": "V10.6.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что провайдер OpenID допускает только значения 'code', 'ciba', 'id_token' или 'id_token code' для параметра response mode. При этом предпочтение отдаётся 'code' по сравнению с 'id_token code' (гибридный поток OIDC), а значение 'token' (любой Implicit flow) не должно использоваться.",
              "L": "2"
            },
            {
              "Shortcode": "V10.6.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что провайдер OpenID предотвращает отказ в обслуживании (DoS) через принудительный выход (logout), запрашивая явное подтверждение от конечного пользователя или, если применимо, проверяя параметры в запросе выхода (инициированном relying party), например параметр 'id_token_hint'.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V10.7",
          "Ordinal": 7,
          "Name": "Управление согласием",
          "Items": [
            {
              "Shortcode": "V10.7.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что авторизационный сервер обеспечивает получение согласия пользователя для каждого запроса авторизации. Если личность клиента не может быть подтверждена, сервер авторизации всегда должен явно запрашивать согласие пользователя.",
              "L": "2"
            },
            {
              "Shortcode": "V10.7.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что при запросе согласия пользователя авторизационный сервер предоставляет достаточную и понятную информацию о том, на что даётся согласие. При необходимости это должно включать характер запрашиваемых разрешений (обычно основанных на scope, ресурсном сервере, деталях авторизации Rich Authorization Requests (RAR)), идентификацию авторизованного приложения и срок действия этих разрешений.",
              "L": "2"
            },
            {
              "Shortcode": "V10.7.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что пользователь может просматривать, изменять и отзывать согласия, которые он предоставил, через авторизационный сервер.",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V11",
      "Ordinal": 11,
      "ShortName": "Криптография",
      "Name": "Криптография",
      "Items": [
        {
          "Shortcode": "V11.1",
          "Ordinal": 1,
          "Name": "Инвентаризация и документирование криптографии",
          "Items": [
            {
              "Shortcode": "V11.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что задокументирована политика управления криптографическими ключами и описан их жизненный цикл в соответствии со стандартом управления ключей, таким как NIST SP 800-57. Убедитесь, что ключи известны только тем сущностям, которым они должны быть доступны (например, ключи не передавались более чем двум участникам для общих секретов и более чем одному участнику для приватных ключей).",
              "L": "2"
            },
            {
              "Shortcode": "V11.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что проводится инвентаризация криптографических средств, которая непрерывно поддерживается, регулярно обновляется и включает все криптографические ключи, алгоритмы и сертификаты, используемые в приложении. Также должна быть задокументирована информация о том, где ключи могут и не могут использоваться в системе, а также какие типы данных могут и не могут быть защищены с помощью этих ключей.",
              "L": "2"
            },
            {
              "Shortcode": "V11.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что используются механизмы обнаружения криптографии для идентификации всех случаев применения криптографии в системе , включая операции шифрования, хеширования и цифровой подписи.",
              "L": "3"
            },
            {
              "Shortcode": "V11.1.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что ведётся и поддерживается инвентаризация криптографических средств. В неё должен входить документированный план, описывающий переход на новые криптографические стандарты, такие как постквантовая криптография, чтобы своевременно реагировать на будущие угрозы.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V11.2",
          "Ordinal": 2,
          "Name": "Безопасная реализация криптографии",
          "Items": [
            {
              "Shortcode": "V11.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что для криптографических операций используются  утвержденные в индустрии реализации (включая библиотеки и аппаратные реализации).",
              "L": "2"
            },
            {
              "Shortcode": "V11.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что архитектура приложения поддерживает быструю реконфигурацию, усовершенствование или смену в любой момент случайных чисел, аутентифицированного шифрования, MAC, алгоритмов хеширования, длин ключей, количества раундов, шифров и режимов шифрования для защиты от криптографических атак. Также должна поддерживаться возможность смены ключей, паролей и повторного шифрования данных. Это позволит беспрепятственно перейти на постквантовую криптографию (PQC), как только станут широко доступны высоконадёжные реализации одобренных схем или стандартов PQC.",
              "L": "2"
            },
            {
              "Shortcode": "V11.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что все криптографические примитивы используют как минимум 128-бит стойкости с учетом алгоритма, размера ключа и конфигурации. Например, 256-битный ECC ключ обеспечивает примерно 128 бит безопасности, тогда как для достижения того же уровня безопасности в RSA требуется ключ длиной 3072 бита.",
              "L": "2"
            },
            {
              "Shortcode": "V11.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что все криптографические операции выполняются за константное время, без использования \"short-circuit\" операций в сравнениях, вычислениях, возвратах функций для избежания утечек информации.",
              "L": "3"
            },
            {
              "Shortcode": "V11.2.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что все криптографические модули обеспечивают безопасное завершение работы при ошибках, а обработка ошибок реализована таким образом, чтобы не создавать уязвимостей, например, таких как атаки Padding Oracle.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V11.3",
          "Ordinal": 3,
          "Name": "Алгоритмы шифрования",
          "Items": [
            {
              "Shortcode": "V11.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что не используются небезопасные режимы блочного шифрования (н-р, ECB) и слабые схемы дополнения (padding) (н-р, PKCS#1 v1.5).",
              "L": "1"
            },
            {
              "Shortcode": "V11.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что используются только утверждённые шифры и режимы, такие как AES с GCM.",
              "L": "1"
            },
            {
              "Shortcode": "V11.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что зашифрованные данные защищены от несанкционированного изменения, предпочтительно с использованием утверждённого метода аутентифицированного шифрования или путём комбинирования утверждённого метода шифрования с утверждённым алгоритмом MAC.",
              "L": "2"
            },
            {
              "Shortcode": "V11.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что случайные числа (nonce), векторы инициализации (IV) и другие одноразовые числа не используются более одного раза для одной и той же пары ключа шифрования и элемента данных. Метод их генерации должен соответствовать требованиям используемого алгоритма.",
              "L": "3"
            },
            {
              "Shortcode": "V11.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что любая комбинация алгоритма шифрования и алгоритма MAC работает в режиме encrypt-then-MAC (EtM).",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V11.4",
          "Ordinal": 4,
          "Name": "Хеширование и функции на основе хеширования",
          "Items": [
            {
              "Shortcode": "V11.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что только утвержденные хэш-функции используются для стандартных сценариев использования в криптографии, включая цифровую подпись, HMAC, KDF, генерацию случайных чисел. Запрещено использовать неустойчивые хэш-функции, (н-р, MD5) для любого использования в криптографии.",
              "L": "1"
            },
            {
              "Shortcode": "V11.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что пароли хранятся с использованием утверждённой, вычислительно затратной функции генерации ключа (также известной как «функция хеширования паролей»), с параметрами, настроенными в соответствии с актуальными рекомендациями. Настройки должны обеспечивать баланс между безопасностью и производительностью, чтобы сделать атаки перебором достаточно сложными для требуемого уровня безопасности.",
              "L": "2"
            },
            {
              "Shortcode": "V11.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что хэш-функции, используемые в формировании цифровой подписи, как часть аутентификации и целостности данных, устойчивы к коллизиям и имеют достаточную длину.",
              "L": "2"
            },
            {
              "Shortcode": "V11.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что приложение использует утвержденную функцию генерации ключа с использованием параметров расширения ключа (key stretching) при генерации ключа из пароля. Параметры должны быть сбалансированы с точки зрения безопасности, производительности и устойчивости к атакам полного перебора при компрометации результирующего криптографического ключа.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V11.5",
          "Ordinal": 5,
          "Name": "Случайные значения",
          "Items": [
            {
              "Shortcode": "V11.5.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что все случайные числа и строки, которые должны быть непредсказуемы, должны быть сгенерированы с помощью CSPRNG и иметь хотя бы 128 бит энтропии. Учтите, что UUID не удовлетворяют данному условию.",
              "L": "2"
            },
            {
              "Shortcode": "V11.5.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что механизм генерации случайных чисел является надежным даже при высокой нагрузке.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V11.6",
          "Ordinal": 6,
          "Name": "Криптография с публичным ключом",
          "Items": [
            {
              "Shortcode": "V11.6.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что только утвержденные криптографические алгоритмы и режимы операций используются для генерации ключа и инициализации случайного значения для его генерации (seeding), а также для генерации цифровой подписи и верификации. Алгоритмы генерации ключей не должны генерировать небезопасные ключи уязвимые к известным атакам, например, ключи RSA уязвимы к факторизации Ферма.",
              "L": "2"
            },
            {
              "Shortcode": "V11.6.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что для обмена ключами используются утверждённые криптографические алгоритмы (например, Диффи-Хеллман) с особым вниманием к обеспечению использования безопасных параметров. Это предотвратит атаки на процесс установления ключа, которые могут привести к атакам «человек посередине» или криптографическим взломам.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V11.7",
          "Ordinal": 7,
          "Name": "Шифрование данных в процессе использования",
          "Items": [
            {
              "Shortcode": "V11.7.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что используется полное шифрование памяти, которое защищает конфиденциальные данные во время их использования, предотвращая доступ к ним неавторизованных пользователей или процессов.",
              "L": "3"
            },
            {
              "Shortcode": "V11.7.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что минимизация данных обеспечивает раскрытие минимально необходимого объёма данных во время обработки, а также что данные шифруются сразу после использования или как можно скорее.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V12",
      "Ordinal": 12,
      "ShortName": "Secure",
      "Name": "Безопасная коммуникация",
      "Items": [
        {
          "Shortcode": "V12.1",
          "Ordinal": 1,
          "Name": "Общие рекомендации по безопасности TLS",
          "Items": [
            {
              "Shortcode": "V12.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что включены только актуальные и рекомендуемые версии протокола TLS, такие как TLS 1.2 и TLS 1.3. Наиболее свежая версия TLS должна быть выбрана как предпочтительная.",
              "L": "1"
            },
            {
              "Shortcode": "V12.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что включены рекомендуемые шифронаборы (cipher suites), предпочтение также стоит отдать самому сильному шифронабору. L3 приложения должны поддерживать только те наборы шифров (cipher suites), которые обеспечивают прямую (forward) секретность. Пояснение: Прямая секретность (Forward Secrecy, FS) — это криптографическая особенность, при которой сессионные ключи уникальны для каждой сессии и не зависят от долгосрочных ключей. Это гарантирует, что даже при компрометации долгосрочного ключа злоумышленник не сможет расшифровать ранее перехваченные зашифрованные сессии.",
              "L": "2"
            },
            {
              "Shortcode": "V12.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что приложение проверяет доверенность клиентских сертификатов mTLS, прежде чем использовать идентификацию по сертификату для аутентификации или авторизации.",
              "L": "2"
            },
            {
              "Shortcode": "V12.1.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что включена и настроена правильная проверка отзыва сертификатов, такая как Online Certificate Status Protocol (OCSP) Stapling.",
              "L": "3"
            },
            {
              "Shortcode": "V12.1.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что в настройках TLS приложения включена функция Encrypted Client Hello (ECH) для предотвращения раскрытия конфиденциальных метаданных, таких как Server Name Indication (SNI), во время процесса TLS-рукопожатия.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V12.2",
          "Ordinal": 2,
          "Name": "HTTPS коммуникация с внешними сервисами",
          "Items": [
            {
              "Shortcode": "V12.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что для всех соединений между клиентом и внешними HTTP-сервисами используется TLS и не происходит отката к небезопасным или незашифрованным протоколам.",
              "L": "1"
            },
            {
              "Shortcode": "V12.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что внешние сервисы используют публично доверенные TLS-сертификаты.",
              "L": "1"
            }
          ]
        },
        {
          "Shortcode": "V12.3",
          "Ordinal": 3,
          "Name": "Общая безопасность межсервисного взаимодействия",
          "Items": [
            {
              "Shortcode": "V12.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что для всех входящих и исходящих соединений приложения используется зашифрованный протокол, например TLS, включая системы мониторинга, инструменты управления, удалённый доступ и SSH, промежуточное ПО, базы данных, мейнфреймы, партнёрские системы и внешние API. Сервер не должен допускать откат к небезопасным или незашифрованным протоколам.",
              "L": "2"
            },
            {
              "Shortcode": "V12.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что TLS-клиент проверяет сертификат сервера до установления защищенного соединения с TLS-сервером.",
              "L": "2"
            },
            {
              "Shortcode": "V12.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что все внутренние HTTP-взаимодействия между компонентами приложения используют TLS или другой подходящий механизм транспортного шифрования, и не происходит откат к небезопасным или незашифрованным коммуникациям.",
              "L": "2"
            },
            {
              "Shortcode": "V12.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что TLS-соединения между внутренними сервисами используют доверенные сертификаты. Если используются внутренние или самоподписанные сертификаты, потребляющий сервис должен быть настроен на доверие только к конкретным внутренним центрам сертификации (CA) и конкретным самоподписанным сертификатам.",
              "L": "2"
            },
            {
              "Shortcode": "V12.3.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что сервисы, взаимодействующие внутри системы (intra-service communications), используют строгую аутентификацию для проверки каждого конечного узла. Для проверки подлинности взаимодействующих сторон должны применяться методы строгой аутентификации, такие как аутентификация TLS-клиента, с использованием инфраструктуры открытых ключей и механизмов, устойчивых к атакам повтора (replay attacks). Для микросервисных архитектур рекомендуется использование service mesh для упрощения управления сертификатами и повышения безопасности.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V13",
      "Ordinal": 13,
      "ShortName": "Конфигурация",
      "Name": "Конфигурация",
      "Items": [
        {
          "Shortcode": "V13.1",
          "Ordinal": 1,
          "Name": "Документация конфигурации",
          "Items": [
            {
              "Shortcode": "V13.1.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что все необходимые доступы приложения задокументированы. Сюда должны быть включены как внешние сервисы, от которых зависит приложение, так и сценарии, когда конечный пользователь может задавать адреса для внешнего подключения.",
              "L": "2"
            },
            {
              "Shortcode": "V13.1.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что для каждого сервиса, используемого приложением, в документации определено максимальное количество одновременных соединений (например, лимиты пула соединений) и описано поведение приложения при достижении этого лимита, включая любые механизмы отказоустойчивости или восстановления, чтобы предотвратить ситуации отказа в обслуживании (DoS).",
              "L": "3"
            },
            {
              "Shortcode": "V13.1.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что в документации приложения определены стратегии управления ресурсами для каждой внешней системы или сервиса, которые оно использует (например, базы данных, файловые дескрипторы, потоки, HTTP-соединения). Стратегии должны включать процедуры освобождения ресурсов, настройки таймаутов, обработку сбоев, а также, если реализована логика повторных попыток, указание лимитов, задержек и алгоритмов back-off. Для синхронных HTTP-запросов должны быть заданы короткие таймауты, а повторные запросы должны быть отключены, либо строго ограничены по числу попыток, чтобы предотвратить каскадные задержки и истощение ресурсов.",
              "L": "3"
            },
            {
              "Shortcode": "V13.1.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что в документации приложения определены секреты, критически важные для безопасности приложения, а также установлен график их ротации в соответствии с моделью угроз организации и её бизнес-требованиями.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V13.2",
          "Ordinal": 2,
          "Name": "Конфигурация бэкенд соединений",
          "Items": [
            {
              "Shortcode": "V13.2.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что коммуникации между компонентами бэкенда приложения ( API, промежуточное ПО и уровни данных,), которые не поддерживают стандартный механизм пользовательских сессий, проходят с аутентификацией. Аутентификация должна использовать индивидуальные сервисные аккаунты, краткосрочные токены или аутентификацию на основе сертификатов, а не постоянные учётные данные, такие как пароли, API-ключи или общие аккаунты с привилегированным доступом.",
              "L": "2"
            },
            {
              "Shortcode": "V13.2.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что коммуникации между компонентами бэкенда приложения, включая локальные или системные службы, API, промежуточное ПО и уровни данных, выполняются с использованием аккаунтов, которым назначены минимально необходимые привилегии.",
              "L": "2"
            },
            {
              "Shortcode": "V13.2.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что если для аутентификации в сервисе используются учётные данные, то используемые потребителем учётные данные не являются стандартными (например, root/root или admin/admin).",
              "L": "2"
            },
            {
              "Shortcode": "V13.2.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что используется белый список (allowlist) для определения внешних ресурсов или систем, с которыми приложению разрешено взаимодействовать (например, для исходящих запросов, загрузки данных или доступа к файлам). Этот белый список может быть реализован на уровне приложения, веб-сервера, межсетевого экрана или комбинации различных уровней.",
              "L": "2"
            },
            {
              "Shortcode": "V13.2.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что веб- или прикладной сервер настроен с белым списком ресурсов или систем, к которым сервер может отправлять запросы или из которых может загружать данные и файлы.",
              "L": "2"
            },
            {
              "Shortcode": "V13.2.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что при подключении приложения к другим сервисам соблюдается задокументированная конфигурация для каждого соединения, включая максимальное количество параллельных соединений, поведение при достижении их максимума, таймауты и стратегии повторных попыток подключения.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V13.3",
          "Ordinal": 3,
          "Name": "Управление секретами",
          "Items": [
            {
              "Shortcode": "V13.3.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что для безопасного создания, хранения, контроля доступа и уничтожения секретов бэкенда используется решение для управления секретами, например, хранилище ключей (key vault). Секретами могут быть пароли, ключевой материал, интеграции с базами данных и сторонними системами, ключи и seed-значения для токенов с ограниченным временем действия, другие внутренние секреты и API-ключи. Секреты не должны включаться в исходный код приложения или артефакты сборки. Для приложений уровня L3 необходимо использовать аппаратное решение, например, аппаратный модуль безопасности (HSM).",
              "L": "2"
            },
            {
              "Shortcode": "V13.3.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что доступ к секретным ресурсам осуществляется в соответствии с принципом минимально необходимых привилегий (least privilege).",
              "L": "2"
            },
            {
              "Shortcode": "V13.3.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что все криптографические операции выполняются с использованием изолированного модуля безопасности (например, хранилища ключей или аппаратного модуля безопасности), чтобы надежно управлять ключевым материалом и защищать его от утечки за пределы модуля безопасности.",
              "L": "3"
            },
            {
              "Shortcode": "V13.3.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что секреты настроены на срок действия и ротацию в соответствии с документацией приложения.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V13.4",
          "Ordinal": 4,
          "Name": "Непреднамеренная утечка информации",
          "Items": [
            {
              "Shortcode": "V13.4.1",
              "Ordinal": 1,
              "Description": "Убедитесь, что приложение развернуто либо без метаданных систем контроля версий (включая папки .git или .svn), либо так, чтобы эти папки были недоступны как извне, так и для самого приложения.",
              "L": "1"
            },
            {
              "Shortcode": "V13.4.2",
              "Ordinal": 2,
              "Description": "Убедитесь, что режимы отладки отключены для всех компонентов в промышленной среде, чтобы предотвратить раскрытие функций отладки и утечку информации.",
              "L": "2"
            },
            {
              "Shortcode": "V13.4.3",
              "Ordinal": 3,
              "Description": "Убедитесь, что веб-серверы не показывают клиентам списки содержимого каталогов, если это явно не предусмотрено.",
              "L": "2"
            },
            {
              "Shortcode": "V13.4.4",
              "Ordinal": 4,
              "Description": "Убедитесь, что метод HTTP TRACE не поддерживается в продуктовой среде, чтобы избежать потенциальной утечки информации.",
              "L": "2"
            },
            {
              "Shortcode": "V13.4.5",
              "Ordinal": 5,
              "Description": "Убедитесь, что документация (например, по внутренним API) и мониторинговые эндпоинты не доступны, если это явно не предусмотрено.",
              "L": "2"
            },
            {
              "Shortcode": "V13.4.6",
              "Ordinal": 6,
              "Description": "Убедитесь, что приложение не раскрывает подробную информацию о версиях компонентов бэкенда.",
              "L": "3"
            },
            {
              "Shortcode": "V13.4.7",
              "Ordinal": 7,
              "Description": "Убедитесь, что веб-слой настроен на обслуживание только файлов с определёнными расширениями, чтобы предотвратить непреднамеренную утечку информации, конфигураций и исходного кода.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V14",
      "Ordinal": 14,
      "ShortName": "Data",
      "Name": "Data Protection",
      "Items": [
        {
          "Shortcode": "V14.1",
          "Ordinal": 1,
          "Name": "Data Protection Documentation",
          "Items": [
            {
              "Shortcode": "V14.1.1",
              "Ordinal": 1,
              "Description": "Verify that all sensitive data created and processed by the application has been identified and classified into protection levels. This includes data that is only encoded and therefore easily decoded, such as Base64 strings or the plaintext payload inside a JWT. Protection levels need to take into account any data protection and privacy regulations and standards which the application is required to comply with.",
              "L": "2"
            },
            {
              "Shortcode": "V14.1.2",
              "Ordinal": 2,
              "Description": "Verify that all sensitive data protection levels have a documented set of protection requirements. This must include (but not be limited to) requirements related to general encryption, integrity verification, retention, how the data is to be logged, access controls around sensitive data in logs, database-level encryption, privacy and privacy-enhancing technologies to be used, and other confidentiality requirements.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V14.2",
          "Ordinal": 2,
          "Name": "General Data Protection",
          "Items": [
            {
              "Shortcode": "V14.2.1",
              "Ordinal": 1,
              "Description": "Verify that sensitive data is only sent to the server in the HTTP message body or header fields, and that the URL and query string do not contain sensitive information, such as an API key or session token.",
              "L": "1"
            },
            {
              "Shortcode": "V14.2.2",
              "Ordinal": 2,
              "Description": "Verify that the application prevents sensitive data from being cached in server components, such as load balancers and application caches, or ensures that the data is securely purged after use.",
              "L": "2"
            },
            {
              "Shortcode": "V14.2.3",
              "Ordinal": 3,
              "Description": "Verify that defined sensitive data is not sent to untrusted parties (e.g., user trackers) to prevent unwanted collection of data outside of the application's control.",
              "L": "2"
            },
            {
              "Shortcode": "V14.2.4",
              "Ordinal": 4,
              "Description": "Verify that controls around sensitive data related to encryption, integrity verification, retention, how the data is to be logged, access controls around sensitive data in logs, privacy and privacy-enhancing technologies, are implemented as defined in the documentation for the specific data's protection level.",
              "L": "2"
            },
            {
              "Shortcode": "V14.2.5",
              "Ordinal": 5,
              "Description": "Verify that caching mechanisms are configured to only cache responses which have the expected content type for that resource and do not contain sensitive, dynamic content. The web server should return a 404 or 302 response when a non-existent file is accessed rather than returning a different, valid file. This should prevent Web Cache Deception attacks.",
              "L": "3"
            },
            {
              "Shortcode": "V14.2.6",
              "Ordinal": 6,
              "Description": "Verify that the application only returns the minimum required sensitive data for the application's functionality. For example, only returning some of the digits of a credit card number and not the full number. If the complete data is required, it should be masked in the user interface unless the user specifically views it.",
              "L": "3"
            },
            {
              "Shortcode": "V14.2.7",
              "Ordinal": 7,
              "Description": "Verify that sensitive information is subject to data retention classification, ensuring that outdated or unnecessary data is deleted automatically, on a defined schedule, or as the situation requires.",
              "L": "3"
            },
            {
              "Shortcode": "V14.2.8",
              "Ordinal": 8,
              "Description": "Verify that sensitive information is removed from the metadata of user-submitted files unless storage is consented to by the user.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V14.3",
          "Ordinal": 3,
          "Name": "Client-side Data Protection",
          "Items": [
            {
              "Shortcode": "V14.3.1",
              "Ordinal": 1,
              "Description": "Verify that authenticated data is cleared from client storage, such as the browser DOM, after the client or session is terminated. The 'Clear-Site-Data' HTTP response header field may be able to help with this but the client-side should also be able to clear up if the server connection is not available when the session is terminated.",
              "L": "1"
            },
            {
              "Shortcode": "V14.3.2",
              "Ordinal": 2,
              "Description": "Verify that the application sets sufficient anti-caching HTTP response header fields (i.e., Cache-Control: no-store) so that sensitive data is not cached in browsers.",
              "L": "2"
            },
            {
              "Shortcode": "V14.3.3",
              "Ordinal": 3,
              "Description": "Verify that data stored in browser storage (such as localStorage, sessionStorage, IndexedDB, or cookies) does not contain sensitive data, with the exception of session tokens.",
              "L": "2"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V15",
      "Ordinal": 15,
      "ShortName": "Secure",
      "Name": "Secure Coding and Architecture",
      "Items": [
        {
          "Shortcode": "V15.1",
          "Ordinal": 1,
          "Name": "Secure Coding and Architecture Documentation",
          "Items": [
            {
              "Shortcode": "V15.1.1",
              "Ordinal": 1,
              "Description": "Verify that application documentation defines risk based remediation time frames for 3rd party component versions with vulnerabilities and for updating libraries in general, to minimize the risk from these components.",
              "L": "1"
            },
            {
              "Shortcode": "V15.1.2",
              "Ordinal": 2,
              "Description": "Verify that an inventory catalog, such as software bill of materials (SBOM), is maintained of all third-party libraries in use, including verifying that components come from pre-defined, trusted, and continually maintained repositories.",
              "L": "2"
            },
            {
              "Shortcode": "V15.1.3",
              "Ordinal": 3,
              "Description": "Verify that the application documentation identifies functionality which is time-consuming or resource-demanding. This must include how to prevent a loss of availability due to overusing this functionality and how to avoid a situation where building a response takes longer than the consumer's timeout. Potential defenses may include asynchronous processing, using queues, and limiting parallel processes per user and per application.",
              "L": "2"
            },
            {
              "Shortcode": "V15.1.4",
              "Ordinal": 4,
              "Description": "Verify that application documentation highlights third-party libraries which are considered to be \"risky components\".",
              "L": "3"
            },
            {
              "Shortcode": "V15.1.5",
              "Ordinal": 5,
              "Description": "Verify that application documentation highlights parts of the application where \"dangerous functionality\" is being used.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V15.2",
          "Ordinal": 2,
          "Name": "Security Architecture and Dependencies",
          "Items": [
            {
              "Shortcode": "V15.2.1",
              "Ordinal": 1,
              "Description": "Verify that the application only contains components which have not breached the documented update and remediation time frames.",
              "L": "1"
            },
            {
              "Shortcode": "V15.2.2",
              "Ordinal": 2,
              "Description": "Verify that the application has implemented defenses against loss of availability due to functionality which is time-consuming or resource-demanding, based on the documented security decisions and strategies for this.",
              "L": "2"
            },
            {
              "Shortcode": "V15.2.3",
              "Ordinal": 3,
              "Description": "Verify that the production environment only includes functionality that is required for the application to function, and does not expose extraneous functionality such as test code, sample snippets, and development functionality.",
              "L": "2"
            },
            {
              "Shortcode": "V15.2.4",
              "Ordinal": 4,
              "Description": "Verify that third-party components and all of their transitive dependencies are included from the expected repository, whether internally owned or an external source, and that there is no risk of a dependency confusion attack.",
              "L": "3"
            },
            {
              "Shortcode": "V15.2.5",
              "Ordinal": 5,
              "Description": "Verify that the application implements additional protections around parts of the application which are documented as containing \"dangerous functionality\" or using third-party libraries considered to be \"risky components\". This could include techniques such as sandboxing, encapsulation, containerization or network level isolation to delay and deter attackers who compromise one part of an application from pivoting elsewhere in the application.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V15.3",
          "Ordinal": 3,
          "Name": "Defensive Coding",
          "Items": [
            {
              "Shortcode": "V15.3.1",
              "Ordinal": 1,
              "Description": "Verify that the application only returns the required subset of fields from a data object. For example, it should not return an entire data object, as some individual fields should not be accessible to users.",
              "L": "1"
            },
            {
              "Shortcode": "V15.3.2",
              "Ordinal": 2,
              "Description": "Verify that where the application backend makes calls to external URLs, it is configured to not follow redirects unless it is intended functionality.",
              "L": "2"
            },
            {
              "Shortcode": "V15.3.3",
              "Ordinal": 3,
              "Description": "Verify that the application has countermeasures to protect against mass assignment attacks by limiting allowed fields per controller and action, e.g., it is not possible to insert or update a field value when it was not intended to be part of that action.",
              "L": "2"
            },
            {
              "Shortcode": "V15.3.4",
              "Ordinal": 4,
              "Description": "Verify that all proxying and middleware components transfer the user's original IP address correctly using trusted data fields that cannot be manipulated by the end user, and the application and web server use this correct value for logging and security decisions such as rate limiting, taking into account that even the original IP address may not be reliable due to dynamic IPs, VPNs, or corporate firewalls.",
              "L": "2"
            },
            {
              "Shortcode": "V15.3.5",
              "Ordinal": 5,
              "Description": "Verify that the application explicitly ensures that variables are of the correct type and performs strict equality and comparator operations. This is to avoid type juggling or type confusion vulnerabilities caused by the application code making an assumption about a variable type.",
              "L": "2"
            },
            {
              "Shortcode": "V15.3.6",
              "Ordinal": 6,
              "Description": "Verify that JavaScript code is written in a way that prevents prototype pollution, for example, by using Set() or Map() instead of object literals.",
              "L": "2"
            },
            {
              "Shortcode": "V15.3.7",
              "Ordinal": 7,
              "Description": "Verify that the application has defenses against HTTP parameter pollution attacks, particularly if the application framework makes no distinction about the source of request parameters (query string, body parameters, cookies, or header fields).",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V15.4",
          "Ordinal": 4,
          "Name": "Safe Concurrency",
          "Items": [
            {
              "Shortcode": "V15.4.1",
              "Ordinal": 1,
              "Description": "Verify that shared objects in multi-threaded code (such as caches, files, or in-memory objects accessed by multiple threads) are accessed safely by using thread-safe types and synchronization mechanisms like locks or semaphores to avoid race conditions and data corruption.",
              "L": "3"
            },
            {
              "Shortcode": "V15.4.2",
              "Ordinal": 2,
              "Description": "Verify that checks on a resource's state, such as its existence or permissions, and the actions that depend on them are performed as a single atomic operation to prevent time-of-check to time-of-use (TOCTOU) race conditions. For example, checking if a file exists before opening it, or verifying a user’s access before granting it.",
              "L": "3"
            },
            {
              "Shortcode": "V15.4.3",
              "Ordinal": 3,
              "Description": "Verify that locks are used consistently to avoid threads getting stuck, whether by waiting on each other or retrying endlessly, and that locking logic stays within the code responsible for managing the resource to ensure locks cannot be inadvertently or maliciously modified by external classes or code.",
              "L": "3"
            },
            {
              "Shortcode": "V15.4.4",
              "Ordinal": 4,
              "Description": "Verify that resource allocation policies prevent thread starvation by ensuring fair access to resources, such as by leveraging thread pools, allowing lower-priority threads to proceed within a reasonable timeframe.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V16",
      "Ordinal": 16,
      "ShortName": "Security",
      "Name": "Security Logging and Error Handling",
      "Items": [
        {
          "Shortcode": "V16.1",
          "Ordinal": 1,
          "Name": "Security Logging Documentation",
          "Items": [
            {
              "Shortcode": "V16.1.1",
              "Ordinal": 1,
              "Description": "Verify that an inventory exists documenting the logging performed at each layer of the application's technology stack, what events are being logged, log formats, where that logging is stored, how it is used, how access to it is controlled, and for how long logs are kept.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V16.2",
          "Ordinal": 2,
          "Name": "General Logging",
          "Items": [
            {
              "Shortcode": "V16.2.1",
              "Ordinal": 1,
              "Description": "Verify that each log entry includes necessary metadata (such as when, where, who, what) that would allow for a detailed investigation of the timeline when an event happens.",
              "L": "2"
            },
            {
              "Shortcode": "V16.2.2",
              "Ordinal": 2,
              "Description": "Verify that time sources for all logging components are synchronized, and that timestamps in security event metadata use UTC or include an explicit time zone offset. UTC is recommended to ensure consistency across distributed systems and to prevent confusion during daylight saving time transitions.",
              "L": "2"
            },
            {
              "Shortcode": "V16.2.3",
              "Ordinal": 3,
              "Description": "Verify that the application only stores or broadcasts logs to the files and services that are documented in the log inventory.",
              "L": "2"
            },
            {
              "Shortcode": "V16.2.4",
              "Ordinal": 4,
              "Description": "Verify that logs can be read and correlated by the log processor that is in use, preferably by using a common logging format.",
              "L": "2"
            },
            {
              "Shortcode": "V16.2.5",
              "Ordinal": 5,
              "Description": "Verify that when logging sensitive data, the application enforces logging based on the data's protection level. For example, it may not be allowed to log certain data, such as credentials or payment details. Other data, such as session tokens, may only be logged by being hashed or masked, either in full or partially.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V16.3",
          "Ordinal": 3,
          "Name": "Security Events",
          "Items": [
            {
              "Shortcode": "V16.3.1",
              "Ordinal": 1,
              "Description": "Verify that all authentication operations are logged, including successful and unsuccessful attempts. Additional metadata, such as the type of authentication or factors used, should also be collected.",
              "L": "2"
            },
            {
              "Shortcode": "V16.3.2",
              "Ordinal": 2,
              "Description": "Verify that failed authorization attempts are logged. For L3, this must include logging all authorization decisions, including logging when sensitive data is accessed (without logging the sensitive data itself).",
              "L": "2"
            },
            {
              "Shortcode": "V16.3.3",
              "Ordinal": 3,
              "Description": "Verify that the application logs the security events that are defined in the documentation and also logs attempts to bypass the security controls, such as input validation, business logic, and anti-automation.",
              "L": "2"
            },
            {
              "Shortcode": "V16.3.4",
              "Ordinal": 4,
              "Description": "Verify that the application logs unexpected errors and security control failures such as backend TLS failures.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V16.4",
          "Ordinal": 4,
          "Name": "Log Protection",
          "Items": [
            {
              "Shortcode": "V16.4.1",
              "Ordinal": 1,
              "Description": "Verify that all logging components appropriately encode data to prevent log injection.",
              "L": "2"
            },
            {
              "Shortcode": "V16.4.2",
              "Ordinal": 2,
              "Description": "Verify that logs are protected from unauthorized access and cannot be modified.",
              "L": "2"
            },
            {
              "Shortcode": "V16.4.3",
              "Ordinal": 3,
              "Description": "Verify that logs are securely transmitted to a logically separate system for analysis, detection, alerting, and escalation. The aim is to ensure that if the application is breached, the logs are not compromised.",
              "L": "2"
            }
          ]
        },
        {
          "Shortcode": "V16.5",
          "Ordinal": 5,
          "Name": "Error Handling",
          "Items": [
            {
              "Shortcode": "V16.5.1",
              "Ordinal": 1,
              "Description": "Verify that a generic message is returned to the consumer when an unexpected or security-sensitive error occurs, ensuring no exposure of sensitive internal system data such as stack traces, queries, secret keys, and tokens.",
              "L": "2"
            },
            {
              "Shortcode": "V16.5.2",
              "Ordinal": 2,
              "Description": "Verify that the application continues to operate securely when external resource access fails, for example, by using patterns such as circuit breakers or graceful degradation.",
              "L": "2"
            },
            {
              "Shortcode": "V16.5.3",
              "Ordinal": 3,
              "Description": "Verify that the application fails gracefully and securely, including when an exception occurs, preventing fail-open conditions such as processing a transaction despite errors resulting from validation logic.",
              "L": "2"
            },
            {
              "Shortcode": "V16.5.4",
              "Ordinal": 4,
              "Description": "Verify that a \"last resort\" error handler is defined which will catch all unhandled exceptions. This is both to avoid losing error details that must go to log files and to ensure that an error does not take down the entire application process, leading to a loss of availability.",
              "L": "3"
            }
          ]
        }
      ]
    },
    {
      "Shortcode": "V17",
      "Ordinal": 17,
      "ShortName": "WebRTC",
      "Name": "WebRTC",
      "Items": [
        {
          "Shortcode": "V17.1",
          "Ordinal": 1,
          "Name": "TURN Server",
          "Items": [
            {
              "Shortcode": "V17.1.1",
              "Ordinal": 1,
              "Description": "Verify that the Traversal Using Relays around NAT (TURN) service only allows access to IP addresses that are not reserved for special purposes (e.g., internal networks, broadcast, loopback). Note that this applies to both IPv4 and IPv6 addresses.",
              "L": "2"
            },
            {
              "Shortcode": "V17.1.2",
              "Ordinal": 2,
              "Description": "Verify that the Traversal Using Relays around NAT (TURN) service is not susceptible to resource exhaustion when legitimate users attempt to open a large number of ports on the TURN server.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V17.2",
          "Ordinal": 2,
          "Name": "Media",
          "Items": [
            {
              "Shortcode": "V17.2.1",
              "Ordinal": 1,
              "Description": "Verify that the key for the Datagram Transport Layer Security (DTLS) certificate is managed and protected based on the documented policy for management of cryptographic keys.",
              "L": "2"
            },
            {
              "Shortcode": "V17.2.2",
              "Ordinal": 2,
              "Description": "Verify that the media server is configured to use and support approved Datagram Transport Layer Security (DTLS) cipher suites and a secure protection profile for the DTLS Extension for establishing keys for the Secure Real-time Transport Protocol (DTLS-SRTP).",
              "L": "2"
            },
            {
              "Shortcode": "V17.2.3",
              "Ordinal": 3,
              "Description": "Verify that Secure Real-time Transport Protocol (SRTP) authentication is checked at the media server to prevent Real-time Transport Protocol (RTP) injection attacks from leading to either a Denial of Service condition or audio or video media insertion into media streams.",
              "L": "2"
            },
            {
              "Shortcode": "V17.2.4",
              "Ordinal": 4,
              "Description": "Verify that the media server is able to continue processing incoming media traffic when encountering malformed Secure Real-time Transport Protocol (SRTP) packets.",
              "L": "2"
            },
            {
              "Shortcode": "V17.2.5",
              "Ordinal": 5,
              "Description": "Verify that the media server is able to continue processing incoming media traffic during a flood of Secure Real-time Transport Protocol (SRTP) packets from legitimate users.",
              "L": "3"
            },
            {
              "Shortcode": "V17.2.6",
              "Ordinal": 6,
              "Description": "Verify that the media server is not susceptible to the \"ClientHello\" Race Condition vulnerability in Datagram Transport Layer Security (DTLS) by checking if the media server is publicly known to be vulnerable or by performing the race condition test.",
              "L": "3"
            },
            {
              "Shortcode": "V17.2.7",
              "Ordinal": 7,
              "Description": "Verify that any audio or video recording mechanisms associated with the media server are able to continue processing incoming media traffic during a flood of Secure Real-time Transport Protocol (SRTP) packets from legitimate users.",
              "L": "3"
            },
            {
              "Shortcode": "V17.2.8",
              "Ordinal": 8,
              "Description": "Verify that the Datagram Transport Layer Security (DTLS) certificate is checked against the Session Description Protocol (SDP) fingerprint attribute, terminating the media stream if the check fails, to ensure the authenticity of the media stream.",
              "L": "3"
            }
          ]
        },
        {
          "Shortcode": "V17.3",
          "Ordinal": 3,
          "Name": "Signaling",
          "Items": [
            {
              "Shortcode": "V17.3.1",
              "Ordinal": 1,
              "Description": "Verify that the signaling server is able to continue processing legitimate incoming signaling messages during a flood attack. This should be achieved by implementing rate limiting at the signaling level.",
              "L": "2"
            },
            {
              "Shortcode": "V17.3.2",
              "Ordinal": 2,
              "Description": "Verify that the signaling server is able to continue processing legitimate signaling messages when encountering malformed signaling message that could cause a denial of service condition. This could include implementing input validation, safely handling integer overflows, preventing buffer overflows, and employing other robust error-handling techniques.",
              "L": "2"
            }
          ]
        }
      ]
    }
  ]
}
