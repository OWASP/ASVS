# V13 Конфигурация

## Цель контроля

Стандартная конфигурация приложения должна быть безопасной для использования в Интернете.

В этой главе приводятся рекомендации по различным настройкам, необходимым для достижения этого, включая те, которые применяются на этапах разработки, сборки и развертывания.

Рассматриваемые темы включают предотвращение утечек данных, безопасное управление коммуникациями между компонентами и защиту секретов.

## V13.1 Документация конфигурации

Этот раздел описывает требования к документации, связанные с тем, как приложение взаимодействует с внутренними и внешними сервисами, а также методы предотвращения потери доступности из-за недоступности сервисов. Также рассматриваются вопросы, касающиеся документации секретных данных.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **13.1.1** | Убедитесь, что все необходимые доступы приложения задокументированы. Сюда должны быть включены как внешние сервисы, от которых зависит приложение, так и сценарии, когда конечный пользователь может задавать адреса для внешнего подключения. | 2 |
| **13.1.2** | Убедитесь, что для каждого сервиса, используемого приложением, в документации определено максимальное количество одновременных соединений (например, лимиты пула соединений) и описано поведение приложения при достижении этого лимита, включая любые механизмы отказоустойчивости или восстановления, чтобы предотвратить ситуации отказа в обслуживании (DoS). | 3 |
| **13.1.3** | Убедитесь, что в документации приложения определены стратегии управления ресурсами для каждой внешней системы или сервиса, которые оно использует (например, базы данных, файловые дескрипторы, потоки, HTTP-соединения). Стратегии должны включать процедуры освобождения ресурсов, настройки таймаутов, обработку сбоев, а также, если реализована логика повторных попыток, указание лимитов, задержек и алгоритмов back-off. Для синхронных HTTP-запросов должны быть заданы короткие таймауты, а повторные запросы должны быть отключены, либо строго ограничены по числу попыток, чтобы предотвратить каскадные задержки и истощение ресурсов. | 3 |
| **13.1.4** | Убедитесь, что в документации приложения определены секреты, критически важные для безопасности приложения, а также установлен график их ротации в соответствии с моделью угроз организации и её бизнес-требованиями. | 3 |

## V13.2 Конфигурация бэкенд соединений

Приложения взаимодействуют с множеством сервисов, включая API, базы данных и другие компоненты. Эти сервисы могут считаться внутренними для приложения, но не включёнными в стандартные механизмы контроля доступа приложения, либо быть полностью внешними. В любом случае необходимо настроить приложение для безопасного взаимодействия с этими компонентами и, при необходимости, защитить соответствующую конфигурацию.

Важно: Глава «Безопасная коммуникация» содержит рекомендации по шифрованию данных при передаче.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **13.2.1** | Убедитесь, что коммуникации между компонентами бэкенда приложения ( API, промежуточное ПО и уровни данных,), которые не поддерживают стандартный механизм пользовательских сессий, проходят с аутентификацией. Аутентификация должна использовать индивидуальные сервисные аккаунты, краткосрочные токены или аутентификацию на основе сертификатов, а не постоянные учётные данные, такие как пароли, API-ключи или общие аккаунты с привилегированным доступом. | 2 |
| **13.2.2** | Убедитесь, что коммуникации между компонентами бэкенда приложения, включая локальные или системные службы, API, промежуточное ПО и уровни данных, выполняются с использованием аккаунтов, которым назначены минимально необходимые привилегии. | 2 |
| **13.2.3** | Убедитесь, что если для аутентификации в сервисе используются учётные данные, то используемые потребителем учётные данные не являются стандартными (например, root/root или admin/admin). | 2 |
| **13.2.4** | Убедитесь, что используется белый список (allowlist) для определения внешних ресурсов или систем, с которыми приложению разрешено взаимодействовать (например, для исходящих запросов, загрузки данных или доступа к файлам). Этот белый список может быть реализован на уровне приложения, веб-сервера, межсетевого экрана или комбинации различных уровней. | 2 |
| **13.2.5** | Убедитесь, что веб- или прикладной сервер настроен с белым списком ресурсов или систем, к которым сервер может отправлять запросы или из которых может загружать данные и файлы. | 2 |
| **13.2.6** | Убедитесь, что при подключении приложения к другим сервисам соблюдается задокументированная конфигурация для каждого соединения, включая максимальное количество параллельных соединений, поведение при достижении их максимума, таймауты и стратегии повторных попыток подключения. | 3 |

## V13.3 Управление секретами

Управление секретами — это важная задача конфигурации, необходимая для обеспечения защиты данных, используемых в приложении. Конкретные требования к криптографии изложены в главе «Криптография», а данный раздел сосредоточен на аспектах управления и обработки секретов.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **13.3.1** | Убедитесь, что для безопасного создания, хранения, контроля доступа и уничтожения секретов бэкенда используется решение для управления секретами, например, хранилище ключей (key vault). Секретами могут быть пароли, ключевой материал, интеграции с базами данных и сторонними системами, ключи и seed-значения для токенов с ограниченным временем действия, другие внутренние секреты и API-ключи. Секреты не должны включаться в исходный код приложения или артефакты сборки. Для приложений уровня L3 необходимо использовать аппаратное решение, например, аппаратный модуль безопасности (HSM). | 2 |
| **13.3.2** | Убедитесь, что доступ к секретным ресурсам осуществляется в соответствии с принципом минимально необходимых привилегий (least privilege). | 2 |
| **13.3.3** | Убедитесь, что все криптографические операции выполняются с использованием изолированного модуля безопасности (например, хранилища ключей или аппаратного модуля безопасности), чтобы надежно управлять ключевым материалом и защищать его от утечки за пределы модуля безопасности. | 3 |
| **13.3.4** | Убедитесь, что секреты настроены на срок действия и ротацию в соответствии с документацией приложения. | 3 |

## V13.4 Непреднамеренная утечка информации

Конфигурации в промышленной среде должны быть усилены, чтобы избежать раскрытия избыточных данных. Многие из подобных проблем редко оцениваются как значительные риски, но часто используются в связке с другими уязвимостями. Если таких проблем нет по умолчанию, это повышает уровень защиты приложения.

Например, скрытие версии серверных компонентов не отменяет необходимости обновлять все компоненты, а отключение отображения содержимого папок не исключает необходимости использовать механизмы авторизации или хранить файлы вне публичных каталогов, но всё это повышает уровень безопасности.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **13.4.1** | Убедитесь, что приложение развернуто либо без метаданных систем контроля версий (включая папки .git или .svn), либо так, чтобы эти папки были недоступны как извне, так и для самого приложения. | 1 |
| **13.4.2** | Убедитесь, что режимы отладки отключены для всех компонентов в промышленной среде, чтобы предотвратить раскрытие функций отладки и утечку информации. | 2 |
| **13.4.3** | Убедитесь, что веб-серверы не показывают клиентам списки содержимого каталогов, если это явно не предусмотрено. | 2 |
| **13.4.4** | Убедитесь, что метод HTTP TRACE не поддерживается в продуктовой среде, чтобы избежать потенциальной утечки информации. | 2 |
| **13.4.5** | Убедитесь, что документация (например, по внутренним API) и мониторинговые эндпоинты не доступны, если это явно не предусмотрено. | 2 |
| **13.4.6** | Убедитесь, что приложение не раскрывает подробную информацию о версиях компонентов бэкенда. | 3 |
| **13.4.7** | Убедитесь, что веб-слой настроен на обслуживание только файлов с определёнными расширениями, чтобы предотвратить непреднамеренную утечку информации, конфигураций и исходного кода. | 3 |

## Ссылки

Для дополнительной информации см. также:

* [OWASP Web Security Testing Guide: Configuration and Deployment Management Testing](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing)
