# V14 Защита информации

## Задачи контроля

Приложения не могут предусмотреть все сценарии использования и поведение пользователей, поэтому они должны реализовывать механизмы, ограничивающие несанкционированный доступ к конфиденциальным данным на устройствах клиентов.

В эту главу входят требования, связанные с определением перечня данных, подлежащих защите, методы их защиты, а также конкретные механизмы реализации и ошибки, которых следует избегать.

Ещё один важный аспект защиты данных — предотвращение массового извлечения, изменения или чрезмерного использования данных. Требования для каждой системы, вероятно, будут сильно различаться, поэтому определение «аномального» поведения должно основываться на модели угроз и бизнес-рисках. С точки зрения ASVS, обнаружение таких проблем рассматривается в главе «Журналирование событий безопасности и обработка ошибок», а установка ограничений — в главе «Валидация и бизнес-логика».

## V14.1 Документация по защите информации

Ключевым условием для защиты данных является классификация данных по уровню конфиденциальности. Данные следует классифицировать по нескольким уровням конфиденциальности, где для каждого уровня требуются разные меры защиты.

Существует множество законов и нормативных актов в области защиты персональных данных, которые определяют то, как приложения должны подходить к хранению, использованию и передаче конфиденциальных данных. Этот раздел не пытается дублировать такие законы и нормы, а сосредоточен на ключевых технических аспектах защиты чувствительных данных. При работе с данными следует учитывать требования местного законодательства и нормативных актов, а при необходимости консультироваться с профильным специалистом по защите данных или юристом.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **14.1.1** | Убедитесь, что все конфиденциальные данные, создаваемые и обрабатываемые приложением, идентифицированы и классифицированы по уровням защиты. Включая закодированные данные, которые легко декодируются, например, строки Base64 или незашифрованные данные в полезной нагрузке JWT. Уровни защиты должны учитывать требования по защите данных и конфиденциальности, которым должно соответствовать приложение. | 2 |
| **14.1.2** | Убедитесь, что для каждого уровня защиты конфиденциальных данных требования к защите задокументированы. Они должны включать (но не ограничиваться) требования по шифрованию, проверке целостности, срокам хранения, способам логирования данных, контролю доступа к чувствительным данным в логах, шифрованию на уровне базы данных, применению технологий повышения конфиденциальности, а также другим требованиям по конфиденциальности. | 2 |

## V14.2 Базовые меры по защите информации

Этот раздел содержит различные практические требования, связанные с защитой данных. Большинство из них направлены на непреднамеренную утечку данных, но также есть общее требование — реализовывать меры защиты в зависимости от необходимого уровня защиты для каждого типа данных.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **14.2.1** | Убедитесь, что конфиденциальные данные передаются на сервер только в теле HTTP-запроса или в заголовках. URL и строка запроса не должны содержать конфиденциальную информацию, такую как API-ключ или сессионный токен. | 1 |
| **14.2.2** | Убедитесь, что приложение предотвращает кэширование конфиденциальных данных в серверных компонентах, таких как балансировщики нагрузки и кэши приложений, либо гарантирует их надежное удаление после использования. | 2 |
| **14.2.3** | Убедитесь, что заранее определённые конфиденциальные данные не отправляются ненадёжным сторонам (например, системам трекинга пользователей), чтобы предотвратить нежелательный сбор данных вне контроля приложения. | 2 |
| **14.2.4** | Убедитесь, что для конфиденциальных данных реализованы меры по шифрованию, проверке целостности, срокам хранения, способам логирования, контролю доступа к данным в логах, а также применяются технологии повышения конфиденциальности в соответствии с документацией для соответствующего уровня защиты данных. | 2 |
| **14.2.5** | Убедитесь, что механизмы кэширования настроены так, чтобы кэшировать только ответы с ожидаемым типом содержимого для данного ресурса и не содержать конфиденциального динамического контента. При обращении к несуществующему файлу, веб-сервер должен возвращать ответ 404 или 302, а не подменять на другой существующий файл, что позволит предотвратить атаки типа Web Cache Deception. | 3 |
| **14.2.6** | Убедитесь, что приложение возвращает только минимально необходимый объем конфиденциальных данных для выполнения своей функциональности. Например, показывает только часть цифр номера кредитной карты, а не полный номер. Если требуется отображение полных данных, они должны быть замаскированы в пользовательском интерфейсе, пока пользователь специально не запросил их просмотр. | 3 |
| **14.2.7** | Убедитесь, что конфиденциальная информация подлежит классификации по срокам хранения, чтобы устаревшие или ненужные данные удалялись автоматически, по расписанию или по мере необходимости. | 3 |
| **14.2.8** | Убедитесь, что конфиденциальная информация удаляется из метаданных файлов, загружаемых пользователями, если пользователь явно не согласился на ее хранение. | 3 |

## V14.3 Защита данных на стороне клиента

В этом разделе содержатся требования, направленные на предотвращение утечки данных на стороне клиента или user agent приложения.

| # | Описание | Уровень |
| :---: | :--- | :---: |
| **14.3.1** | Убедитесь, что аутентифицированные данные очищаются из клиентского хранилища, например, из DOM браузера, после завершения работы клиента или сессии. Заголовок HTTP-ответа Clear-Site-Data может помочь в этом, но клиентская сторона также должна уметь очищать данные, если соединение с сервером недоступно при завершении сессии. | 1 |
| **14.3.2** | Убедитесь, что приложение устанавливает HTTP-заголовки, достаточные для предотвращения кэширования (например, Cache-Control: no-store), чтобы конфиденциальные данные не сохранялись в браузерах. | 2 |
| **14.3.3** | Убедитесь, что данные, хранящиеся в браузерном хранилище (например, localStorage, sessionStorage, IndexedDB или cookie), не содержат конфиденциальной информации, за исключением сессионных токенов. | 2 |

## Ссылки

Для дополнительной информации см. также:

* [Consider using the Security Headers website to check security and anti-caching header fields](https://securityheaders.com/)
* [Documentation about anti-caching headers by Mozilla](https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching)
* [OWASP Secure Headers project](https://owasp.org/www-project-secure-headers/)
* [OWASP Privacy Risks Project](https://owasp.org/www-project-top-10-privacy-risks/)
* [OWASP User Privacy Protection Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html)
* [Australian Privacy Principle 11 - Security of personal information](https://www.oaic.gov.au/privacy/australian-privacy-principles/australian-privacy-principles-guidelines/chapter-11-app-11-security-of-personal-information)
* [European Union General Data Protection Regulation (GDPR) overview](https://www.edps.europa.eu/data-protection_en)
* [European Union Data Protection Supervisor - Internet Privacy Engineering Network](https://www.edps.europa.eu/data-protection/ipen-internet-privacy-engineering-network_en)
* [Information on the "Clear-Site-Data" header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Clear-Site-Data)
* [White paper on Web Cache Deception](https://www.blackhat.com/docs/us-17/wednesday/us-17-Gil-Web-Cache-Deception-Attack-wp.pdf)
