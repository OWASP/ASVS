# Что такое ASVS?

Стандарт верификации требований к безопасности приложений (ASVS) определяет требования безопасности для веб-приложений и сервисов, представляя собой ценный ресурс для всех, кто стремится проектировать, разрабатывать и поддерживать безопасные приложения или оценивать их уровень защищённости.

В этой главе описываются ключевые аспекты применения ASVS, включая его область действия, структуру уровней, основанных на приоритетах, и основные сценарии использования стандарта.

## Область действия ASVS

Область действия ASVS определяется его названием: Приложение (Application), Безопасность (Security), Верификация (Verification) и Стандарт (Standard). Он устанавливает, какие требования включены в стандарт, а какие — исключены из него, с глобальной целью определения основополагающих принципов безопасности, которые должны быть достигнуты. Область действия также учитывает требования к документации, которые служат основой для требований к реализации.

Не существует такого понятия, как «область действия» для злоумышленника. Поэтому требования ASVS должны оцениваться в совокупности с рекомендациями по другим аспектам жизненного цикла приложения, включая процессы CI/CD, хостинг и операционную деятельность.

### Приложение

ASVS определяет «Приложение» как разрабатываемый программный продукт, в который должны быть интегрированы механизмы безопасности. ASVS не регламентирует процессы жизненного цикла разработки и не указывает на методы сборки приложения в CI/CD; Его задача — описать требуемый уровень защищённости, который должен быть достигнут в конечном продукте.

Компоненты для обработки HTTP-трафика (WAF, балансировщики нагрузки, прокси) могут считаться частью приложения в контексте безопасности, поскольку некоторые механизмы безопасности напрямую зависят от них или могут быть реализованы с их помощью. Это касается требований по кешированию, rate limiting, а также фильтрации входящих/исходящих подключений по источнику и получателю.

В свою очередь, ASVS не включает требования, относящиеся к приложению напрямую или находящиеся за пределами его зоны ответственности. Так, например, проблемы DNS обычно относятся в ведении отдельной команды или функции.

Аналогично, хотя в зону ответственности приложения входит обработка входящих данных и генерация исходящих данных, если внешний процесс взаимодействует с приложением или его данными, это считается выходящим за рамки ASVS. Например, резервное копирование приложения или его данных обычно выполняется внешними процессами и не контролируется самим приложением или его разработчиками.

### Безопасность

Каждое требование должно иметь очевидное влияние на безопасность. Отсутствие требования должно привести к снижению уровня защищённости приложения, а реализация требования должна либо уменьшить  вероятность возникнования риска безопасности, либо смягчить последствия.

Все прочие аспекты, такие как функциональные характеристики, стиль кода или требования политик, выходят за рамки стандарта.

### Верификация

Требование должно быть верифицируемым, а его проверка должна приводить к однозначному решению: «не выполнено» или «выполнено».

### Стандарт

ASVS представляет собой набор требований безопасности, которые необходимо реализовать для соответствия стандарту. Это означает, что требования ограничиваются определением целевого показателя безопасности, которого необходимо достичь. Прочая сопутствующая информация может быть надстроена на основе ASVS или связана с ним через сопоставления.

В частности, в рамках OWASP существует множество проектов, и ASVS намеренно избегает дублирования содержания других проектов. Например, у разработчиков может возникнуть вопрос: «как мне реализовать конкретное требование в моем технологическом стеке или окружении?» — на него должен отвечать проект Cheat Sheet Series. У тестировщиков может возникнуть вопрос: «как мне проверить это требование в данном окружении?» — на него должен отвечать проект Web Security Testing Guide.

Хотя ASVS предназначен не только для специалистов по безопасности, он ожидает, что читатель обладает техническими знаниями для понимания содержания или способен самостоятельно изучить конкретные концепции.

### Требование

Слово "Требование" специально используется в ASVS, поскольку оно обязательное условие, которое должно быть достигнуто для его выполнения. ASVS содержит только требования (обязательно к выполнению) и не содержит рекомендаций.

Другими словами, рекомендации, независимо от того, являются ли они лишь одним из многих возможных вариантов для решения проблем или вопросов стиля кода, не удовлетворяют определению требования.

Требования ASVS предназначены для целевых конкретных принципов безопасности без привязки к конкретной реализации или технологии, в то же время, являясь самоочевидными в отношении того, зачем они существуют. Это также означает, что требования не основаны на конкретном методе проверки или реализации.

### Документированные решения по безопасности

В области безопасности программного обеспечения заблаговременное планирование архитектуры безопасности и защитных механизмов позволяет добиться более последовательной и предсказуемой реализации в конечном продукте или функции.

Кроме того, некоторые требования сложны в реализации и зависят от специфики приложения. Например, система прав доступа, проверка вводимых данных и защита данных с разной степенью чувствительности.

Чтобы учесть это, вместо общих формулировок, таких как «все данные должны быть зашифрованы», или попыток охватить каждый возможный случай в требовании, были включены требования к документации. Они предписывают, чтобы подход и конфигурация, выбранные разработчиком приложения для механизмов управления, были задокументированы. Это позволяет провести оценку целесообразности подхода, а затем сравнить фактическую реализацию с документацией, чтобы оценить, соответствует ли реализация ожиданиям.

Задача этих требований — фиксировать решения, которые организация-разработчик приняла в отношении того, каким образом реализовать определенные требования безопасности.

Требования к документации всегда размещаются в первом разделе главы (хотя присутствуют не в каждой из них), и каждое из них всегда связано с соответствующим требованием к реализации, в рамках которого документированные решения должны быть воплощены на практике. Ключевая идея заключается в том, что проверка наличия документации и проверка фактической реализации — это два самостоятельных вида деятельности.

Существует две ключевые причины для включения этих требований. Первая причина заключается в том, что требование информационной безопасности часто предполагает принудительное применение правил, например, какие типы файлов разрешены для загрузки, какие бизнес-контроли должны быть реализованы, какие символы допустимы для конкретного поля. Эти правила уникальны для каждого приложения и поэтому ASVS не может предписать, какими они должны быть. Ни чек-лист, ни развернутое руководство в данном случае не будут полезны. Также, если эти решения не документированы, то невозможно проверить реализацию на соответствие требованиям.

Вторая причина заключается в необходимости обеспечить гибкость для разработчиков приложения в выборе подходов к решению отдельных вопросов безопасности. Например, в прошлых версиях ASVS ограничения времени жизни сессии были строго фиксированы. На практике многие приложения, особенно ориентированные на прямое взаимодействие с потребителями, применяют более мягкие правила, отдавая предпочтение иным компенсирующим механизмам защиты. Таким образом, настоящие требования к документации прямо разрешают такую гибкость.

Очевидно, что предполагается, что подобные решения будут приниматься и документироваться не отдельными разработчиками, а организацией в целом. На организацию возлагается ответственность за принятие данных решений, доведение их до сведения разработчиков и обеспечение их соблюдения.

Предоставление разработчикам спецификаций и проектов новых функций является стандартной практикой в процессе разработки программного обеспечения. Аналогичным образом, от разработчиков ожидается использование общепринятых компонентов и механизмов пользовательского интерфейса, а не принятие самостоятельных решений каждый раз. Таким образом, распространение данного подхода на безопасность не должно восприниматься как нечто удивительное или спорное.

Кроме того, существует гибкость в выборе способа достижения данной цели. Решения в области безопасности могут быть документированы в виде явного документа, с которым разработчики обязаны знакомиться. Альтернативно, эти решения могут быть документированы и реализованы в рамках общей библиотеки, которую все разработчики обязаны использовать. Результат достигается в обоих случаях. 

## Уровни соответствия ASVS

Стандарт верификации требований к безопасности приложений определяет три уровня соответствия, каждый из которых усиливает требования предыдущего. Рекомендуемый подход для организаций —  начинать с первого уровня для митигации наиболее критичных рисков безопасности с последующим переходом на более высокие уровни в зависимости от конкретных потребностей приложения и организации.
В документации и требованиях используются сокращения L1, L2 и L3.

Каждый уровень соответствия определяет требования безопасности, которые необходимо выполнить для его достижения. Требования же вышестоящих уровней носят рекомендательный характер. 

Во избежание дублирования требований или наличия требований, теряющих актуальность на более высоких уровнях, некоторые из них применяются к конкретному уровню, но предусматривают более строгие условия для последующих уровней.

### Оценка уровней соответствия

Уровни соответствия определяются путём приоритизационной оценки каждого требования, основанной на опыте внедрения и тестирования требований безопасности. Основное внимание уделяется сопоставлению снижения рисков с усилиями по реализации требования. Другим ключевым фактором является сохранение низкого порога вхождения.

Оценка снижения риска рассматривает, насколько требование уменьшает уровень риска безопасности в приложении. При этом принимаются во внимание классические факторы воздействия на Конфиденциальность, Целостность и Доступность, а также то, является ли данное требование основным рубежом обороны или же оно рассматривается как элемент эшелонированной защиты.

В результате тщательных обсуждений как самих критериев, так и решений по отнесению их к уровням соответствия, была выработана классификация, которая должна оставаться справедливой для подавляющего большинства случаев, при этом допуская, что она не может быть универсальной для всех ситуаций. Это означает, что в отдельных случаях организации могут пожелать отдать приоритет требованиям более высокого уровня ранее, основываясь на собственной оценке рисков.

Требования на каждом уровне можно охарактеризовать следующим образом:

### Уровень 1

Данный уровень содержит минимальный набор требований для обеспечения безопасности приложения, и представляет собой критически важную отправную точку. На этот уровень приходится около 20% требований ASVS. Цель этого уровня — иметь как можно меньше требований для снижения порога вхождения.

Эти требования, как правило, являются критически важными или базовыми, представляя собой первый рубеж защиты от распространённых атак, для эксплуатации которых не требуется наличия других уязвимостей или предварительных условий.

Помимо требований первого рубежа защиты, некоторые требования имеют меньшее значение на более высоких уровнях, например, требования, связанные с паролями. Они более важны для первого уровня, поскольку начиная с более высоких уровней становятся актуальными требования многофакторной аутентификации.

Первый уровень не обязательно поддаётся полноценному тестированию на проникновение внешним специалистом без доступа к внутренней документации или коду (например, при тестировании по методу «чёрного ящика»), хотя меньшее количество требований должно упростить процесс верификации.

### Уровень 2

Большинству приложений следует стремиться к достижению данного уровня безопасности. На Уровень 2 (L2) приходится около 50% требований ASVS, что означает, что приложению необходимо реализовать порядка 70% требований ASVS (все требования уровней L1 и L2) для соответствия этому уровню.

Эти требования, как правило, связаны либо с менее распространёнными атаками, либо с более сложными механизмами защиты от распространённых атак. Они могут по-прежнему представлять собой первый рубеж обороны, либо же для успешной атаки могут требоваться определённые предварительные условия.

### Уровень 3

Данный уровень должен быть целью для приложений, стремящихся продемонстрировать наивысший уровень защищённости, и содержит оставшиеся ~30% требований для полного соответствия.

Требования в данном разделе, как правило, представляют собой либо механизмы глубокой эшелонированной обороны (defense-in-depth), либо иные полезные, но сложные в реализации средства контроля.

### Какого уровня следует достичь

Уровни, основанные на приоритетах, призваны отражать степень зрелости системы безопасности организации и приложения. Вместо того, чтобы предписывать, какого уровня должно достигать приложение, ASVS предлагает организации проанализировать свои риски и самостоятельно определить целевой уровень, исходя из критичности приложения и, конечно же, ожиданий его пользователей.

Например, стартап на ранней стадии, собирающий лишь ограниченный объём конфиденциальных данных, может принять решение сфокусироваться на первом уровне на начальном этапе. В то же время банк не сможет объяснить клиентам выбор уровня ниже, чем Уровень 3, для своего онлайн банковского приложения.

## Как применять этот стандарт

### Структура ASVS

ASVS состоит в общей сложности из приблизительно 350 требований, которые разделены на 17 глав. Каждая глава, в свою очередь, делится на разделы.

Цель такого деления на главы и разделы — упростить выбор или исключение соответствующих глав и разделов в зависимости от релевантности для конкретного приложения. Например, требования главы V3, касающиеся веб-интерфейсов, не будут актуальны в случае API для межмашинного взаимодействия. Если в системе не используется OAuth или WebRTC, то соответствующие главы также могут быть проигнорированы.

### Стратегия выпусков

Выпуски ASVS следуют схеме "Major.Minor.Patch", где номера версий указывают на характер изменений в выпуске. При мажорном выпуске изменяется первое число, при минорном — второе, а при патче — третье.

* Мажорный выпуск (Major release) — Полная реорганизация. Могут быть изменены практически все элементы, включая нумерацию требований. Для подтверждения соответствия потребуется проведение повторной оценки (например, переход с версии 4.0.3 на 5.0.0).

* Минорный выпуск (Minor release) — Требования могут добавляться или удаляться, но общая структура нумерации остаётся прежней. Для подтверждения соответствия потребуется повторная оценка, но она должна быть проще (например, переход с версии 5.0.0 на 5.1.0).

* Выпуск патча (Patch release) — Требования могут быть удалены (например, если они являются дубликатами или устарели) или смягчены. Приложение, соответствовавшее предыдущему выпуску, будет соответствовать и патч-выпуску (например, переход с версии 5.0.0 на 5.0.1).

Вышеизложенное относится только к самим требованиям. Изменения в пояснительных текстах и приложениях не являются критическими.

### Гибкость использования ASVS

Ряд рассмотренных принципов (например, требования к документации и система уровней) предоставляет возможность применять ASVS гибко, с учётом специфики организации.

Кроме того, организациям настоятельно рекомендуется создавать специализированные форки стандарта, адаптированные для организации или домена, которые корректируют требования исходя из специфических характеристик и уровней риска их приложений. Однако важно сохранять прослеживаемость (traceability), чтобы соответствие требованию, например, 4.1.1, означало одно и то же во всех версиях.

В идеале, каждой организации следует создавать собственную адаптированную версию ASVS, исключая нерелевантные разделы (например, GraphQL, WebSockets, SOAP, если они не используются). Версия ASVS, адаптированная под организацию, или дополнение к ней также является хорошим способом предоставить специфичные для организации руководства по реализации, уточняя библиотеки или ресурсы, которые следует использовать для выполнения требований.

### Как ссылаться на требования ASVS

Каждое требование имеет идентификатор в формате `<глава>.<раздел>.<требование>` где каждый элемент является числом, например: `1.11.3`.

* Значение `<глава>` соответствует главе, в которой находится это требование, например: все требования `1.#.#` находятся в главе `Архитектура кодировки и обработки`.
* Значение `<раздел>` соответствует разделу в этой главе, где находится это требование, например: все требования `1.2.#` находятся в разделе `Предотвращение инъекций` главы `Архитектура кодировки и обработки`.
* Значение `<требование>` указывает на конкретное требование в главе и разделе, например: `1.2.5`, которым в версии 5.0.0 этого стандарта является:

> Убедитесь, что приложение защищено от внедрения команд ОС и что вызовы операционной системы используют параметризованные запросы к ОС или используют контекстное кодирование вывода командной строки.

Идентификаторы требований могут меняться от версии к версии, поэтому желательно, чтобы другие документы, отчеты или инструменты использовали формат: `v<версия>-<глава>.<раздел>.<требование>`, где: 'версия' это метка версии ASVS. Например: `v5.0.0-1.2.5` будет означать 5-е требование в разделе 'Предотвращение инъекций' главы 'Архитектура кодировки и обработки' в версии 5.0.0. (Резюмируя, `v<версия>-<идентификатор_требования>`.)

Примечание. Буква `v`, предшествующая версии, должна быть в нижнем регистре.

Считается, что если идентификаторы указаны без элемента `v<версия>`, то они относятся к последней версии стандарта. По мере развития и изменения стандарта это станет проблематичным, поэтому авторы и разработчики должны включать элемент версии.

Списки требований ASVS доступны в форматах CSV, JSON и других, которые могут оказаться полезными для справки или использования в программах.

### Создание ответвлений ASVS

Организации могут извлечь пользу из применения ASVS, выбрав один из трёх уровней или создав предметно-ориентированное ответвление (fork), которое адаптирует требования в соответствии с уровнем риска каждого приложения. Такой подход настоятельно рекомендуется при условии сохранения прослеживаемости (traceability), чтобы соответствие требованию, например, 4.1.1, означало одно и то же во всех версиях.

В идеале каждой организации следует создать собственную адаптированную версию ASVS, исключая нерелевантные разделы (например, GraphQL, WebSockets, SOAP, если они не используются). Создание ответвления следует начинать с использования ASVS Уровня 1 в качестве базового, с последующим переходом на Уровни 2 или 3 в зависимости от рисков, присущих приложению.

## Сценарии применения ASVS

ASVS может быть использован для оценки безопасности приложения, и этот вопрос более глубоко исследуется в следующей главе. Тем не менее, был выявлен ряд других потенциальных вариантов использования ASVS (или его модифицированной версии).

### Как подробное руководство по архитектуре безопасности

Одним из наиболее распространенных вариантов использования Стандарта верификации требований к безопасности приложений является его применение в качестве ресурса для архитекторов безопасности. В настоящее время существует ограниченное количество материалов о том, как построить безопасную архитектуру современного приложения. ASVS может быть использован для восполнения этих пробелов, позволяя архитекторам безопасности выбирать более эффективные меры для решения распространенных проблем, таких как шаблоны защиты данных и стратегии валидации входных данных.Требования, связанные с архитектурой и документацией, будут особенно полезны для этой цели.

### Как специализированное руководство по безопасной разработке

ASVS может быть использован как основа для подготовки руководства по безопасной разработке в процессе разработки приложения, помогая разработчикам не упускать из виду аспекты безопасности при создании программного обеспечения. Хотя ASVS может служить основой, организациям следует подготовить свои собственные конкретные руководства, которые являются четкими и унифицированными, и в идеале их следует составлять на основе рекомендаций инженеров или архитекторов безопасности. В развитие этого подхода организациям настоятельно рекомендуется, по возможности, подготовить одобренные механизмы безопасности и библиотеки, на которые можно ссылаться в руководствах и которые разработчики могут использовать.

### Как руководство по автоматизированному модульному и интеграционному тестированию

ASVS создавался таким, чтобы его можно было легко протестировать. Некоторые проверки носят технический характер, в то время как другие требования могут потребовать анализа документации или архитектуры. Благодаря модульным и интеграционным тестам, которые проверяют характерные случаи фаззинга и недокументированного использования, связанных с требованиями, поддающимися технической верификации, можно упростить проверку корректности работы этих контролей при каждой сборке. Например, для набора тестов для контроллера входа в систему можно разработать дополнительные тесты, проверяющие атрибут username на совпадение с наиболее распространенными именами пользователей по умолчанию, перебор учетных записей, LDAP- и SQL-инъекции, а также XSS. Аналогично, проверка атрибута password должна включать перебор самых распространенных паролей, оценку длины пароля, вставку нулевого байта, удаление этого атрибута, XSS и многое другое.

### Как курс по безопасной разработке

ASVS также можно использовать для определения характеристик защищенного программного обеспечения. Многие "курсы безопасной разработки" — это просто курсы по этичному хакингу с легким намеком на советы по безопасной разработке. Не факт, что это как-то поможет разработчикам писать более безопасный код. Вместо этого курсы по безопасной разработке могут использовать ASVS с упором на упреждающие меры, описанные в ASVS, а не на Top 10 того, что делать не надо. Структура ASVS также предоставляет логичную основу для последовательного изучения различных тем, связанных с защитой приложения.

### Как руководство по приобретению безопасного программного обеспечения

ASVS — это отличное руководство по приобретению безопасного программного обеспечения или заказных услуг по его разработке. Заказчику достаточно указать требование, что программное обеспечение, которое он хочет приобрести, должно быть разработано на уровне ASVS LX, и потребовать, чтобы Исполнитель доказал, что оно ему соответствует. 

## Применение ASVS на практике

Разные угрозы имеют разную мотивацию. В отдельных отраслях имеются уникальные информационные и технологические ресурсы или отраслевые регуляторные требования.

Организациям настоятельно рекомендуется внимательно изучить риски, присущие характеру их бизнеса, и на их основе и с учетом бизнес-требований определить соответствующий уровень ASVS.
