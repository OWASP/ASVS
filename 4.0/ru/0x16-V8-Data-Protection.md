# V8 Защита информации

## Задачи контроля

Есть три ключевых элемента надежной защиты данных: конфиденциальность, целостность и доступность. В данном стандарте предполагается, что защита данных обеспечивается в доверенной системе, например, на сервере, укрепленном достаточным набором мер защиты.

Приложение должно считать, что все пользовательские устройства так или иначе скомпрометированы. Если приложение передает или хранит конфиденциальную информацию на небезопасных устройствах, таких как компьютеры, телефоны и планшеты, приложение несет ответственность за то, чтобы информация, хранящаяся на этих устройствах, была зашифрована и не могла быть легко получена незаконным путем, изменена или разглашена.

Убедитесь, что исследуемое приложение удовлетворяет следующим концептуальным требованиям к защите информации:

* Конфиденциальность: информация должна быть защищена от несанкционированного просмотра или разглашения как при передаче, так и при хранении.
* Целостность: информация должна быть защищена от несанкционированной регистрации, изменения или удаления неуполномоченными лицами.
* Доступность: информация должна быть доступна авторизованным пользователям по мере необходимости.

## V8.1 Базовые меры

| № | Описание | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **8.1.1** | Убедитесь, что приложение защищает конфиденциальные данные от кэширования в серверных компонентах, таких как балансировщики нагрузки и кэши приложений. | | ✓ | ✓ | 524 |
| **8.1.2** | Убедитесь, что все кэшированные или временные копии конфиденциальных данных, хранящиеся на сервере, защищены от несанкционированного доступа или очищены/аннулированы после того, как авторизованный пользователь получит доступ к конфиденциальным данным. | | ✓ | ✓ | 524 |
| **8.1.3** | Убедитесь, что приложение минимизирует количество параметров в запросе, таких как скрытые поля, переменные AJAX, файлы cookie и значения заголовков. | | ✓ | ✓ | 233 |
| **8.1.4** | Убедитесь, что приложение может обнаруживать и предупреждать об аномальном количестве запросов, например, по данному IP-адресу или пользователю, по общему количеству запросов в час или в день или по другому признаку в контексте приложения. | | ✓ | ✓ | 770 |
| **8.1.5** | Убедитесь, что регулярно создаются резервные копии всех значимых данных и проводится тестирование по восстановлению этих данных. | | | ✓ | 19 |
| **8.1.6** | Убедитесь, что резервные копии хранятся в безопасном месте, чтобы предотвратить кражу или повреждение данных. | | | ✓ | 19 |

## V8.2 Защита данных на стороне клиента

| № | Описание | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **8.2.1** | Убедитесь, что приложение устанавливает соответствующие заголовки для предотвращения кэширования, чтобы конфиденциальные данные не кэшировались в современных браузерах. | ✓ | ✓ | ✓ | 525 |
| **8.2.2** | Убедитесь, что данные, хранящиеся в хранилище браузера (например, localStorage, sessionStorage, IndexedDB или файлы cookie), не содержат конфиденциальной информации. | ✓ | ✓ | ✓ | 922 |
| **8.2.3** | Убедитесь, что данные, полученные после аутентификации клиента, удаляются из хранилища, например из DOM браузера, после завершения работы клиента или сессии. | ✓ | ✓ | ✓ | 922 |

## V8.3 Персональные данные

Этот раздел поможет защитить конфиденциальную информацию от её несанкционированной регистрации, чтения, изменения или удаления, особенно большими партиями.

Соблюдение требований данного раздела также подразумевает удовлетворение требованиям раздела V4 Контроля доступа, особенно в части V4.2. Например, для защиты от несанкционированного изменения или разглашения персональных данных требуется соответствие требованию V4.2.1. Для полного охвата необходимо соответствие и этому разделу и V4.

Примечание: Законы и регламенты о персональных данных, такие как Федеральный закон РФ "О персональных данных" 152-ФЗ или GDPR, напрямую влияют на то, как приложения должны подходить к хранению, использованию и передаче персональных данных. Наказания варьируются от суровых штрафов до простых советов. Ознакомьтесь с местными законами и нормативными актами, а также при необходимости проконсультируйтесь с квалифицированным специалистом по вопросам персональных данных или юристом.

| № | Описание | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **8.3.1** | Убедитесь, что в параметрах строки HTTP-запроса не содержится конфиденциальных данных. Вместо этого они отправляются на сервер в теле или заголовках HTTP-сообщения. | ✓ | ✓ | ✓ | 319 |
| **8.3.2** | Убедитесь, что у пользователей есть способ удалить или экспортировать свои данные по запросу. | ✓ | ✓ | ✓ | 212 |
| **8.3.3** | Убедитесь, что пользователям предоставлены четкие формулировки в отношении сбора и использования их персональных данных, и что они дали добровольное согласие на обработку этих данных, прежде чем эти данные будут каким-либо образом использованы. | ✓ | ✓ | ✓ | 285 |
| **8.3.4** | Убедитесь, что определены все конфиденциальные данные, создающиеся и обрабатываемые приложением, и что на эти данные распространяется действие политики обращения с конфиденциальными данными. ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 200 |
| **8.3.5** | Убедитесь, что доступ к конфиденциальным данным подвергается аудиту (без регистрации в журнале самих этих данных), если данные собираются в соответствии с соответствующими законами о защите данных или если вести журнал доступа требуется по стандарту организации (отрасли). | | ✓ | ✓ | 532 |
| **8.3.6** | Убедитесь, что для предотвращения атак с дампом памяти, конфиденциальная информация, содержащаяся в памяти, после того как она больше не нужна, перезаписывается (нулями или случайными данными). | | ✓ | ✓ | 226 |
| **8.3.7** | Убедитесь, что конфиденциальная информация, которую необходимо зашифровать, зашифрована с использованием утвержденных алгоритмов, обеспечивающих как конфиденциальность, так и целостность. ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 327 |
| **8.3.8** | Убедитесь, что конфиденциальная информация подлежит классификации по сроку хранения, чтобы ненужные или устаревшие данные удалялись автоматически, по расписанию или по мере необходимости. | | ✓ | ✓ | 285 |

При рассмотрении вопроса о защите данных основное внимание следует уделять их массовому извлечению, изменению или чрезмерному использованию. Например, многие социальные сети позволяют пользователям добавлять не более 100 новых «друзей» в день. Банковская система может заблокировать переводы во внешние учреждения, если их частота более пяти в час, и сумма более $1000. Требования к каждой системе могут быть разными, поэтому, отвечая на вопрос "Что считать «аномалией»?", необходимо учитывать модель угроз и бизнес-риски. Важными критериями являются способность обнаруживать, сдерживать, и, что ещё важнее, блокировать такие аномальные массовые операции.

## Ссылки

Для дополнительной информации см. также:

* [Сайт Security Headers](https://securityheaders.io)
* [Проект OWASP Secure Headers](https://owasp.org/www-project-secure-headers/)
* [Проект OWASP Privacy Risks](https://owasp.org/www-project-top-10-privacy-risks/)
* [OWASP User Privacy Protection Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html)
* [Обзор European Union General Data Protection Regulation (GDPR)](https://edps.europa.eu/data-protection_en)
* [European Union Data Protection Supervisor - Internet Privacy Engineering Network](https://edps.europa.eu/data-protection/ipen-internet-privacy-engineering-network_en)
