# Использование ASVS

У ASVS две основные цели:

* помочь организациям разрабатывать и поддерживать безопасные приложения.
* согласовать между собой требования потребителей и предложения разработчиков инструментов и поставщиков услуг кибербезопасности.

## Уровни соответствия ASVS

Стандарт исследования безопасности приложений определяет три уровня соответствия, каждый из которых усиливает требования предыдущего.

* Первый уровень ASVS соответствует низкому уровню безопасности и полностью поддается тестированию на проникновение.
* Второй уровень ASVS предназначен для приложений, содержащих конфиденциальную информацию, и являются рекомендуемым для большинства приложений.
* Третий уровень ASVS предназначен для наиболее критичных приложений, выполняющих финансовые транзакции, содержащих чувствительные медицинские данные и других приложений, требующих высочайшего уровня доверия.

Каждый уровень ASVS содержит перечень требований безопасности. Каждое из этих требований также может быть сопоставлено с функциями и возможностями, специфичными для безопасности, которые должны быть встроены разработчиками в программное обеспечение.

![Уровни ASVS](https://raw.githubusercontent.com/OWASP/ASVS/master/4.0/images/asvs_40_levels.png "Уровни ASVS")

Рис. 1 — Уровни OWASP ASVS версии 4.0

Первый уровень — единственный, который можно полностью протестировать на проникновение вручную. Все остальные требуют доступа к документации, исходному коду, конфигурации и к специалистам, участвующим в процессе разработки. Однако, даже если L1 и допускает тестирование по принципу «черного ящика» (без документации и исходных кодов), он не является достаточным для достижения соответствия, и на этом не следует останавливаться. У злоумышленников огромный запас времени, а большинство тестов на проникновение проводятся в течение пары недель. Защитникам необходимо встраивать меры безопасности, защищать, находить и устранять все уязвимости, а также обнаруживать злоумышленников и реагировать на них в разумные сроки. У злоумышленники по сути бесконечное время, и для успеха им требуется только одно слабое звено в защите, одна уязвимость или недостаток обнаружения. Тестирование методом «черного ящика», часто выполняемое в конце разработки, наспех или не выполняемое вовсе, совершенно не справляется с этой асимметрией.

За последние 30 с лишним лет тестирование методом "черного ящика" снова и снова доказывало, что оно пропускает критические проблемы безопасности, которые непосредственно приводили ко все более массовым нарушениям. Мы настоятельно рекомендуем использовать широкий спектр средств обеспечения безопасности и исследований, включая замену тестов на проникновение на основе исходного кода (гибридными) тестами на проникновение на уровне 1 с полным доступом к разработчикам и документации на протяжении всего процесса разработки. Финансовые регуляторы не начинают внешний финансовый аудит без доступа к бухгалтерским книгам, выборкам транзакций и к людям, их выполняющим. Государства и профессиональные сообщества должны требовать такого же уровня прозрачности и в области разработки программного обеспечения.

Мы настоятельно рекомендуем использовать инструменты безопасности в самом процессе разработки. Инструменты DAST и SAST могут быть встроены в конвейер сборки, чтобы налету обнаруживать проблемы безопасности, которых не должно быть.

Автоматизированные инструменты и online-сканирование не в состоянии выполнить более половины требований ASVS без помощи человека. Если требуется комплексная автоматизация тестирования для каждой сборки, то используется комбинация модульных и интеграционных тестов, а также online-сканирование, инициированное сборкой. Тестирование недостатков бизнес-логики и контроля доступа возможно только с помощью человека. Оно должно быть встроено в модульные и интеграционные тесты.

## Как применять этот стандарт

Один из лучших способов применения ASVS — использовать его в качестве основы для создания чек-листа безопасной разработки для вашего приложения, платформы или организации. Адаптация ASV к вашим сценариям использования позволит уделять больше внимания требованиям безопасности, которые наиболее важны для ваших проектов и сред.

### Уровень 1 — Первые шаги, автоматизированный или поверхностный

Приложение достигает первого уровня ASVS, если оно адекватно защищает от уязвимостей безопасности, которые легко обнаружить, которые включены в список OWASP Top 10 и другие подобные списки.

Первый уровень — это абсолютный минимум, к которому должны стремиться все приложения без исключений. Он также полезен в качестве первого шага в многоэтапной работе или когда приложения не хранят и не обрабатывают конфиденциальную информацию, и, следовательно, не нуждаются в более строгих мерах безопасности второго или третьего уровня. Элементы управления уровня 1 могут быть проверены либо автоматически с помощью инструментов, либо просто вручную без доступа к исходному коду. Мы считаем уровень 1 минимально необходимым для всех приложений.

Чаще всего, угрозы для приложения исходят от нарушителей, которые пользуются простыми, не требующими больших усилий методами для выявления легко обнаруживаемых и легко эксплуатируемых уязвимостей. Совсем другое дело, когда приложение атакует заинтересованный и опытный злоумышленник. Если данные, обрабатываемые вашим приложением, имеют большую ценность, вы вряд ли захотите останавливаться на первом уровне.

### Уровень 2 — Большинство приложений

Приложение достигает второго уровня ASVS, если оно адекватно защищает от большинства рисков, связанных с современным программным обеспечением.

Уровень 2 гарантирует наличие и эффективность применения мер безопасности в приложении. Уровень 2 обычно подходит для приложений, которые обрабатывают важные бизнес-транзакции, в том числе те, которые обрабатывают данные о здоровье, решают критически важные для бизнеса задачи, или в отраслях, где целостность является значимым аспектом для защиты бизнеса, например, в игровой индустрии, чтобы помешать читерам и взлому игр.

Угрозы для приложений уровня 2 обычно представляют собой квалифицированных и мотивированных нарушителей, сосредоточенных на конкретных целях, использующих инструменты и методы, которые хорошо отработаны и эффективны при обнаружении и использовании слабых мест в приложениях.

### Уровень 3 - Высокая стоимость, надежность или безопасность

Третий уровень ASVS — самый высокий в рамках ASVS. Этот уровень обычно необходим для приложений, требующих серьезных гарантий безопасности, например, в таких областях, как оборона, здравоохранение, критическая инфраструктура и т.д.

Организациям может потребоваться ASVS уровня 3 для приложений, выполняющих критически важные функции, где сбой может существенно повлиять на непрерывность работы и даже на ее сохранение как организации. Ниже приводится примерное руководство по применению ASVS уровня 3. Приложение достигает третьего (продвинутого) уровня ASVS, если оно адекватно защищено от серьезных уязвимостей безопасности приложений, а также соответствует концептуальной архитектуре безопасности приложений.

Приложение на третьем уровне ASVS требует более глубокого анализа архитектуры, разработки и тестирования, чем на других уровнях. Защищенное приложение обычно имеет модульную структуру (для обеспечения отказоустойчивости, масштабируемости и, прежде всего, уровней безопасности), при этом каждый модуль (отделенный от других сетевым подключением и / или физически) выполняет свои собственные задачи по обеспечению безопасности (эшелонированная защита), которые должны быть должным образом задокументированы. Эти задачи включают меры обеспечения конфиденциальности (шифрование), целостности (например, транзакционной, форматно-логический контроль), доступности (например корректная работа под нагрузкой), аутентификация (в том числе между системами), авторизация и аудит (ведение журнала событий безопасности).

## Применение ASVS на практике

Разные угрозы имеют разную мотивацию. В отдельных отраслях имеются уникальные информационные и технологические ресурсы или отраслевые регуляторные требования.

Организациям настоятельно рекомендуется внимательно изучить риски, присущие характеру их бизнеса, и на их основе и с учетом бизнес-требований определить соответствующий уровень ASVS.

## Как ссылаться на требования ASVS

Каждое требование имеет идентификатор в формате `<глава>.<раздел>.<требование>` где каждый элемент является числом, например: `1.11.3`.

* Значение `<глава>` соответствует главе, в которой находится это требование, например: все требования `1.#.#` находятся в главе `Архитектура`.
* Значение `<раздел>` соответствует разделу в этой главе, где находится это требование, например: все требования `1.11.#` находятся в разделе `Бизнес-логика` главы `Архитектура`.
* Значение `<требование>` указывает на конкретное требование в главе и разделе, например: `1.11.3`, которым в версии 4.0.3 этого стандарта является:

> Убедитесь, что все критичные потоки бизнес-логики, включая аутентификацию, управление сессиями и контроль доступа, являются безопасными с точки зрения их параллельного выполнения и устойчивыми к условиям гонки, вызванной разницей между состояниями приложения в момент проверки и в момент использования (TOCTOU).

Идентификаторы требований могут меняться от версии к версии, поэтому желательно, чтобы другие документы, отчеты или инструменты использовали формат: `v<версия>-<глава>.<раздел>.<требование>`, где: 'версия' это метка версии ASVS. Например: `v4.0.3-1.11.3` будет означать 3-е требование в разделе 'Бизнес-логика' главы 'Архитектура' в версии 4.0.3. (Резюмируя, `v<версия>-<идентификатор_требования>`.)

Примечание. Буква `v`, предшествующая версии, должна быть в нижнем регистре.

Считается, что если идентификаторы указаны без элемента `v<версия>`, то они относятся к последней версии стандарта. Очевидно, что по мере развития и изменения стандарта это станет проблематичным, поэтому авторы и разработчики должны включать элемент версии.

Списки требований ASVS доступны в форматах CSV, JSON и других, которые могут оказаться полезными для справки или использования в программах.
