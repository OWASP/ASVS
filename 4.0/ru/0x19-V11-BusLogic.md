# V11 Бизнес-логика

Убедитесь, что исследуемое приложение удовлетворяет следующим концептуальным требованиям:

* Поток бизнес-логики является последовательным, обрабатывается по порядку, и его нельзя обойти.
* Бизнес-логика включает ограничения для обнаружения и предотвращения автоматизированных атак, таких как продолжающиеся денежные переводы  незначительных сумм или добавление миллиона друзей по одному за раз и т.д.
* Ключевые потоки бизнес-логики учитывают возможность злоупотреблений и злонамеренных действий и имеют защиту от несанкционированного доступа, разглашения и искажения информации и атак с повышением привилегий.

## V11.1 Безопасность бизнес-логики

Безопасность бизнес-логики настолько индивидуальна для каждого приложения, что не поможет ни один чек-лист. Она должна проектироваться для защиты от вероятных внешних угроз, но ее нельзя "включить" на брандмауэре web-приложений (WAF) или, организовав защищенный канал связи. Мы рекомендуем использовать моделирование угроз во время спринтов по дизайну, например, с помощью OWASP Cornucopia или аналогичных инструментов.

| № | Описание | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **11.1.1** | Убедитесь, что приложение обрабатывает потоки бизнес-логики для того же пользователя, последовательно, и без пропуска шагов.| ✓ | ✓ | ✓ | [841](https://cwe.mitre.org/data/definitions/841.html) |
| **11.1.2** | Убедитесь, что приложение обрабатывает потоки бизнес-логики только в том случае, если все шаги обрабатываются в реалистичном для человека масштабе времени, т.е. транзакции не делаются слишком быстро.| ✓ | ✓ | ✓ | [799](https://cwe.mitre.org/data/definitions/799.html) |
| **11.1.3** | Убедитесь, что приложение ограничивает определенные операции бизнес-процессов или транзакции по частоте и потребляемым ресурсам, и эти ограничения корректно применяются для каждого пользователя. | ✓ | ✓ | ✓ | [770](https://cwe.mitre.org/data/definitions/770.html) |
| **11.1.4** | Убедитесь, что в приложении предусмотрены меры защиты от автоматизации аномальных по размеру запросов на массовую выгрузку данных, запросов бизнес-логики, загрузки файлов или атак типа "отказ в обслуживании". | ✓ | ✓ | ✓ | [770](https://cwe.mitre.org/data/definitions/770.html) |
| **11.1.5** | Убедитесь, что приложение имеет ограничения бизнес-логики или меры защиты от наиболее вероятных бизнес-рисков или угроз, выявленных с помощью моделирования угроз или аналогичных методологий. | ✓ | ✓ | ✓ | [841](https://cwe.mitre.org/data/definitions/841.html) |
| **11.1.6** | Убедитесь, что приложение не подверженно атакам типа "момент проверки до момента использования" (TOCTOU) или других условий гонки для конфиденциальных операций. | | ✓ | ✓ | [367](https://cwe.mitre.org/data/definitions/367.html) |
| **11.1.7** | Убедитесь, что приложение отслеживает необычные события или действия с точки зрения бизнес-логики. Например, попытки выполнить действия не по порядку или действия, которые обычный пользователь никогда бы не совершил. ([C9](https://owasp.org/www-project-proactive-controls/v3/en/c9-security-logging)) | | ✓ | ✓ | [754](https://cwe.mitre.org/data/definitions/754.html) |
| **11.1.8** | Убедитесь, что приложение имеет настраиваемое оповещение при обнаружении автоматизированных атак или необычных действий. | | ✓ | ✓ | [390](https://cwe.mitre.org/data/definitions/390.html) |

## Источники

Для дополнительной информации см. также:

* [OWASP Web Security Testing Guide 4.1: Business Logic Testing](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/10-Business_Logic_Testing/README.html)
* "Анти-автоматизация" атак может быть достигнута многими способами, включая [OWASP AppSensor](https://github.com/jtmelton/appsensor) и [OWASP Automated Threats to Web Applications](https://owasp.org/www-project-automated-threats-to-web-applications/)
* [OWASP AppSensor](https://github.com/jtmelton/appsensor) также может помочь с обнаружением и реагированием на атаки.
* [OWASP Cornucopia](https://owasp.org/www-project-cornucopia/)
