# 附录C: 物联网验证要求

本章原本是在main分支中，但考虑到OWASP IoT团队已完成的工作，所以在该主题上维护两个不同的线程没有意义。对于 4.0 版本，我们将其移到附录中，并敦促所有需要此功能的人使用主要的 [OWASP IoT 项目](https://owasp.org/www-project-internet-of-things/)

## 控制目标

嵌入式/IoT设备应该满足：

* 通过在受信任的环境中实施安全控制，在设备内拥有与服务器中相同级别的安全控制。
* 存储在设备上的敏感数据，应使用硬件支持的存储（如安全元件）以安全的方式完成。
* 从设备传输的所有敏感数据，都应利用传输层安全。

## 安全验证要求

| # | 说明 | L1 | L2 | L3 | 起始时间 |
| --- | --- | --- | --- | -- | -- |
| **C.1** | 验证应用层调试接口，如USB、UART和其他串行变体，是否被禁用或受到复杂密码的保护。 | ✓ | ✓ | ✓ | 4.0 |
| **C.2** | 验证加密密钥和证书对于每个单独的设备都是唯一的。 | ✓ | ✓ | ✓ | 4.0 |
| **C.3** | 验证嵌入式/IoT 操作系统（如果适用）是否启用了内存保护控制（如 ASLR 和 DEP）。 | ✓ | ✓ | ✓ | 4.0 |
| **C.4** | 验证是否禁用了 JTAG 或 SWD 等片上调试接口，或者是否启用并正确配置了可用的保护机制。 | ✓ | ✓ | ✓ | 4.0 |
| **C.5** | 验证是否已实施并启用受信任的执行（如果在设备 SoC 或 CPU 上可用）。 | ✓ | ✓ | ✓ | 4.0 |
| **C.6** | 验证敏感数据、私钥和证书是否安全存储在Secure Element、TPM、TEE (Trusted Execution Environment)中，或使用强加密保护。 | ✓ | ✓ | ✓ | 4.0 |
| **C.7** | 验证固件应用程序使用传输层安全，保护传输中的数据。 | ✓ | ✓ | ✓ | 4.0 |
| **C.8** | 验证固件应用程序验证与服务器连接的数字签名。 | ✓ | ✓ | ✓ | 4.0 |
| **C.9** | 验证无线通信鉴权。 | ✓ | ✓ | ✓ | 4.0 |
| **C.10** | 验证无线通信是否通过加密通道发送。 | ✓ | ✓ | ✓ | 4.0 |
| **C.11** | 验证任何被禁止的C函数，都被替换成适当的安全函数。 | ✓ | ✓ | ✓ | 4.0 |
| **C.12** | 验证每个固件都有一个软件材料清单，其中包括第三方组件、版本和已公布的漏洞。 | ✓ | ✓ | ✓ | 4.0 |
| **C.13** | 验证所有代码，包括第三方二进制文件、库、框架都经过审查，以防止硬编码凭据（后门）。 | ✓ | ✓ | ✓ | 4.0 |
| **C.14** | 通过调用shell命令封装器、脚本或安全控制，来防止操作系统命令注入，验证应用程序和固件组件不受操作系统命令注入的影响。 | ✓ | ✓ | ✓ | 4.0 |
| **C.15** | 验证固件应用程序将数字签名固定到可信服务器。 |  | ✓ | ✓ | 4.0 |
| **C.16** | 验证是否存在防篡改或篡改检测功能。 |  | ✓ | ✓ | 4.0 |
| **C.17** | 验证是否启用了芯片制造商提供的任何可用的知识产权保护技术。 |  | ✓ | ✓ | 4.0 |
| **C.18** | 验证安全控制是否到位，以阻止固件逆向工程（例如，删除冗长的调试符号）。 |  | ✓ | ✓ | 4.0 |
| **C.19** | 验证设备在加载前校验启动镜像的签名。 |  | ✓ | ✓ | 4.0 |
| **C.20** | 验证固件更新过程不会受到“检查时间与使用时间”攻击（译者注：time-of-check vs time-of-use attacks）。 |  | ✓ | ✓ | 4.0 |
| **C.21** | 验证设备在安装前使用代码签名并校验固件升级文件。 |  | ✓ | ✓ | 4.0 |
| **C.22** | 验证设备不能被降级到有效固件的旧版本（防回滚）。 |  | ✓ | ✓ | 4.0 |
| **C.23** | 验证嵌入式设备使用了密码学安全的伪随机数生成器（例如，使用芯片提供的随机数生成器）。 |  | ✓ | ✓ | 4.0 |
| **C.24** | 验证固件能够按照预定的时间表，执行自动固件更新。 |  | ✓ | ✓ | 4.0 |
| **C.25** | 验证设备在检测到篡改或收到无效信息时，能擦除固件和敏感数据。 |  |  | ✓ | 4.0 |
| **C.26** | 验证只使用了支持禁用调试接口（如JTAG、SWD）的微控制器。 |  |  | ✓ | 4.0 |
| **C.27** | 验证只使用了提供实质性保护的微控制器，以防止“去封装”（译者注：de-capping, decapsulation）和侧信道攻击。 |  |  | ✓ | 4.0 |
| **C.28** | 验证敏感导线不暴露在印刷电路板的外层。 |  |  | ✓ | 4.0 |
| **C.29** | 验证芯片间的通信是加密的（如主板到子板的通信）。 |  |  | ✓ | 4.0 |
| **C.30** | 验证设备使用代码签名并在执行前验证代码。 |  |  | ✓ | 4.0 |
| **C.31** | 验证保存在内存中的敏感信息一旦不再需要，就立即用零值覆盖。 |  |  | ✓ | 4.0 |
| **C.32** | 验证固件应用程序利用内核容器在应用程序之间进行隔离。 |  |  | ✓ | 4.0 |
| **C.33** | 验证安全编译器标志，例如 -fPIE, -fstack-protector-all, -Wl,-z,noexecstack, -Wl,-z,noexecheap 已配置到固件构建中。 |  |  | ✓ | 4.0 |
| **C.34** | 验证微型控制器是否配置了代码保护（如果适用）。 |  |  | ✓ | 4.0 |

## 参考文献

有关更多信息，请参阅：

* [OWASP Internet of Things Top 10](https://owasp.org/www-pdf-archive/OWASP-IoT-Top-10-2018-final.pdf)
* [OWASP Embedded Application Security Project](https://owasp.org/www-project-embedded-application-security/)
* [OWASP Internet of Things Project](https://owasp.org/www-project-internet-of-things/)
* [Trudy TCP Proxy Tool](https://github.com/praetorian-inc/trudy)
