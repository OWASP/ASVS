# V8 数据保护

## Control Objective

健全的数据保护有三个关键因素。机密性、完整性和可用性（CIA）。这个标准假定数据保护是在一个可信的系统上执行的，比如服务器，它已经被加固并有足够的保护措施。

应用程序必须假设所有的用户设备都以某种方式受到损害。如果应用程序在不安全的设备上传输或存储敏感信息，如共享电脑、手机和平板电脑，应用程序有责任确保存储在这些设备上的数据是加密的，不能轻易地被非法获取、改变或披露。

确保经过验证的应用程序满足以下高水平的数据保护要求：

* 机密性。数据应受到保护，在传输过程中和存储时都不会被未经授权的观察或披露。
* 完整性。应保护数据不被未经授权的攻击者恶意创建、更改或删除。
* 可用性。数据应按要求提供给授权的用户。

## V8.1 通用数据保护

| # | 说明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---: | :---: | :---: |
| **8.1.1** | 验证应用程序保护敏感数据不被缓存在负载均衡和应用程序缓存等服务器组件中。 | | ✓ | ✓ | 524 |
| **8.1.2** | 验证在服务器上所存储敏感数据的所有缓存或临时副本是否受到保护（防止未经授权的访问），或在被授权用户访问后清除/失效。 | | ✓ | ✓ | 524 |
| **8.1.3** | 验证应用程序尽量减少请求中的参数数量，如隐藏字段、Ajax 变量、cookies 和请求头。 | | ✓ | ✓ | 233 |
| **8.1.4** | 验证应用程序能够检测并提醒异常的请求数量，例如按IP、用户、每小时或每天的总数，或其它对应用程序有意义的指标。 | | ✓ | ✓ | 770 |
| **8.1.5** | 验证是否对重要数据进行了定期备份，是否对数据进行了测试恢复。 | | | ✓ | 19 |
| **8.1.6** | 验证备份的安全存储，防止数据被盗或损坏。 | | | ✓ | 19 |

## V8.2 客户端数据保护

| # | 说明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---: | :---: | :---: |
| **8.2.1** | 验证应用程序设置足够的“禁止缓存”头，以便敏感数据不会在现代浏览器中被缓存。 | ✓ | ✓ | ✓ | 525 |
| **8.2.2** | 验证存储在浏览器存储（例如 localStorage、sessionStorage、IndexedDB 或 cookie）中的数据不包含敏感数据。 | ✓ | ✓ | ✓ | 922 |
| **8.2.3** | 在客户端或会话终止后，验证经过身份验证的数据已从客户端存储（例如浏览器 DOM）中清除。 | ✓ | ✓ | ✓ | 922 |

## V8.3 敏感私有数据

本小节有助于保护敏感数据免遭未经授权的创建、读取、更新或删除，尤其是批量数据。

遵守本节意味着遵守 V4 访问控制，尤其是 V4.2。例如，为了防止个人敏感信息的未授权的更新或泄露，需要遵守 V4.2.1。请遵守本节和 V4 以获得全面覆盖。

注意：隐私法规和法律，例如澳大利亚隐私原则 APP-11 或 GDPR，直接影响应用程序必须如何处理敏感个人信息的存储、使用和传输的实施。范围从严厉的处罚到简单的建议。请查阅您当地的法律法规，并根据需要咨询专业的隐私专家或律师。

| # | 说明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---: | :---: | :---: |
| **8.3.1** | 验证敏感数据是在HTTP消息正文或请求头中被发送到服务器，以及HTTP请求方法的查询字符串参数都不包含敏感数据。 | ✓ | ✓ | ✓ | 319 |
| **8.3.2** | 验证用户是否有途径按需删除或导出自己的数据。 | ✓ | ✓ | ✓ | 212 |
| **8.3.3** | 验证向用户提供了关于收集和使用其个人信息的明确语言，并且在以任何方式使用这些数据之前，用户已勾选了同意。 | ✓ | ✓ | ✓ | 285 |
| **8.3.4** | 验证应用程序创建和处理的所有敏感数据是否已被识别，并确保已制定了如何处理敏感数据的策略。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 200 |
| **8.3.5** | 如果数据是根据相关数据保护指令收集的或（应用）要求记录访问日志，验证访问敏感数据是否被审计（不记录敏感数据本身）。 | | ✓ | ✓ | 532 |
| **8.3.6** | 为了减少内存转储攻击，一旦不再需要内存中的敏感信息，请检查该敏感信息是否会被覆盖（使用0或随机数）。 | | ✓ | ✓ | 226 |
| **8.3.7** | 验证需要加密的敏感信息或私有信息是否使用经过批准的机密性和完整性算法加密。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 327 |
| **8.3.8** | 验证敏感的个人信息是否符合数据保留分类，以便自动、按计划或根据情况需要删除旧数据或过时数据。 | | ✓ | ✓ | 285 |

在考虑数据保护时，首要的考虑应该围绕批量提取、修改或过度使用。例如，许多社交媒体系统只允许用户每天添加100个新好友，但这些请求来自哪个系统并不重要。银行平台可能希望阻止每小时超过5笔的、转移超过1000欧元的外部交易。每个系统的要求可能非常不同，所以决定 “异常” 必须考虑威胁模型和商业风险。重要的标准是检测、遏制，或者最好是阻止这种异常批量行为的能力。

## 参考文献

有关更多信息，请参阅：

* [Consider using Security Headers website to check security and anti-caching headers](https://securityheaders.io)
* [OWASP Secure Headers project](https://owasp.org/www-project-secure-headers/)
* [OWASP Privacy Risks Project](https://owasp.org/www-project-top-10-privacy-risks/)
* [OWASP User Privacy Protection Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html)
* [European Union General Data Protection Regulation (GDPR) overview](https://edps.europa.eu/data-protection_en)
* [European Union Data Protection Supervisor - Internet Privacy Engineering Network](https://edps.europa.eu/data-protection/ipen-internet-privacy-engineering-network_en)
