# V2 认证

## 控制目标

认证是建立或确认某人（或某物）的真实性，并且个人或设备的声明是正确的，可防止假冒，并防止恢复或拦截密码。

当ASVS首次发布时，用户名+密码是最常见的认证形式（除高安全系统以外）。 多因素身份验证（MFA）在安全界被普遍接受，但在其他地方很少需要。 随着密码泄露次数的增加，认为用户名在某种程度上是保密的，而密码则是未知的这种想法使得许多安全控制无法成立。 例如，NIST 800-63 将用户名和基于知识的身份验证（KBA）视为公共信息，将 SMS 和电子邮件通知视为[“受限”的认证类型](https://pages.nist.gov/800-63-FAQ/#q-b1)，而密码是预先泄露的。 这一现实使基于知识的认证器、短信和电子邮件恢复、密码历史、复杂性和轮换控制变得毫无用处。 这些控制措施不总那么有用，经常迫使用户每隔几个月就想出一些弱的密码，但是随着50多亿用户名和密码泄露事件的公布，现在是时候继续前进了。

在ASVS的所有章节中，认证和会话管理章节的变化最大。采用有效的、以证据为基础的领先实践，对许多人来说将是挑战，这完全没问题。 现在我们必须开始向未来的后密码时代过渡。

## NIST 800-63 - 现代的、基于证据的认证标准

[NIST 800-63b](https://pages.nist.gov/800-63-3/sp800-63b.html) 是一种现代的、基于证据的标准，代表了可用的最佳建议，无论其适用性如何。该标准对世界各地的所有组织都有帮助，但与美国机构和与美国机构打交道的机构尤其相关。

NIST 800-63的术语一开始可能有点令人困惑，特别是你只习惯于用户名+密码认证的话。 现代认证的进步是必要的，所以我们必须引入将来会变得司空见惯的术语，但我们确实理解：在行业落实这些新术语之前，理解这些新术语的困难。 我们在本章末尾提供了一个词汇表，以提供帮助。 我们重新表述了许多要求，以满足要求的意图，而不只是拘泥于文字。 例如，当NIST在本标准中使用“记忆秘密”时（memorized secret），ASV使用术语“密码”（password）。

ASVS V2 身份验证、V3 会话管理以及在较小程度上的V4 访问控制，已被调整为符合 NIST 800-63b 控制项的一个子集，主要围绕常见的威胁和经常被利用的认证弱点。如果需要完全遵守NIST 800-63，请参考NIST 800-63。

### 选择合适的 NIST AAL 级别

应用程序安全验证标准（ASVS），已尝试将 ASVS L1 对应到 NIST AAL1 要求，将 L2 对应到 AAL2，将 L3 对应到 AAL3。 然而，ASVS Level 1作为“基本”的控制，不一定是验证应用或API的正确AAL级别。 例如，如果该应用是 L3 应用或有 AAL3 的监管要求，则应在V2和V3会话管理章节选择 L3。 应根据NIST 800-63b指南选择符合NIST标准的认证保证级别（AAL），如[NIST 800-63b第6.2节](https://pages.nist.gov/800-63-3/sp800-63-3.html#AAL_CYOA) 中的 *Selecting AAL* 。

## 图例

应用程序总是可以超过当前级别的要求，特别是如果现代认证是在应用程序的路线图上。以前，ASVS要求强制MFA。NIST不要求强制MFA。因此，我们在本章中使用了一个可选的指定，以表明ASVS鼓励但不要求控制的地方。本标准自始至终使用了以下图示：

| 标记 | 说明 |
| :--: | :-- |
| | 不要求 |
| o | 建议，但不要求 |
| ✓ | 要求 |

## V2.1 密码安全

在NIST 800-63中，密码被称为“记忆的秘密”（Memorized Secrets），包括密码、PIN、解锁图案、选择正确的小猫或其他图像元素以及密码短语。 它们通常被认为是“您知道的东西”，并且通常用作单因素身份认证工具。 继续使用单因素认证有很大的风险，包括互联网上披露的数十亿有效用户名和密码、默认或弱密码、彩虹表和最常见密码的有序字典。

应用程序应强烈鼓励用户注册多因素认证，并应允许用户重新使用他们已经拥有的令牌，如FIDO或U2F令牌，或链接到提供多因素认证的凭证服务提供商。

凭据服务提供商（CSP）为用户提供联合身份。 用户通常会拥有多个CSP的多个身份，例如使用Azure AD、Okta、Ping identity或Google的企业身份，或使用Facebook、Twitter、Google或微信的普通用户，这只是一些常见的可能。 这份清单并不是对这些公司或服务的认可，而只是鼓励开发者考虑用户有许多既定身份的现实。 组织应该考虑与现有的用户身份整合，根据CSP的身份证明强度的风险状况，组织应考虑与现有用户身份集成。 例如，政府机构不太可能接受社交媒体身份作为敏感系统的登录名，因为很容易伪造或丢弃身份，而移动游戏公司可能需要与主要社交媒体平台整合，以扩大他们的活跃玩家群。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.1.1** | 验证用户设置的密码长度至少为 12 个字符（多个空格合并后）。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.2** | 验证是否允许64个字符以上的密码，并拒绝超过128个字符的密码。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.3** | 验证不进行密码截断。然而，连续的多个空格可以被单个空格代替。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.4** | 验证密码中是否允许使用任何可打印的Unicode字符，包括语言中立字符，例如空格和表情符号。 | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.5** | 验证用户可以更改其密码。 | ✓ | ✓ | ✓ | 620 | 5.1.1.2 |
| **2.1.6** | 验证密码更改功能是否需要用户的当前密码和新密码。 | ✓ | ✓ | ✓ | 620 | 5.1.1.2 |
| **2.1.7** | 验证在账户注册、登录和密码更改过程中提交的密码，是否出现在被泄露过的密码中，这些密码可以是本地的（如符合系统密码策略的前1000个或10000个最常见的密码），也可以使用外部API。 如果使用API，应使用零知识证明或其他机制，以确保纯文本密码不被发送或用于验证密码的违反状态。 如果密码被泄露，应用程序必须要求用户设置一个新的未被泄露的密码。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.8** | 验证是否提供了密码强度表，以帮助用户设置更强的密码。 | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.9** | 验证是否有限制允许的字符类型的密码组成规则。对大写或小写、数字或特殊字符不应有任何要求。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.10** | 验证没有定期更换凭证或密码历史的要求。 | ✓ | ✓ | ✓ | 263 | 5.1.1.2 |
| **2.1.11** | 验证是否允许 “粘贴” 功能、浏览器密码辅助工具和外部密码管理器。 | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.12** | 验证用户可以选择临时查看整个屏蔽的密码，或者在没有内置功能的平台上临时查看密码的最后输入的字符。 | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |

注意：允许用户查看密码或临时查看最后一个字符的目的，是为了提高凭证输入的可用性，尤其是在使用更长的密码、口令和密码管理器时。 包含该要求的另一个原因，是为了防止测试报告不必要地要求组织重写内置平台密码字段的行为，从而保持这种现代用户友好的安全体验。

## V2.2 通用身份验证器的安全性

身份验证器的敏捷性，对于面向未来的应用程序至关重要。 重构应用程序验证器以允许用户根据偏好添加额外的验证器，并允许以有序的方式停用已弃用或不安全的验证器。

NIST 将电子邮件和 SMS 视为 [“受限”的身份验证器类型](https://pages.nist.gov/800-63-FAQ/#q-b1)，它们很可能在未来的某个时候从NIST 800-63以及ASVS中删除。 应用程序应计划一个不需要使用电子邮件或短信的路线图。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.2.1** | 验证反自动化控制的措施能够有效地缓解被泄露的凭证测试、暴力破解和账户锁定攻击。 这些控制措施包括阻止最常见的泄露密码、软锁定、速率限制、验证码、每次尝试后逐渐增加的间隔时间、IP地址限制，或基于风险的限制，例如位置、设备上的首次登录、最近解锁账户的尝试等类似情况。 验证单个帐户每小时的失败尝试次数不超过 100 次。 | ✓ | ✓ | ✓ | 307 | 5.2.2 / 5.1.1.2 / 5.1.4.2 / 5.1.5.2 |
| **2.2.2** | 验证弱身份验证器（例如 SMS 和电子邮件）的使用，仅限于二次验证和批准交易，而不是作为更安全的认证方法的替代。 验证是否在弱方法之前提供了更强的方法，用户是否意识到风险，或者是否采取了适当的措施来限制帐户泄露的风险。 | ✓ | ✓ | ✓ | 304 | 5.2.10 |
| **2.2.3** | 验证在更新认证信息（如凭证重置、电子邮件或地址变更、从未知或风险地点登录）后向用户发送安全通知。 最好使用推送通知——而不是短信或电子邮件，但在没有推送通知的情况下，只要通知中没有披露敏感信息，短信或电子邮件也是可以接受的。 | ✓ | ✓ | ✓ | 620 | |
| **2.2.4** | 验证对网络钓鱼的抗冒充性，如使用多因素认证、有意图的加密设备（如有推送认证的连接密钥），或在更高的AAL级别，客户端证书。 | | | ✓ | 308 | 5.2.5 |
| **2.2.5** | 验证当凭证服务提供者（CSP）和验证认证的应用程序分开时，两个端点之间有相互认证的TLS（mTLS）。 | | | ✓ | 319 | 5.2.6 |
| **2.2.6** | 验证抗重放性，是否通过强制使用一次性密码（OTP）设备、加密认证器或查询代码。 | | | ✓ | 308 | 5.2.8 |
| **2.2.7** | 通过要求输入OTP令牌或用户发起的动作（如按下FIDO硬件钥匙的按钮）来验证认证意图。 | | | ✓ | 308 | 5.2.9 |

## V2.3 身份验证器生命周期

认证器是密码、软令牌、硬件令牌和生物识别设备。认证器的生命周期对应用程序的安全至关重要——如果任何人都可以在没有身份证明的情况下自行注册一个账户，那么对身份断言的信任就会很低。 对于像Reddit这样的社交媒体网站，这是完全可以的。 对于银行系统来说，更加注重凭证和设备的注册和发放（对应用程序的安全至关重要）。

注意：密码不要有最长的使用寿命，也不要进行密码轮换。 应检查密码是否已泄露，而不是定期更换。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.3.1** | 验证系统生成的初始密码或激活码应该是安全随机生成的，应该至少有6个字符的长度，可以包含字母和数字，并在短时间内过期。这些初始秘密不得被允许成为长期密码。 | ✓ | ✓ | ✓ | 330 | 5.1.1.2 / A.3 |
| **2.3.2** | 验证是否支持注册和使用用户提供的认证设备，如U2F或FIDO令牌。 | | ✓ | ✓ | 308 | 6.1.3 |
| **2.3.3** | 验证更新指令的发送时间是否足够，以更新有时间限制的认证器。 | | ✓ | ✓ | 287 | 6.1.4 |

## V2.4 凭证存储

架构师和开发人员在构建或重构代码时，应遵守本节。本节内容只能使用源代码审查或通过安全单元或集成测试来完全验证。渗透测试不能识别这里面的任何问题。

经批准的单向密钥推导功能列表详见NIST 800-63 B第5.1.1.2节，以及 [BSI Kryptographische Verfahren: Empfehlungen und Schlussell&auml;ngen (2018)](https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.pdf?__blob=publicationFile)。除了上面这些选择，还可以根据最新的国家或地区选择算法和密钥长度标准。

此部分无法进行渗透测试，因此控制措施未标记为 L1。但是，如果证书被盗，这部分对证书的安全至关重要，因此如果为架构或编码指南或源代码审查清单Fork ASVS，请在您的私有版本中将这些控制措施放回 L1。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.4.1** | 验证密码是以一种可以抵抗离线攻击的形式存储的。密码应使用认可的单向密钥推导或密码散列函数进行加盐和散列。密钥推导和密码散列函数，在生成密码散列时，将密码、盐和计算成本作为输入。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **2.4.2** | 验证盐的长度至少为32位，并且是任意选择的，以减少存储的哈希值之间的碰撞。对于每个凭证，应存储唯一的盐值和由此产生的哈希值。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **2.4.3** | 验证如果使用 PBKDF2，迭代次数应在验证服务器性能允许的范围内，一般至少为100,000次迭代。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **2.4.4** | 验证如果使用 bcrypt，工作系数应在验证服务器性能允许的范围内尽量大，最小为10。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **2.4.5** | 验证是否执行了密钥派生函数的额外迭代，使用的是只有验证者知道的秘密盐值。使用经批准的随机位生成器 [SP 800-90Ar1] 生成盐值，并至少提供 SP 800-131A 最新修订版中规定的最低安全强度。秘密盐值应与散列密码分开存储（例如，在像硬件安全模块这样的专用设备中）。 | | ✓ | ✓ | 916 | 5.1.1.2 |

在提到美国标准时，可以根据需要使用地区或当地标准来代替或补充美国标准。

## V2.5 凭证恢复

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.5.1** | 验证系统生成的初始激活或恢复密码，不会以明文形式发送给用户。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **2.5.2** | 验证密码提示或基于知识的身份验证（所谓的“密码保护问题”）不存在。 | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **2.5.3** | 验证密码凭据恢复不会以任何方式泄露当前密码。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **2.5.4** | 验证共享或默认帐户不存在（例如“root”、“admin”或“sa”）. | ✓ | ✓ | ✓ | 16 | 5.1.1.2 / A.3 |
| **2.5.5** | 验证如果更改或替换了身份验证因素，则用户会收到此事件的通知。 | ✓ | ✓ | ✓ | 304 | 6.1.2.3 |
| **2.5.6** | 验证忘记密码以及其他恢复路径，使用了安全的恢复机制，例如基于时间的OTP（TOTP）或其他软令牌、移动推送或其他离线恢复机制。 ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **2.5.7** | 验证如果OTP或多因素身份验证因素丢失，身份证明的执行水平与注册时相同。 | | ✓ | ✓ | 308 | 6.1.2.3 |

## V2.6 查找密码认证

查找密码（译者注：Look-up secrets，类似于密码保护卡），是预先生成的秘密代码列表，类似于交易授权号码（TAN）、社交媒体恢复代码，或包含一组随机值的网格。 这些被安全地分配给用户。这些 查询代码只使用一次，一旦全部使用，查询的秘密列表就会被丢弃。这种类型的认证器被认为是 “你拥有的东西”。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.6.1** | 验证查找密文只能使用一次。 | | ✓ | ✓ | 308 | 5.1.2.2 |
| **2.6.2** | 验证查询秘密有足够的随机性（112位熵），如果少于112位熵，则用唯一的随机32位盐进行加盐，并用认可的单向散列进行散列。 | | ✓ | ✓ | 330 | 5.1.2.2 |
| **2.6.3** | 验证查找秘密能够抵抗离线攻击，例如可预测的值。 | | ✓ | ✓ | 310 | 5.1.2.2 |

## V2.7 带外验证器

在过去，常见的带外验证器是包含密码重置链接的电子邮件或短信。攻击者利用这种薄弱的机制来重置他们尚未控制的账户，例如接管一个人的电子邮件账户并重新使用任何发现的重置链接。 处理带外验证有更好的方法。

安全的带外验证器是可以通过安全的二级信道与验证器进行通信的物理设备。 例子包括向移动设备推送通知。这种类型的验证器被认为是 “你拥有的东西”。 当用户希望进行认证时，验证应用程序通过与认证器的连接，直接或间接地通过第三方服务向带外认证器发送一个消息。 该消息包含一个认证代码（通常是一个随机的六位数或一个模式化的批准对话框）。 验证应用程序等待通过主通道接收验证码，并将接收到的值的哈希值与原始验证码的哈希值进行比较。如果它们匹配，则带外验证器可以认为用户已通过身份验证。

ASVS假定只有少数开发者会开发新的带外认证器，如推送通知，因此以下ASVS控制措施适用于验证器，如认证API、应用程序和单点登录实现。 如果开发一个新的带外认证器，请参考 NIST 800-63B &sect; 5.1.3.1。

不安全的带外认证器，如电子邮件和VOIP是不允许的。 PSTN和SMS认证目前受到NIST的 “限制”，应该被弃用，以支持推送通知或类似的方式。 如果你需要使用电话或短信的带外认证，请参见 NIST 800-63B &sect; 5.1.3.3。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.7.1** | 验证默认情况下不提供短信或PSTN等带外的明文认证器，并首先提供推送通知等更强的替代方案。 | ✓ | ✓ | ✓ | 287 | 5.1.3.2 |
| **2.7.2** | 验证带外验证器在10分钟后将带外验证请求、代码或令牌过期。 | ✓ | ✓ | ✓ | 287 | 5.1.3.2 |
| **2.7.3** | 验证带外验证器身份验证请求、代码或令牌仅可使用一次，并且仅可用于原始身份验证请求。 | ✓ | ✓ | ✓ | 287 | 5.1.3.2 |
| **2.7.4** | 验证带外验证器和验证器是否通过安全的独立信道进行通信。 | ✓ | ✓ | ✓ | 523 | 5.1.3.2 |
| **2.7.5** | 验证带外验证器只保留认证代码的散列版本。 | | ✓ | ✓ | 256 | 5.1.3.2 |
| **2.7.6** | 验证初始验证码是否由安全随机数生成器生成，包含至少 20 位熵（通常为 6 位数字随机数即可）。 | | ✓ | ✓ | 310 | 5.1.3.2 |

## V2.8 一次性验证器

单因素一次性密码（OTP），是显示持续变化的伪随机一次性挑战的物理或软令牌。 这些设备使网络钓鱼（冒充）变得困难，但并非不可能。 这种类型的身份验证器被认为是“你拥有的东西”。 多因素令牌，类似于单因素 OTP，但需要输入有效的 PIN 码、生物识别解锁、USB 插入、NFC 配对或一些附加值（例如交易签名计算器）才能创建最终 OTP。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.8.1** | 验证基于时间的OTP在过期前有确定的使用寿命 | ✓ | ✓ | ✓ | 613 | 5.1.4.2 / 5.1.5.2 |
| **2.8.2** | 验证用于验证提交的OTP的对称密钥是否被高度保护，例如使用硬件安全模块或基于安全操作系统的密钥存储。 | | ✓ | ✓ | 320 | 5.1.4.2 / 5.1.5.2 |
| **2.8.3** | 验证OTP的生成、播种和验证是否使用了经过批准的加密算法。 | | ✓ | ✓ | 326 | 5.1.4.2 / 5.1.5.2 |
| **2.8.4** | 验证基于时间的OTP在有效期内只能使用一次。 | | ✓ | ✓ | 287 | 5.1.4.2 / 5.1.5.2 |
| **2.8.5** | 验证如果基于时间的多因素OTP令牌在有效期内被重复使用，将被记录并拒绝，同时向设备持有者发送安全通知。 | | ✓ | ✓ | 287 | 5.1.5.2 |
| **2.8.6** | 验证物理单因素OTP生成器在被盗或其他损失的情况下可以被撤销。确保撤销在登录会话中立即生效，无论在何处。 | | ✓ | ✓ | 613 | 5.2.1 |
| **2.8.7** | 验证生物特征身份验证器仅限于用作次要因素，与“你拥有的东西”和“你知道的东西”一起使用。 | | o | ✓ | 308 | 5.2.3 |

## V2.9 密码验证器

加密安全密钥是智能卡或FIDO密钥，用户必须将加密设备插入或配对到计算机上才能完成身份验证。验证者立即向加密设备或软件发送挑战随机数，设备或软件根据安全存储的加密密钥计算出响应。

对单因素密码设备和软件的要求，和多因素密码设备和软件的要求是一样的，都是证明密码认证者拥有认证因素。

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.9.1** | 验证用于验证的加密密钥是否安全存储并防止泄露，例如使用可信平台模块（TPM）或硬件安全模块（HSM），或可以使用这种安全存储的操作系统服务。 | | ✓ | ✓ | 320 | 5.1.7.2 |
| **2.9.2** | 验证质询随机数的长度至少为 64 位，并且在统计学上是唯一的，或在加密设备的生命周期内是唯一的。 | | ✓ | ✓ | 330 | 5.1.7.2 |
| **2.9.3** | 验证在生成、播种和验证中使用经批准的加密算法。 | | ✓ | ✓ | 327 | 5.1.7.2 |

## V2.10 服务认证

此部分不可渗透测试，因此没有任何 L1 要求。但是，如果用于架构、编码或安全代码审查，请假设软件（就像 Java 密钥库一样）是 L1 的最低要求。 在任何情况下都不允许明文存储秘密。

注：
- HSM，硬件安全模块（Hardware Security Module）
- OS assisted，操作系统协助

| # | 说明 | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---: | :---: | :---: | :---: |
| **2.10.1** | 验证服务内机密不依赖于不变的凭据，例如密码、API 密钥或具有特权访问权限的共享帐户。 | | OS assisted | HSM | 287 | 5.1.1.1 |
| **2.10.2** | 验证如果服务身份验证需要密码，则使用的服务帐户不是默认凭据（例如，root/root 或 admin/admin 是安装过程中某些服务的默认设置）。 | | OS assisted | HSM | 255 | 5.1.1.1 |
| **2.10.3** | 验证存储的密码是否有足够的保护，以防止离线恢复攻击，包括本地系统访问。 | | OS assisted | HSM | 522 | 5.1.1.1 |
| **2.10.4** | 验证密码、与数据库和第三方系统的集成、种子和内部机密以及 API 密钥都得到安全管理，不包含在源代码中或存储在源代码存储库中。 这种存储应能抵御离线攻击。建议使用安全的软件密钥存储（L1）、硬件 TPM 或 HSM（L3）来存储密码。 | | OS assisted | HSM | 798 | |

## 美国机构的其他要求

美国机构对 NIST 800-63 有强制性要求。 一直以来，应用安全验证标准都是对几乎100%的应用采取80%的控制措施，而不是最后20%的高级控制或那些有限的适用性。 因此，ASVS 是 NIST 800-63 的一个严格的子集，特别是对于 IAL1/2 和 AAL1/2 分类，但不够全面，特别是关于 IAL3/AAL3 分类。

我们强烈敦促美国政府机构全面审查和实施 NIST 800-63。

## 术语表

| 术语 | 含义 |
| -- | -- |
| CSP | 凭证服务提供者也称为身份提供者 |
| Authenticator | 验证密码、令牌、MFA、联合断言等的代码。 |
| Verifier | “通过使用认证协议，验证申请人对一个或两个认证器的拥有和控制，来验证申请人的身份的实体。 为此，验证者可能还需要验证将认证器与用户的标识符联系起来的凭证，并检查其状态” |
| OTP | 一次性密码 |
| SFA | 单因素身份验证，例如“您知道的东西”（记忆的秘密、密码、密码短语、pin），“您的特征“（生物特征识别、指纹、面部扫描），或“您拥有的东西“（OTP令牌、智能卡等加密设备）， |
| MFA | 多因素认证，包括两个或多个单因素 |

## 参考文献

有关更多信息，请参阅：

* [NIST 800-63 - Digital Identity Guidelines](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf)
* [NIST 800-63 A - Enrollment and Identity Proofing](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63a.pdf)
* [NIST 800-63 B - Authentication and Lifecycle Management](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf)
* [NIST 800-63 C - Federation and Assertions](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63c.pdf)
* [NIST 800-63 FAQ](https://pages.nist.gov/800-63-FAQ/)
* [OWASP Testing Guide 4.0: Testing for Authentication](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/README.html)
* [OWASP Cheat Sheet - Password storage](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)
* [OWASP Cheat Sheet - Forgot password](https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html)
* [OWASP Cheat Sheet - Choosing and using security questions](https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
