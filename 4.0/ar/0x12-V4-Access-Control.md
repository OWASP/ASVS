# ت4: التحكم في الوصول

## الهدف من ضوابط الأمان

التفويض Authorization هو مفهوم السماح بالوصول إلى الموارد فقط لمن يُسمح لهم باستخدامها. تأكد من أن التطبيق الذي يتم التحقق منه يفي بالمتطلبات عالية المستوى التالية:

* يمتلك الأشخاص الذين يصلون إلى الموارد بيانات اعتماد صالحة للقيام بذلك.
* يرتبط المستخدمون بمجموعة معرفة جيداً من الأدوار والامتيازات.
* البيانات الوصفية metadata للدور والإذن محمية من الإعادة replay أو العبثtampering .

## متطلبات التحقق الأمني

## ق1.4 التصميم العام للتحكم في الوصول

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.1.4** | تحقق من أن التطبيق يفرض قواعد التحكم في الوصول على طبقة خدمة موثوقة trusted service layer ، خاصةً إذا كان التحكم في الوصول من جانب العميل موجودًا ويمكن تجاوزه. | ✓ | ✓ | ✓ | 602 |
| **2.1.4** | تحقق من أن جميع خصائص المستخدم attributes والبيانات ومعلومات السياسة المستخدمة بواسطة عناصر التحكم في الوصول لا يمكن التلاعب بها من قبل المستخدمين النهائيين ما لم يتم التفويض بذلك على وجه التحديد. | ✓ | ✓ | ✓ | 639 |
| **3.1.4** | تحقق من وجود مبدأ الامتيازات الأقل least privilege - يجب أن يكون المستخدمون قادرين فقط على الوصول إلى الوظائف وملفات البيانات وعناوين URL ووحدات التحكم والخدمات والموارد الأخرى التي يمتلكون تفويضًا محددًا لها. هذا يعني الحماية ضد الانتحال spoofing ورفع الامتيازات elevation of privilege. ([C7](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 285 |
| **4.1.4** | [تم حذفها ، مكررة عن 3.1.4] | | | | |
| **5.1.4** | تحقق من أن ضوابط الوصول تفشل بشكل آمن بما في ذلك عند حدوث استثناء exception. ([C10](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 285 |

## ق2.4 التحكم في الوصول لمستوى التشغيل

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.2.4** | تحقق من أن البيانات الحساسة وواجهات برمجة التطبيقات محمية ضد هجمات مرجع الكائن المباشر غير الآمن Insecure Direct Object Reference (IDOR) التي تستهدف إنشاء السجلات وقراءتها وتحديثها وحذفها ، مثل إنشاء أو تحديث سجل شخص آخر أو عرض سجلات الجميع أو حذف جميع السجلات. | ✓ | ✓ | ✓ | 639 |
| **2.2.4** | تحقق من أن التطبيق أو إطار العمل يفرض آلية قوية لمكافحة CSRF (anti-CSRF mechanism) لحماية الوظائف المصادق عليها ، وأن مكافحة الأتمتة anti-automation  الفعالة أو مكافحة CSRF تحمي الوظائف غير المصادق عليها. | ✓ | ✓ | ✓ | 352 |

## ق3.4 اعتبارات أخرى للتحكم في الوصول

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.3.4** | تحقق من أن واجهات الإدارة تستخدم المصادقة متعددة العوامل المناسبة لمنع الاستخدام غير المصرح به. | ✓ | ✓ | ✓ | 419 |
| **2.3.4** | تحقق من تعطيل تصفح الدليل directory browsing ما لم يكن ذلك مطلوبًا بشكل متعمد. بالإضافة إلى ذلك ، يجب ألا تسمح التطبيقات باكتشاف البيانات الوصفية metadata للملف أو المجلد أو الكشف عنها ، مثل مجلدات Thumbs.db أو .DS_Store أو .git أو .svn. | ✓ | ✓ | ✓ | 548 |
| **3.3.4** | تحقق من أن التطبيق لديه تفويض إضافي (مثل المصادقة التكيفية أو التصعيد step up or adaptive authentication) للأنظمة الأقل أهمية lower value systems ، و / أو فصل المهام للتطبيقات عالية القيمة high value applications  لفرض ضوابط مكافحة الاحتيال anti-fraud وفقًا لمخاطر التطبيق والاحتيال السابق. | | ✓ | ✓ | 732 |

## المراجع

لمزيد من المعلومات، يمكن أيضاً الاطلاع على:

* [OWASP Testing Guide 4.0: Authorization](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/README.html)
* [OWASP Cheat Sheet: Access Control](https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html)
* [OWASP CSRF Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
* [OWASP REST Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html)
