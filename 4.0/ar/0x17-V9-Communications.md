# ت9: الاتصالات

## الهدف من ضوابط الأمان

تأكد من أن التطبيق الذي يتم التحقق منه يحقق المتطلبات عالية المستوى التالية:

* فرض TLS أو تشفير قوي ، بغض النظر عن حساسية المحتوى.
* اتبع أحدث الإرشادات ، بما في ذلك:
  * إرشادات التكوين.
  * الخوارزميات المفضلة.
* تجنب الخوارزميات الضعيفة أو التي سيتم إهمالها قريبًا ، إلا كملاذ أخير (في حال عدم وجود حل بديل).
* تعطيل الخوارزميات المهملة أو المعروفة غير الآمنة.

وتحقق من تضمين المتطلبات التالية:

* كن على اطلاع دائم بنصائح الصناعة الموصى بها بشأن تكوين TLS الآمن ، حيث يتغير كثيرًا (غالبًا بسبب الانقطاعات الكارثية في الخوارزميات والنصوص المشفرة ciphers الموجودة).
* كن على اطلاع دائم بنصائح الصناعة الموصى بها بشأن تكوين TLS الآمن ، حيث يتغير كثيرًا (غالبًا بسبب الانقطاعات الكارثية في الخوارزميات والنصوص المشفرة ciphers الموجودة).
* تحقق من التكوين الخاص بك بشكل دوري للتأكد من أن الاتصال الآمن موجود دائمًا وفعال.

## ق1.9 أمان اتصالات العميل

تأكد من إرسال جميع رسائل العميل عبر شبكات مشفرة ، باستخدام TLS 1.2 أو أحدث.
استخدم أدوات محدثة لمراجعة تكوين العميل على أساس منتظم.

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.1.9** | تحقق من استخدام TLS لجميع اتصالات العميل ، ولا يعود fall back  إلى الاتصالات غير الآمنة أو غير المشفرة. ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 319 |
| **2.1.9** | تحقق من استخدام أدوات اختبار TLS المحدثَة والتي تقوم بتمكين مجموعة الخوارزميات القويةcipher suites  فقط، مع تعيين مجموعة الخوارزميات القوية على أنها المفضلة. | ✓ | ✓ | ✓ | 326 |
| **3.1.9** | تحقق من تفعيل آخر إصدار موصى به فقط من من بروتوكول TLS والخوارزميات والتكوين ، مثل TLS 1.2 و TLS 1.3. يجب أن يكون أحدث إصدار من بروتوكول TLS هو الخيار المفضل. | ✓ | ✓ | ✓ | 326 |

## ق2.9 أمان اتصالات المخدم

اتصالات الخادم Server communications هي أكثر من مجرد HTTP. يجب أن تكون الاتصالات الآمنة من وإلى الأنظمة الأخرى ، مثل أنظمة المراقبة ، وأدوات الإدارة ، والوصول عن بُعد remote access و SSH ، والبرمجيات الوسيطة middleware ، وقاعدة البيانات ، والحواسيب المركزية mainframes ، وأنظمة الشريك أو المصدر الخارجي partner or external source systems  - في مكانها الصحيح. كل هذه الأشياء يجب أن تكون مشفرة لمنع "من الصعب من الخارج ، ومن السهل للغاية اعتراضها من الداخل hard on the outside, trivially easy to intercept on the inside ".

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.2.9** | تحقق من أن الاتصالات من وإلى الخادم تستخدم شهادات TLS الموثوقة. عند استخدام الشهادات التي تم توليدها داخليًا internally generated  أو الموقعة ذاتيًا self-signed ، يجب تكوين الخادم بحيث يثق فقط في المراجع المصدقة الداخلية internal CAs والشهادات الموقعة ذاتيًا self-signed certificates والتي تم تحديدها ويجب رفض كل الآخرين. | | ✓ | ✓ | 295 |
| **2.2.9** | تحقق من استخدام الاتصالات المشفرة مثل TLS لجميع الاتصالات الواردة والصادرة ، بما في ذلك اتصالات منافذ الإدارة ، والمراقبة ، والمصادقة ، و API ، أو استدعاء خدمة الويب web service calls ، وقاعدة البيانات ، والسحابة ، serverless ، والحاسوب المركزي mainframe ، والخارجية واتصالات الشركاء partner connections. يجب ألا يعود fall back الخادم إلى البروتوكولات غير الآمنة أو غير المشفرة. | | ✓ | ✓ | 319 |
| **3.2.9** | تحقق من مصادقة جميع الاتصالات المشفرة بالأنظمة الخارجية التي تتضمن معلومات أو وظائف حساسة. | | ✓ | ✓ | 287 |
| **4.2.9** | تحقق من تمكين وتكوين إبطال الشهادة المناسبة ، مثل تدبيس بروتوكول حالة الشهادة عبر الإنترنت Online Certificate Status Protocol (OCSP) Stapling. | | ✓ | ✓ | 299 |
| **5.2.9** | تحقق من تسجيل حالات فشل اتصال TLS من جهة الخادم. | | | ✓ | 544 |

## المراجع

لمزيد من المعلومات، يمكن أيضاً الاطلاع على:

* [OWASP – TLS Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html)
* [OWASP - Pinning Guide](https://owasp.org/www-community/controls/Certificate_and_Public_Key_Pinning)
* ملاحظات حول "أنماط TLS المعتمدة":
    * في الماضي ، أشارت ASVS إلى المعيار الأمريكي FIPS 140-2 ، ولكن كمعيار عالمي ، قد يكون تطبيق المعايير الأمريكية صعبًا أو متناقضًا أو محيرًا للتطبيق. 
    * تتمثل الطريقة الأفضل لتحقيق التوافق مع القسم 9.1 في مراجعة الأدلة مثل  [TLS من جانب الخادم من Mozilla (Mozilla's Server Side TLS)](https://wiki.mozilla.org/Security/Server_Side_TLS) أو [إنشاء تكوينات جيدة معروفة (generate known good configurations)](https://mozilla.github.io/server-side-tls/ssl-config-generator/)، واستخدام أدوات تقييم TLS محدثة ومعروفة للحصول على المستوى المطلوب من الأمان.
