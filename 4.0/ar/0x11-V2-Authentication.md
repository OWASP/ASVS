# ت2: المصادقة

## الهدف من ضوابط الأمان

المصادقة هي عملية تأكيد شخص ما (أو شيء ما) على أنه حقيقي وموثوق به وأن الادعاءات التي يقدمها شخص أو جهاز ما صحيحة ومقاومة لانتحال الهوية وتمنع استرداد كلمات المرور أو اعتراضها Interception.

عندما تم إصدار ASVS لأول مرة ، كان اسم المستخدم + كلمة المرور أكثر أشكال المصادقة شيوعًا خارج أنظمة الأمان المشددة. تم قبول المصادقة متعددة العوامل Multi-factor Authentication (MFA)  بشكل عام في دوائر الأمان security circles  ولكنها نادرًا ما تكون مطلوبة في أي مكان آخر. مع زيادة عدد عمليات اختراق كلمات المرور ، تعارضت فكرة أن أسماء المستخدمين سرية إلى حد ما وكلمات المرور غير معروفة مع العديد من ضوابط الأمان وجعلت منها ضوابط غير مقبولة. على سبيل المثال ، يعتبر NIST 800-63 أسماء المستخدمين والمصادقة المستندة إلى المعرفة Knowledge Based Authentication (KBA)  بمثابة معلومات عامة وتعتبر كل من إشعارات الرسائل القصيرة والبريد الإلكتروني على أنها أنواع مصادقة "مقيدة" "restricted" authenticator types وتعتبر كلمات المرور على أنها مخترقة مسبقًا. وهذا في الواقع يجعل المصادقات القائمة على المعرفة ، واستعادة الرسائل القصيرة والبريد الإلكتروني ، وسجل كلمات المرور ، والتعقيد complexity ، وضوابط التدويرrotation controls  عديمة الفائدة. لطالما كانت هذه الضوابط أقل فائدة ، وغالبًا ما تجبر المستخدمين على ابتكار كلمات مرور ضعيفة كل بضعة أشهر ، ولكن مع ظهور أكثر من 5 مليارات عملية اختراق لاسم المستخدم وكلمة المرور ، فقد حان الوقت للمضي قدمًا.

من بين جميع الفصول في ASVS ، تغيرت فصول المصادقة وإدارة الجلسة أكثر من غيرها. سيكون تبنَي ممارسة رائدة فعالة وقائمة على الأدلة تحدياً كبيراً بالنسبة للكثيرين ، وهذا أمر جيد تمامًا. علينا أن نبدأ الانتقال إلى مستقبل ما بعد كلمة المرور الآن.

## NIST 800-63 - معيار مصادقة حديث قائم على الأدلة

[NIST 800-63b](https://pages.nist.gov/800-63-3/sp800-63b.html) هو معيار حديث قائم على الأدلة ، ويمثل أفضل اقتراح متاح ، بغض النظر عن قابلية التطبيق. المعيار مفيد لجميع المنظمات في جميع أنحاء العالم ولكنه وثيق الصلة بشكل خاص بالوكالات الأمريكية وتلك التي تتعامل معها.

يمكن أن تكون مصطلحات NIST 800-63 مربكة بعض الشيء في البداية ، خاصة إذا كنت تستخدم فقط المصادقة التقليدية (اسم المستخدم + كلمة المرور). تعتبر التطورات في المصادقة الحديثة ضرورية ، لذلك يتعين علينا تقديم مصطلحات ستصبح شائعة في المستقبل ، إننا ندرك أن هناك صعوبة الفهم لغاية استقرار الصناعة على هذه المصطلحات الجديدة. لقد قدمنا قائمة مصطلحات في نهاية هذا الفصل للمساعدة. لقد أعدنا صياغة العديد من المتطلبات لتحقيق الغاية الرئيسية منها، بدلاً من نص المتطلب. على سبيل المثال ، يستخدم ASVS مصطلح "كلمة المرور password" عندما يستخدم NIST "السر المحفوظ "memorized secret   في جميع فقرات هذا المعيار.

تم ملائمة ت2 المصادقة، ت3 إدارة الجلسات وبدرجة أقل ت4 التحكم في الوصول لتكون مجموعة فرعية متوافقة من ضوابط NIST 800-63b المحددة ، والتي تركز على التهديدات الشائعة ونقاط الضعف الشائعة في المصادقة. عندما يكون الامتثال الكامل لـ NIST 800-63 مطلوبًا ، يرجى الرجوع إلى NIST 800-63.

### اختيار مستوى NIST AAL المناسب

حاول معيار التحقق من أمان التطبيقات تعيين ASVS L1 لمتطلبات NIST AAL1 و L2 إلى AAL2 و L3 إلى AAL3. ومع ذلك ، فإن نهج المستوى 1 في ASVS كضوابط  "أساسية" قد لا يكون بالضرورة هو مستوى AAL الصحيح للتحقق من تطبيق أو واجهة برمجة تطبيقات API. على سبيل المثال ، إذا كان التطبيق عبارة عن تطبيق من المستوى 3 أو لديه متطلبات تنظيمية ليكون AAL3 ، فيجب اختيار المستوى 3 في الفصلين ت2 و ت3. يجب إجراء اختيار مستوى تأكيد المصادقة Authentication Assertion Level (AAL)  المتوافق مع NIST وفقًا لإرشادات NIST 800-63b كما هو موضح في تحديد AAL في [NIST 800-63b Section 6.2](https://pages.nist.gov/800-63-3/sp800-63-3.html#AAL_CYOA).

## فقرة توضيحية

في كثير من الأحيان تحتاج التطبيقات لمتطلبات تفوق متطلبات المستوى الحالي خاصة إذا كان التطبيق يستخدم المصادقة الحديثة. سابقاً، إذا كان ASVS يتطلب المصادقة متعددة العوامل كمتطلب أساسي ولكن NIST لا يتطلب ذلك. استخدمنا التصميم الاختياري optional designation  في هذا الفصل للإشارة إلى الحالات التي توصي ASVS باستخدام الضابط فيها، ولكن لا تفرضه. المفاتيح التالية لتوصيات ASVS ضمن هذا المعيار هي في الجدول التالي:

| العلامة | التوصيف |
| :--: | :-- |
| | غير مطلوب |
| o | موصى به، ولكنه غير مطلوب |
| ✓ | مطلوب |

## ق1.2 أمان كلمة المرور

تتضمن كلمات المرور التي تطلق NIST 800-63 عليها اسم "الأسرار المحفوظة Memorized Secrets"، كلمات المرور وأرقام التعريف الشخصية PIN  وأنماط إلغاء القفل unlock patterns واختيار القط الصحيح pick the correct kitten أو عنصر صورة آخر وعبارات المرور passphrases. يتم اعتبارها بشكل عام "شيئًا تعرفه something you know" ، وغالبًا ما تستخدم كمصادقين أحاديي العامل single-factor authenticators. هناك تحديات كبيرة أمام الاستخدام المستمر للمصادقة أحادية العامل ، بما في ذلك المليارات من أسماء المستخدمين وكلمات المرور الصحيحة التي تم تسريبها على الإنترنت ، وكلمات المرور الافتراضية أو الضعيفة ، وجداول قوس قزح rainbow tables والقواميس المنظمة ordered dictionaries لكلمات المرور الأكثر شيوعًا.

يجب أن تشجع التطبيقات المستخدمين بشدة على اسنخدام المصادقة متعددة العوامل ، ويجب أن تسمح للمستخدمين بإعادة استخدام الرموز المميزة tokens التي يمتلكونها بالفعل ، مثل الرموز المميزة FIDO أو U2F ، أو الارتباط بمزود خدمة الاعتماد credential service provider الذي يوفر مصادقة متعددة العوامل.

يوفر مزودو خدمة الاعتماد Credential Service Providers (CSPs)  هوية موحدة للمستخدمين. غالبًا ما يكون لدى المستخدمين أكثر من هوية واحدة federated identity مع العديد من CSPs ، مثل هوية المؤسسة باستخدام Azure AD أو Okta أو Ping Identity أو Google ، أو هوية المستهلك باستخدام Facebook أو Twitter أو Google أو WeChat ، وهذا على سبيل المثال لا الحصر. هذه القائمة ليست إقراراً لهذه الشركات أو الخدمات ، ولكنها مجرد تشجيع للمطورين للنظر في حقيقة أن العديد من المستخدمين لديهم العديد من الهويات الثابتة. يجب أن تفكر المنظمات في التكامل مع هويات المستخدمين الحالية ، وفقًا لملف تعريف المخاطر الخاص بقوة CSP في إثبات الهوية risk profile of the CSP's strength of identity proofing. على سبيل المثال ، من غير المحتمل أن تقبل منظمة حكومية هوية وسائل التواصل الاجتماعي كمعلومات تسجيل دخول للأنظمة الحساسة ، حيث أنه من السهل إنشاء هويات مزيفة أو التخلص منها ، في حين أن شركة ألعاب الهاتف المحمول قد تحتاج إلى الاندماج مع منصات الوسائط الاجتماعية الرئيسية لتنمية قاعدة اللاعبين النشطين.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.1.2** | تحقق من أن طول كلمات المرور التي يقوم المستخدم بتعيينها لا يقل عن 12 حرفًا (بعد دمج مسافات متعددة).  ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **2.1.2** | تحقق من أن كلمات المرور المكونة من 64 حرفًا أو أكثر مسموح بها ويجب ألا تزيد عن 128 حرفًا. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **3.1.2** | تحقق من عدم تنفيذ اقتطاع truncation كلمة المرور. ومع ذلك ، يمكن استبدال المسافات المتعددة المتتالية بمسافة واحدة. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **4.1.2** | تحقق من السماح باستخدام أي حرف Unicode قابل للطباعة ، بما في ذلك الأحرف المحايدة للغة مثل المسافات والرموز التعبيرية في كلمات المرور. | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **5.1.2** | تحقق من قدرة المستخدمين على تغيير كلمة المرور الخاصة بهم. | ✓ | ✓ | ✓ | 620 | 5.1.1.2 |
| **6.1.2** | تحقق من أن تابع تغيير كلمة المرور يتطلب كلمة المرور الحالية والجديدة للمستخدم. | ✓ | ✓ | ✓ | 620 | 5.1.1.2 |
| **7.1.2** | Vتحقق من فحص كلمات المرور المرسلة أثناء عمليات تسجيل الحساب وتسجيل الدخول وتغيير كلمة المرور مقابل مجموعة من كلمات المرور المخترقة إما محليًا (مثل أكثر 1000 كلمة مرور أو 10000 كلمة مرور شائعة تتطابق مع سياسة النظام لكلمة مرور) أو باستخدام واجهة برمجة تطبيقات خارجية. في حالة استخدام واجهة برمجة التطبيقات ، يجب استخدام zero knowledge proof أو أي آلية أخرى لضمان عدم إرسال كلمة مرور بشكل صريح أو استخدامها للتحقق من حالة كلمة المرور. إذا تم اختراقها، يجب أن يطلب التطبيق من المستخدم تعيين كلمة مرور جديدة غير مخترقة. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **8.1.2** | تحقق من توفير مقياس قوة كلمة المرور password strength meter لمساعدة المستخدمين على تعيين كلمة مرور أقوى. | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **9.1.2** | تحقق من عدم وجود قواعد بناء كلمة مرور password composition rules تحد من نوع الأحرف المسموح بها. يجب ألا تكون هناك متطلبات للأحرف الكبيرة أو الصغيرة أو الأرقام أو الأحرف الخاصة. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **10.1.2** | تحقق من عدم وجود متطلبات دورية لتداول بيانات الاعتماد credential rotation أو متطلبات سجل كلمة المرور password history. | ✓ | ✓ | ✓ | 263 | 5.1.1.2 |
| **11.1.2** | تحقق من السماح لـ وظيفة "اللصق paste" ، ومساعدات كلمة مرور المتصفح browser password helpers ، ومديري كلمات المرور الخارجية external password managers. | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |
| **12.1.2** | تحقق من أن المستخدم يمكن أن يختار إما عرض كلمة المرور المقنعة بالكامل  masked password مؤقتًا ، أو عرض آخر حرف مكتوب من كلمة المرور مؤقتًا على الأنظمة الأساسية التي لا توجد فيها هذه الوظيفة كوظيفة مضمنة built-in. | ✓ | ✓ | ✓ | 521 | 5.1.1.2 |

ملاحظة: الهدف من السماح للمستخدم بمشاهدة كلمة المرور الخاصة به أو رؤية الحرف الأخير مؤقتًا هو تحسين إمكانية استخدام إدخال بيانات الاعتماد ، لا سيما فيما يتعلق باستخدام كلمات مرور وعبارات مرور passphrases ومديري كلمات مرور password managers أطول. سبب آخر لتضمين هذا المتطلب هو منع تقارير الاختبار التي تطلب من المنظمات بشكل غير ضروري كتابة تنفيذ برمجي جديد لسلوك حقل كلمة مرور المدمج override built-in platform password field behavior  وذلك لإزالة هذه التجربة الأمنية الحديثة سهلة الاستخدام.

## ق2.2 الأمان العام للمصادق authenticator

تعد سرعة أداة المصادقة ضرورية للتطبيقات المستقبلية. يجب إعادة بناء refactor محقق التطبيق application verifier للسماح بالمصادقين الإضافيين وفقًا لما يرغبه المستخدم ، فضلاً عن السماح للمصادقين المتقاعدين أو غير الآمنين بطريقة منظمة.

تعتبر NIST البريد الإلكتروني والرسائل القصيرة من  [أنواع المصادقة "المقيدة" "restricted" authenticator types](https://pages.nist.gov/800-63-FAQ/#q-b1)، ومن المحتمل إزالتها من NIST 800-63 وبالتالي يتم إزالتها أيضاً من ASVS في وقت ما في المستقبل. يجب أن تخطط التطبيقات لخريطة طريق لا تتطلب استخدام البريد الإلكتروني أو الرسائل القصيرة.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.2.2** | تحقق من أن ضوابط مضادات الأتمتة anti-automation controls  فعالة في تخفيف breached credential testing و brute force وهجمات إغلاق الحساب account lockout attacks. تتضمن هذه الضوابط حظر كلمات المرور المخترقة الأكثر شيوعًا ، أو عمليات الإغلاق الناعمة soft lockouts ، أو تحديد المعدل rate limiting ، أو اختبار CAPTCHA ، أو زيادة التأخيرات باستمرار بين المحاولات، أو قيود على عنوان IP (IP address restrictions)، أو القيود القائمة على المخاطر risk-based restrictions  مثل الموقع، أو أول تسجيل دخول على الجهاز، أو المحاولات الأخيرة لإلغاء قفل الحساب ، وغير ذلك. تحقق من أنه لا يمكن إجراء أكثر من 100 محاولة فاشلة في الساعة على حساب واحد. | ✓ | ✓ | ✓ | 307 | 5.2.2 / 5.1.1.2 / 5.1.4.2 / 5.1.5.2 |
| **2.2.2** | تحقق من أن استخدام المصادق الضعيف weak authenticator (مثل الرسائل القصيرة والبريد الإلكتروني) يقتصر على التحقق الثانوي والموافقة على المعاملات وليس كبديل لطرق المصادقة الأكثر أمانًا. تحقق من تقديم طرق أقوى قبل الطرق الضعيفة ، أو أن المستخدمين على دراية بالمخاطر ، أو أن الإجراءات المناسبة موجودة للحد من مخاطر اختراق الحساب. | ✓ | ✓ | ✓ | 304 | 5.2.10 |
| **3.2.2** | تحقق من إرسال الإشعارات الآمنة secure notifications إلى المستخدمين بعد التحديثات على تفاصيل المصادقة ، مثل إعادة تعيين بيانات الاعتماد credential resets ، أو تغيير البريد الإلكتروني أو العنوان ، أو تسجيل الدخول من مواقع غير معروفة أو خطرة. يُفضل استخدام إشعارات الدفع push notifications - بدلاً من الرسائل القصيرة أو البريد الإلكتروني - ، ولكن في حالة عدم وجود إشعارات الدفع ، فإن استخدام الرسائل القصيرة أو البريد الإلكتروني مقبول طالما لم يتم الكشف عن أي معلومات حساسة في الإشعار. | ✓ | ✓ | ✓ | 620 | |
| **4.2.2** | تحقق من مقاومة انتحال الهوية impersonation resistance ضد التصيد الاحتيالي phishing ، مثل استخدام المصادقة متعددة العوامل ، أو أجهزة التشفير بقصد cryptographic devices with intent (مثل المفاتيح المتصلة مع الدفع connected keys with a push  للمصادقة) ، أو الشهادات من جهة العميل عند مستويات أعلى من AAL. | | | ✓ | 308 | 5.2.5 |
| **5.2.2** | تحقق من أنه في حالة فصل مزود خدمة الاعتماد (CSP) عن تطبيق التحقق من المصادقة ، فإن TLS المصادق عليه بشكل متبادل موجود بين نقطتي النهاية. | | | ✓ | 319 | 5.2.6 |
| **6.2.2** | تحقق من مقاومة إعادة التشغيل replay resistance  من خلال الاستخدام الإلزامي لأجهزة كلمات المرور لمرة واحدة One-time Passwords (OTP) أو مصادقوا التشفير cryptographic authenticators أو رموز البحث lookup codes. | | | ✓ | 308 | 5.2.8 |
| **7.2.2** | تحقق من نية المصادقة من خلال طلب إدخال OTP token أو إجراء بدأه المستخدم مثل الضغط على زر على مفتاح جهاز FIDO. | | | ✓ | 308 | 5.2.9 |

## ق3.2 دورة حياة المصادق authenticator

المصادقة عبارة عن كلمات مرور ورموز إلكترونية soft tokens ورموز للأجهزة hardware tokens وأجهزة قياس حيوية biometric devices. تعد دورة حياة المصادقين أمرًا بالغ الأهمية لأمان التطبيق - إذا كان بإمكان أي شخص تسجيل حساب بنفسه بدون دليل على الهوية ، فستكون الثقة أقل في تأكيد الهوية. بالنسبة لمواقع التواصل الاجتماعي مثل Reddit ، هذا جيد تمامًا. بالنسبة للأنظمة المصرفية ، يعد التركيز الأكبر على تسجيل وإصدار بيانات الاعتماد والأجهزة أمرًا بالغ الأهمية لأمن التطبيق.

ملاحظة: لا يشترط أن يكون لكلمات المرور عمر أعظمي أو أن تخضع كلمة المرور للتدوير rotation . يجب فحص كلمات المرور للتأكد إذا تم اختراقها أو لا يتم تغييرها بانتظام.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.3.2** | تحقق من أن كلمات المرور الأولية أو رموز التنشيط rotation التي تم إنشاؤها بواسطة النظام ويتم توليدها بشكل عشوائي وآمن، ويجب ألا يقل طولها عن 6 خانات ، وقد تحتوي على أحرف وأرقام ، وتنتهي صلاحيتها بعد فترة قصيرة من الوقت. يجب ألا يُسمح لهذه الأسرار الأولية initial secrets  بأن تصبح كلمة مرور طويلة المدى. | ✓ | ✓ | ✓ | 330 | 5.1.1.2 / A.3 |
| **2.3.2** | تحقق من دعم التسجيل واستخدام أجهزة المصادقة التي يوفرها المستخدم ، مثل رموز U2F أو FIDO. | | ✓ | ✓ | 308 | 6.1.3 |
| **3.3.2** | تحقق من إرسال تعليمات التجديد مع إتاحة الوقت الكافي لتجديد المصادقين المقيدين time bound authenticators. | | ✓ | ✓ | 287 | 6.1.4 |

## ق4.2 تخزين بيانات الاعتماد

يجب على مهندسي المعمارية والمطورين الالتزام بهذا القسم عند بناء أو إعادة بناء الشيفرة المصدرية. لا يمكن التحقق من هذا القسم بالكامل إلا باستخدام مراجعة الشيفرة المصدرية source code review  أو من خلال secure unit or integration tests. لا يمكن لاختبار الاختراق تحديد أي من هذه المشكلات.

تم تفصيل قائمة one-way key derivation functions  المعتمدة في NIST 800-63 B القسم 5.1.1.2 ، وفي  [BSI Kryptographische Verfahren: Empfehlungen und Schlussell&auml;ngen (2018)](https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.pdf?__blob=publicationFile). يمكن اختيار أحدث خوارزمية وطنية أو إقليمية ومعايير طول المفتاح بدلاً من هذه الاختيارات.

لا يمكن تنفيذ اختبار الاختراق للتحقق من متطلبات هذا القسم ، لذلك لم يتم تمييز الضوابط على أنها L1. ومع ذلك ، فإن هذا القسم له أهمية حيوية لأمان بيانات الاعتماد في حالة سرقتها ، لذلك عند تفريع  (forking) ASVS للحصول على إرشادات معمارية أو كتابة شيفرة مصدرية أو قائمة مراجعة أو قائمة تحقق لمراجعة الشيفرة المصدرية، يرجى إعادة الضوابط هذه إلى L1 في إصدارك الخاص.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.4.2** | تحقق من تخزين كلمات المرور بشكل يقاوم الهجمات التي لا تحتاج لاتصال بالإنترنت. يجب استخدام salt مع كلمات المرور وتجزئتها hashed باستخدام one-way key derivation function أو وظيفة تجزئة كلمة المرور password hashing function. تأخذ وظائف اشتقاق المفاتيح وتجزئة كلمة المرور كل من كلمة المرور وقيمة salt وعامل تكلفة cost factor  كمدخلات عند إنشاء hash لكلمة المرور. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **2.4.2** | تحقق من أن قيمة salt يبلغ طوله 32 بتًا على الأقل وأن يتم اختياره بشكل عشوائي لتقليل تصادمات قيمة salt (salt value collisions) بين التجزئات المخزنة .يجب تخزين قيمة salt فريدة والتجزئة الناتجة لكل بيانات اعتماد. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **3.4.2** | تحقق من أنه في حالة استخدام PBKDF2 ، يجب أن يكون عدد التكرار iteration كبيرًا بقدر ما يسمح به أداء خادم التحقق ، وعادةً ما لا يقل عن 100،000 تكرار. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **4.4.2** | تحقق من أنه في حالة استخدام bcrypt، يجب أن يكون عامل العمل work factor كبيرًا بالقدر الذي يسمح به أداء خادم التحقق ، بالحد الآدنى 10. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 916 | 5.1.1.2 |
| **5.4.2** | تحقق من إجراء تكرار إضافي لـ key derivation function ، باستخدام قيمة salt تكون سرية ومعروفة فقط للمدققverifier . قم بتوليد قيمة salt باستخدام مولد بت عشوائي معتمد  random bit generator [SP 800-90Ar1] وقدّم على الأقل الحد الأدنى من قوة الأمان المحددة minimum security strength  في أحدث مراجعة من SP 800-131A. يجب تخزين قيمة salt السرية (secret salt value) بشكل منفصل عن كلمات المرور المجزأة hashed passwords  (على سبيل المثال ، في جهاز متخصص مثل وحدة أمان الأجهزة hardware security module). | | ✓ | ✓ | 916 | 5.1.1.2 |

عند ذكر المعايير الأمريكية ، يمكن استخدام معيار إقليمي أو محلي بدلاً من أو بالإضافة إلى معيار الولايات المتحدة كما هو مطلوب.

## ق5.2 استعادة بيانات الاعتماد

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.5.2** | تحقق من عدم إرسال التنشيط الأولي initial activation للنظام أو سر الاسترداد initial activation  بنص واضح للمستخدم. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **2.5.2** | تحقق من عدم وجود تلميحات كلمة المرور أو المصادقة المستندة إلى المعرفة (ما يسمى "الأسئلة السرية"). | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **3.5.2** | التحقق من أن استعادة بيانات اعتماد كلمة المرور لا يكشف كلمة المرور الحالية بأي شكل من الأشكال. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **4.5.2** | تحقق من عدم وجود الحسابات المشتركة أو الافتراضية (مثل "root" أو "admin" أو "sa"). | ✓ | ✓ | ✓ | 16 | 5.1.1.2 / A.3 |
| **5.5.2** | تحقق من أنه في حالة تغيير عامل المصادقة authentication factor أو استبداله ، يتم إعلام المستخدم بهذا الحدث. | ✓ | ✓ | ✓ | 304 | 6.1.2.3 |
| **6.5.2** | تحقق من استخدام مسارات استرداد آمنة في حال نسيان كلمة المرور أو استخدام طريقة استعادة أخرى، مثل OTP المستندة إلى الوقت time-based OTP (TOTP)  أو soft token آخر، أو دفع الهاتف المحمول mobile push ، أو آلية استرداد أخرى في وضع عدم الاتصال. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 640 | 5.1.1.2 |
| **7.5.2** | تحقق من أنه في حالة فقد OTP أو عوامل المصادقة متعددة العوامل ، يتم إجراء إثبات الهوية على نفس المستوى كما هو الحال أثناء التسجيل. | | ✓ | ✓ | 308 | 6.1.2.3 |

## ق6.2 البحث عن المحقق السري Look-up Secret Verifier

أسرار البحث Look up secrets هي قوائم مُنشأة مسبقًا من الرموز السرية ، على غرار أرقام تفويض المعاملات Transaction Authorization Numbers  (TAN) ، أو رموز الاسترداد في تطبيقات التواصل الاجتماعي، أو شبكة تحتوي على مجموعة من القيم العشوائية. يتم توزيعها بشكل آمن على المستخدمين. يتم استخدام رموز البحث هذه مرة واحدة ، وبمجرد استخدام كل عناصر القائمة ، يتم تجاهلها بالكامل. يعتبر هذا النوع من المصادقة "شيئًا لديك something you have".

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.6.2** | تحقق من إمكانية استخدام أسرار البحث lookup secrets  مرة واحدة فقط. | | ✓ | ✓ | 308 | 5.1.2.2 |
| **2.6.2** | تحقق من أن أسرار البحث lookup secrets  تمتلك عشوائية كافية (112 بت من الانتروبيا entropy) ، أو إذا كان أقل من 112 بت من الانتروبيا ، مع قيمة salt فريدة وعشوائية بطول 32 بت ومجزئة hashed باستخدام تجزئة أحادية الاتجاه معتمدة. | | ✓ | ✓ | 330 | 5.1.2.2 |
| **3.6.2** | تحقق من أن أسرار البحث مقاومة للهجمات التي لا تحتاج لانترنت offline attacks ، مثل القيم المتوقعة predictable values. | | ✓ | ✓ | 310 | 5.1.2.2 |

## ق7.2 المدقق خارج النطاق

في الماضي ، كان المدقق خارج النطاق out of band verifier الأكثر شيوعاً هو عبارة عن بريد إلكتروني أو رسالة نصية قصيرة تحتوي على رابط إعادة تعيين كلمة المرور. يستخدم المهاجمون هذه الآلية الضعيفة لإعادة تعيين الحسابات التي لا يوجد لديهم تحكم بها، مثل الاستيلاء على حساب البريد الإلكتروني لشخص ما وإعادة استخدام أي روابط استرداد reset links تم اكتشافها. هناك طرق أفضل للتعامل مع التحقق خارج النطاق.

المصادقون الآمنون خارج النطاق Secure out of band authenticators  هم أجهزة فيزيائية يمكنها التواصل مع المدقق عبر قناة ثانوية آمنة. تشمل الأمثلة دفع الإشعارات إلى الأجهزة المحمولة. يعتبر هذا النوع من المصادقة "شيئًا لديك". عندما يرغب المستخدم في المصادقة ، يرسل تطبيق التحقق رسالة إلى المصادق خارج النطاق عبر اتصال بالمصادق بشكل مباشر أو غير مباشر من خلال خدمة طرف ثالث third party service. تحتوي الرسالة على رمز مصادقة (عادةً ما يكون رقمًا عشوائيًا مكونًا من ستة أرقام أو مربع حوار موافقة مشروطة modal approval dialog). ينتظر تطبيق التحقق استلام رمز المصادقة من خلال القناة الأساسية ويقارن تجزئة القيمة المستلمة بتجزئة رمز المصادقة الأصلي. إذا كانت متطابقة ، يمكن أن يفترض المدقق خارج النطاق أن المستخدم قد قام بالمصادقة.

يفترض ASVS أن عددًا قليلاً فقط من المطورين سوف يطورون مصادقات جديدة خارج النطاق ، مثل دفع الإشعارات ، وبالتالي تنطبق عناصر تحكم ASVS التالية على أدوات التحقق ، مثل واجهة برمجة تطبيقات المصادقة authentication API وتطبيقات تسجيل الدخول الأحادي. في حالة تطوير مصادق جديد خارج النطاق ، يرجى الرجوع إلى NIST 800-63B &sect; 5.1.3.1.

لا يتم السماح للمصادقين غير الآمنين خارج النطاق مثل البريد الإلكتروني و VOIP. مصادقة PSTN و SMS "مقيدة" حاليًا بواسطة NIST ويجب التوقف عن استخدامها واستخدام دفع الإشعارات أو ما شابه ذلك. إذا كنت بحاجة إلى استخدام مصادقة خارج النطاق عبر الهاتف أو الرسائل النصية القصيرة ، فيرجى الاطلاع على &sect; 5.1.3.3.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.7.2** | تحقق من أن المصادقين خارج النطاق ("المقيدة" في NIST)  الذين يستخدمون النص الواضح  ، مثل SMS أو PSTN ، لا يتم تقديمهم افتراضيًا ، ويتم تقديم بدائل أقوى مثل دفع الإشعارات أولاً. | ✓ | ✓ | ✓ | 287 | 5.1.3.2 |
| **2.7.2** | تحقق من انتهاء صلاحية المدقق خارج النطاق لطلبات المصادقة أو الرموز codes أو الرموز المميزة tokens  خارج النطاق بعد 10 دقائق. | ✓ | ✓ | ✓ | 287 | 5.1.3.2 |
| **3.7.2** | تحقق من أن طلبات المصادقة أو الرموزcodes أو الرموز المميزة tokens  لأداة التحقق خارج النطاق قابلة للاستخدام مرة واحدة فقط ، ولطلب المصادقة الأصلي فقط. | ✓ | ✓ | ✓ | 287 | 5.1.3.2 |
| **4.7.2** | تحقق من أن طلبات المصادقة أو الرموزcodes أو الرموز المميزة tokens  لأداة التحقق خارج النطاق قابلة للاستخدام مرة واحدة فقط ، ولطلب المصادقة الأصلي فقط. | ✓ | ✓ | ✓ | 523 | 5.1.3.2 |
| **5.7.2** | تحقق من أن المدقق خارج النطاق يحتفظ فقط بإصدار مجزأ  من رمز المصادقة hashed version of the authentication code. | | ✓ | ✓ | 256 | 5.1.3.2 |
| **6.7.2** | تحقق من أن رمز المصادقة الأولي يتم إنشاؤه بواسطة مولد رقم عشوائي آمن ، يحتوي على 20 بت على الأقل من الانتروبيا (عادةً ما يكفي ستة خانات عشوائية رقمية). | | ✓ | ✓ | 310 | 5.1.3.2 |

## ق8.2 التحقق مرة واحدة أو متعددة العوامل

كلمات المرور أحادية الاستخدام (OTPs) هي رموز physical أو soft تعرض تحديًا عشوائيًا زائفًا لمرة واحدة متغير باستمرار pseudo-random one-time challenge. تجعل هذه الأجهزة التصيدphishing  (انتحال الهوية impersonation ) أمرًا صعبًا ، ولكنه ليس مستحيلًا. يعتبر هذا النوع من المصادقة "شيئًا لديك". تتشابه الرموز المميزة متعددة العوامل Multi-factor tokens مع رموز OTP أحادية العامل single-factor OTPs ، ولكنها تتطلب رمز PIN صالحًا أو إلغاء قفل المقاييس الحيوية biometric unlocking أو إدخال  USB (USB insertion) أو اقتران NFC (NFC pairing) أو بعض القيم الإضافية (مثل حاسبات توقيع المعاملات transaction signing calculators) ليتم إدخالها لإنشاء كلمة المرور لمرة واحدة (OTP) النهائية final OTP.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.8.2** | تحقق من أن كلمات المرور لمرة واحدة المستندة إلى الوقت  time-based OTPs لها عمر محدد قبل انتهاء صلاحيتها. | ✓ | ✓ | ✓ | 613 | 5.1.4.2 / 5.1.5.2 |
| **2.8.2** | تحقق من أن المفاتيح المتناظرة symmetric keys المستخدمة للتحقق من OTPs محمية بدرجة كبيرة ، مثل استخدام وحدة أمان للأجهزة hardware security module  أو تخزين مفاتيح يعتمد على نظام التشغيل الآمن operating system based key storage. | | ✓ | ✓ | 320 | 5.1.4.2 / 5.1.5.2|
| **3.8.2** | تحقق من استخدام خوارزميات التشفير المعتمدة في إنشاء ، وتوزيع ، والتحقق من OTPs. | | ✓ | ✓ | 326 | 5.1.4.2 / 5.1.5.2 |
| **4.8.2** | تحقق من أن كلمات المرور لمرة واحدة المستندة إلى الوقت  time-based OTPs يمكن استخدامها مرة واحدة فقط خلال فترة الصلاحية. | | ✓ | ✓ | 287 | 5.1.4.2 / 5.1.5.2 |
| **5.8.2** | تحقق من أنه في حالة إعادة استخدام رمز OTP متعدد العوامل المستند إلى الوقت time-based multi-factor OTP token  خلال فترة الصلاحية ، يتم تسجيله logged  ورفضه مع إرسال إشعارات آمنة إلى حامل الجهاز. | | ✓ | ✓ | 287 | 5.1.5.2 |
| **6.8.2** | تحقق من إمكانية إبطال مولد OTP الفيزيائي أحادي العامل physical single-factor OTP generator  في حالة السرقة أو أي خسارة أخرى. تأكد من أن الإلغاء ساري المفعول على الفور عبر الجلسات التي تم تسجيل الدخول إليها ، بغض النظر عن الموقع. | | ✓ | ✓ | 613 | 5.2.1 |
| **7.8.2** | تحقق من إمكانية إبطال مولد OTP الفيزيائي أحادي العامل physical single-factor OTP generator  في حالة السرقة أو أي خسارة أخرى. تأكد من أن الإلغاء ساري المفعول على الفور عبر الجلسات التي تم تسجيل الدخول إليها ، بغض النظر عن الموقع. | | o | ✓ | 308 | 5.2.3 |

## ق9.2 التحقق من برامج وأجهزة التشفير

مفاتيح أمان التشفير هي بطاقات ذكية smart cards أو مفاتيح FIDO ، حيث يتعين على المستخدم توصيل جهاز التشفير بالكمبيوتر أو إقرانه لإكمال المصادقة. يرسل المحققون تحديًا غير متكرر challenge nonce إلى أجهزة أو برامج التشفير ، ويقوم الجهاز أو البرنامج بإنشاء استجابة اعتماداً على مفتاح تشفير مخزن بشكل آمن.

متطلبات أجهزة وبرامج التشفير أحادي العامل وأجهزة وبرامج التشفير متعددة العوامل هي نفسها ، حيث يثبت التحقق من مصادق التشفير cryptographic authenticator امتلاك عامل المصادقة authentication factor.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.9.2** | تحقق من تخزين مفاتيح التشفير المستخدمة في التحقق بشكل آمن ومحمي ضد الكشف ، مثل استخدام وحدة النظام الأساسي الموثوق Trusted Platform Module (TPM) أو وحدة أمان الأجهزة Hardware Security Module (HSM)، أو خدمة نظام التشغيل التي يمكنها استخدام هذا التخزين الآمن. | | ✓ | ✓ | 320 | 5.1.7.2 |
| **2.9.2** | تحقق من أن التحدي غير المكرر challenge nonceيبلغ طوله 64 بت على الأقل ، وأنه فريد إحصائيًا أو فريدًا خلال فترة عمر جهاز التشفير cryptographic device. | | ✓ | ✓ | 330 | 5.1.7.2 |
| **3.9.2** | تحقق من أن التحدي غير المكرر challenge nonceيبلغ طوله 64 بت على الأقل ، وأنه فريد إحصائيًا أو فريدًا خلال فترة عمر جهاز التشفير cryptographic device. | | ✓ | ✓ | 327 | 5.1.7.2 |

## ق10.2 مصادقة الخدمة

لا يمكن تنفيذ اختبار الاختراق للتحقق من متطلبات هذا القسم، لذلك لا يتضمن أي متطلبات L1، ومع ذلك ، إذا تم استخدامه في معمارية أو تشفير أو مراجعة آمنة للشيفرة المصدرية، فيرجى افتراض أن البرنامج (تمامًا مثل Java Key Store) هو الحد الأدنى من المتطلبات في L1. تخزين الأسرارsecrets بشكلها الصريح غير مقبول تحت أي ظرف من الظروف.

| # | التوصيف | L1 | L2 | L3 | CWE | [NIST &sect;](https://pages.nist.gov/800-63-3/sp800-63b.html) |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **1.10.2** | لا يمكن تنفيذ اختبار الاختراق للتحقق من متطلبات هذا القسم، لذلك لا يتضمن أي متطلبات L1، ومع ذلك ، إذا تم استخدامه في معمارية أو تشفير أو مراجعة آمنة للشيفرة المصدرية، فيرجى افتراض أن البرنامج (تمامًا مثل Java Key Store) هو الحد الأدنى من المتطلبات في L1. تخزين الأسرارsecrets بشكلها الصريح غير مقبول تحت أي ظرف من الظروف. | | OS assisted | HSM | 287 | 5.1.1.1 |
| **2.10.2** | تحقق من أنه إذا كانت كلمات المرور مطلوبة لمصادقة الخدمة ، فإن حساب الخدمة الذي تم استخدامه لا يمتلك بيانات اعتماد افتراضية. (على سبيل المثال ، يكون root / root أو admin / admin افتراضيًا في بعض الخدمات أثناء التثبيت). | | OS assisted | HSM | 255 | 5.1.1.1 |
| **3.10.2** | تحقق من تخزين كلمات المرور بحماية كافية لمنع هجمات الاسترداد في وضع عدم الاتصال بالانترنت offline recovery attacks، بما في ذلك الوصول إلى النظام المحلي. | | OS assisted | HSM | 522 | 5.1.1.1 |
| **4.10.2** | تحقق من إدارة كلمات المرور والتكامل مع قواعد البيانات وأنظمة الجهات الخارجية third-party systems والتوزيع  seedsوالأسرار الداخلية ومفاتيح واجهة برمجة التطبيقات  API keysبشكل آمن وتحقق من عدم تضمينها في الشيفرة المصدرية أو تخزينها في مستودعات الشيفرة المصدرية repositories. يجب أن يقاوم هذا التخزين الهجمات في وضع عدم الاتصال بالانترنت. يوصى باستخدام مخزن مفاتيح آمن للبرامج (L1) أو جهاز TPM أو HSM (L3) لتخزين كلمات المرور. | | OS assisted | HSM | 798 | |

## المتطلبات الإضافية للوكالة الأمريكية

الوكالات الأمريكية لديها متطلبات إلزامية بخصوص NIST 800-63. لطالما كان معيار التحقق من أمان التطبيقات يشكل حوالي 80٪ من ضوابط الأمان التي تنطبق على ما يقارب 100٪ من التطبيقات ، على خلاف الضوابط الأمنية 20٪ المتبقية والتي هي من الضوابط المتقدمة أو تلك التي لديها إمكانية تطبيق محدودة. على هذا النحو ، فإن ASVS هي مجموعة فرعية صارمة من NIST 800-63 ، خاصة لتصنيفات IAL1 / 2 و AAL1 / 2 ، ولكنها ليست شاملة بما فيه الكفاية ، لا سيما فيما يتعلق بتصنيفات IAL3 / AAL3..

نحث الوكالات الحكومية الأمريكية بشدة على مراجعة وتنفيذ NIST 800-63 بالكامل.

## قائمة المصطلحات

| المصطلح | المعنى |
| -- | -- |
| CSP | Credential Service Provider يُطلق على مزود خدمة الاعتماد أيضًا اسم مزود الهوية. |
| المصادق | Authenticator الكود البرمجي الذي يصادق على كلمة المرور والرمز المميز token و MFA والتأكيد الموحد federated assertion وما إلى ذلك. |
| المدقق | Verifier "كيان يتحقق من هوية المدعي عن طريق التحقق من حيازة المدعي والتحكم فيه على واحد أو اثنين من المصادقين باستخدام بروتوكول مصادقة. للقيام بذلك ، قد يحتاج المدقق أيضًا إلى التحقق من صحة بيانات الاعتماد التي تربط المصادق (المصادقين) بمعرف المشترك والتحقق وضعهم ". |
| OTP | One-time password كلمة السر لمرة واحدة |
| SFA | Single-factor authenticators المصادقة أحادية العامل ، مثل شيء تعرفه something you know (الأسرار المحفوظة memorized secrets ، وكلمات المرور ، وعبارات المرور passphrases ، وأرقام التعريف الشخصية PINs) ، أو شيء ما أنت عليه something you are  (القياسات الحيوية biometrics ، أو بصمات الأصابع fingerprint ، أو مسح الوجه face scans) ، أو شيء لديك something you have (رموز OTP ، جهاز تشفير cryptographic device  مثل البطاقة الذكية something you have)|
| MFA | Multi-factor authentication مصادقة متعددة العوامل ، والتي تتضمن عاملين منفصلين أو أكثر |

## المراجع

لمزيد من المعلومات، يمكن أيضاً الاطلاع على:

* [NIST 800-63 - Digital Identity Guidelines](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf)
* [NIST 800-63 A - Enrollment and Identity Proofing](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63a.pdf)
* [NIST 800-63 B - Authentication and Lifecycle Management](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63b.pdf)
* [NIST 800-63 C - Federation and Assertions](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63c.pdf)
* [NIST 800-63 FAQ](https://pages.nist.gov/800-63-FAQ/)
* [OWASP Testing Guide 4.0: Testing for Authentication](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/04-Authentication_Testing/README.html)
* [OWASP Cheat Sheet - Password storage](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)
* [OWASP Cheat Sheet - Forgot password](https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html)
* [OWASP Cheat Sheet - Choosing and using security questions](https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
