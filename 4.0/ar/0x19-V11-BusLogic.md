# ت11: منطق الأعمال

## الهدف من ضوابط الأمان

تأكد من أن التطبيق الذي يتم التحقق منه يفي بالمتطلبات عالية المستوى التالية:

* تدفق منطق الأعمال متسلسل ومعالج بالترتيب ولا يمكن تجاوزه.
* يتضمن منطق الأعمال حدودًا لاكتشاف ومنع الهجمات الآلية ، مثل التحويلات المستمرة للأموال الصغيرة ، أو إضافة مليون صديق واحدًا تلو الآخر ، وما إلى ذلك.
* تدفقات منطق الأعمال ذات القيمة العالية تأخذ بعين الاعتبار حالات الإساءة abuse cases والجهات الفاعلة الخبيثة ، ولديها وسائل حماية ضد الانتحال spoofing  والعبث tampering  والكشف عن المعلومات information disclosure  ورفع مستوى هجمات الصلاحيات elevation of privilege attacks.

## ق1.11 أمان منطق الأعمال

يعتبر أمن منطق الأعمال فرديًا جدًا لكل تطبيق بحيث لن يتم تطبيق قائمة تحقق واحدة على الإطلاق. يجب تصميم أمان منطق الأعمال للحماية من التهديدات الخارجية المحتملة - لا يمكن إضافته باستخدام جدران حماية تطبيقات الويب أو الاتصالات الآمنة. نوصي باستخدام نمذجة التهديد threat modeling  أثناء سباقات التصميم design sprints ، على سبيل المثال باستخدام OWASP Cornucopia أو أدوات مماثلة.

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.1.11** | تحقق من أن التطبيق سيعالج فقط تدفقات منطق الأعمال لنفس المستخدم بترتيب خطوات متسلسل وبدون تخطي الخطوات. | ✓ | ✓ | ✓ | 841 |
| **2.1.11** | تحقق من أن التطبيق سيعالج تدفقات منطق الأعمال فقط مع معالجة جميع الخطوات في وقت بشري واقعي ، أي لا يتم إرسال المعامَلات transactions بسرعة كبيرة.| ✓ | ✓ | ✓ | 799 |
| **3.1.11** | تحقق من أن التطبيق لديه حدود مناسبة لإجراءات أو معاملات transactions تجارية معينة يتم فرضها بشكل صحيح على أساس كل مستخدم. | ✓ | ✓ | ✓ | 770 |
| **4.1.11** | تحقق من أن التطبيق يحتوي على ضوابط لمكافحة الأتمتة ضد الاستدعاءات المفرطة مثل استخراج البيانات الجماعية  mass data exfiltration ، أو طلبات منطق العمل business logic requests ، أو رفع الملفات ، أو هجمات تعطيل الخدمة denial of service attacks. | ✓ | ✓ | ✓ | 770 |
| **5.1.11** | تحقق من أن التطبيق يحتوي على حدود منطق الأعمال أو التحقق من الصحة للحماية من مخاطر أو تهديدات الأعمال المحتملة ، والتي تم تحديدها باستخدام نمذجة التهديد أو منهجيات مماثلة. | ✓ | ✓ | ✓ | 841 |
| **6.1.11** | تحقق من أن التطبيق لا يعاني من مشكلات "وقت التحقق حتى وقت الاستخدام Time Of Check to Time Of Use" (TOCTOU)" أو ظروف السباق الأخرى race conditions  للعمليات الحساسة. | | ✓ | ✓ | 367 |
| **7.1.11** | تحقق من مراقبة التطبيق للأحداث أو الأنشطة غير العادية من منظور منطق الأعمال. على سبيل المثال ، محاولات تنفيذ إجراءات خارج النظام أو إجراءات لن يحاول المستخدم العادي تنفيذها أبدًا. ([C9](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 754 |
| **8.1.11** | تحقق من أن التطبيق يحتوي على تنبيهات قابلة للتكوين configurable alerting  عند اكتشاف هجمات آلية أو نشاط غير عادي. | | ✓ | ✓ | 390 |

## المراجع

لمزيد من المعلومات، يمكن أيضاً الاطلاع على:

* [OWASP Web Security Testing Guide 4.1: Business Logic Testing](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/10-Business_Logic_Testing/README.html)
* يمكن تحقيق مكافحة الأتمتة بعدة طرق ، بما في ذلك استخدام  [OWASP AppSensor](https://github.com/jtmelton/appsensor) and [OWASP Automated Threats to Web Applications](https://owasp.org/www-project-automated-threats-to-web-applications/)
* [OWASP AppSensor](https://github.com/jtmelton/appsensor) •	يمكن تحقيق مكافحة الأتمتة بعدة طرق ، بما في ذلك استخدام.
* [OWASP Cornucopia](https://owasp.org/www-project-cornucopia/)
