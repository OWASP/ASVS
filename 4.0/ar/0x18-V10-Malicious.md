# ت10: الشيفرة الضارة  Malicious Code

## الهدف من ضوابط الأمان

تأكد من أن الشيفرة المصدرية تلبي المتطلبات عالية المستوى التالية:

* يتم التعامل مع الأنشطة الضارة بأمان وبشكل صحيح حتى لا تؤثر على بقية أنشطة التطبيق.
* لا تحتوي على قنابل موقوتة زمنية time bombs  أو هجمات أخرى على أساس زمني time-based attacks.
* لا تقوم بالاتصال بوجهات خبيثة أو غير مصرح بها "phone home" to malicious or unauthorized destinations.
* لا يحتوي على أبواب خلفية back doors ، أو بيض عيد الفصح Easter eggs ، أو هجمات salami ، أو rootkits ، أو شيفرة مصدرية غير مصرح بها يمكن للمهاجم التحكم فيه.

العثور على الشيفرة البرمجية الضارة هو حكم خاطئ Proof of negative، ويستحيل التحقق من صحته تمامًا. يجب بذل أفضل الجهود لضمان عدم احتواء الشيفرة المصدرية على تعليمات برمجية ضارة أو وظائف غير مرغوب فيها.

## ق1.10 سلامة الشيفرة المصدري

أفضل دفاع ضد التعليمات البرمجية الضارة هو "كن واثقاً، ولكن تحقق trust, but verify ". غالبًا ما يكون إدخال تعليمات برمجية ضارة أو غير مصرح بها في التعليمات البرمجية جريمة جنائية في العديد من الولايات القضائية. يجب أن توضَح السياسات والإجراءات كل العقوبات المتعلقة بالشيفرات المصدرية الخبيثة.

يجب على المطورين الرئيسيين مراجعة عمليات التحقق من التعليمات البرمجية code check-ins  بانتظام ، خاصة تلك التي قد تصل إلى وظائف الوقت أو المدخلات / المخرجات أو الشبكة time, I/O, or network functions.

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.1.10** | تحقق من استخدام أداة تحليل التعليمات البرمجية التي يمكنها اكتشاف التعليمات البرمجية التي يُحتمل أن تكون ضارة ، مثل وظائف الوقت وعمليات الملفات غير الآمنة واتصالات الشبكة. | | | ✓ | 749 |

## ق10.2 البحث عن الشيفرة المصدرية

الشيفرة الخبيثة نادرة للغاية ويصعب اكتشافها. يمكن أن تساعد المراجعة اليدوية للشيفرة المصدرية سطرًا بسطر في البحث عن القنابل المنطقية logical bombs، ولكن حتى مراجعي الكود الأكثر خبرة سيبذلوا جهداً كبيراً ويعانوا للعثور على تعليمات برمجية ضارة حتى لو كانوا يعلمون بوجودها.

لا يمكن الالتزام بهذا القسم بدون الوصول الكامل إلى الشيفرة المصدرية ، بما في ذلك المكتبات الخارجية third-party libraries.

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.2.10** | تحقق من أن الشيفرة المصدرية للتطبيق والمكتبات الخارجية لا تحتوي على إمكانات جمع البيانات أو الاتصال الهاتفي غير المصرح به unauthorized phone home . في حالة وجود هذه الوظيفة ، يجب الحصول على إذن المستخدم لتشغيلها قبل جمع أي بيانات. | | ✓ | ✓ | 359 |
| **2.2.10** | تحقق من أن التطبيق لا يطلب أذونات غير ضرورية أو مفرطة للميزات أو المستشعرات المتعلقة بالخصوصية ، مثل جهات الاتصال أو الكاميرات أو الميكروفونات أو الموقع. | | ✓ | ✓ | 272 |
| **3.2.10** | تحقق من أن الشيفرة المصدرية للتطبيق والمكتبات الخارجية لا تحتوي على أبواب خلفية Backdoors، مثل الحسابات أو المفاتيح المكتوبة داخل الشيفرة المصدرية hard-coded أو الإضافية غير الموثقة ، أو تمويه الشيفرة المصدرية code obfuscation ، أو undocumented binary blobs ، أو rootkits، أو ميزات تصحيح الأخطاء غير الآمنة  insecure debugging أو مكافحة التصحيح anti-debugging ، أو وظائف غير آمنة أو مخفية أو منتهية الصلاحية والتي يمكن استخدامها بشكل ضار إذا تم اكتشافها. | | | ✓ | 507 |
| **4.2.10** | تحقق من أن الشيفرة المصدرية للتطبيق والمكتبات الخارجية لا تحتوي على قنابل موقوتة time bombs من خلال البحث عن الوظائف ذات الصلة بالتاريخ والوقت. | | | ✓ | 511 |
| **5.2.10** | تحقق من أن الشيفرة المصدرية للتطبيق والمكتبات الخارجية لا تحتوي على شيفرة مصدرية ضارة ، مثل هجمات salami أو التجاوزات المنطقية logic bypasses أو القنابل المنطقية logic bombs. | | | ✓ | 511 |
| **6.2.10** | تحقق من أن الشيفرة المصدرية للتطبيق والمكتبات الخارجية لا تحتوي على بيض عيد الفصح Easter eggs أو أي وظائف أخرى يحتمل أن تكون غير مرغوب فيها. | | | ✓ | 507 |

## ق10.3 سلامة التطبيق

بمجرد نشر التطبيق ، لا يزال من الممكن تضمين الشيفرة المصدرية الضارة. تحتاج التطبيقات إلى حماية نفسها من الهجمات الشائعة ، مثل تنفيذ تعليمات برمجية غير موقعة من مصادر غير موثوقة executing unsigned code from untrusted sources  وعمليات الاستحواذ على النطاق الفرعي subdomain takeovers.

من المحتمل أن يكون الامتثال لهذا القسم تشغيليًا ومستمرًا.

| # | التوصيف | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **1.3.10** | تحقق من أنه إذا كان التطبيق يحتوي على ميزة التحديث التلقائي للعميل أو الخادم ، فيجب الحصول على التحديثات عبر القنوات الآمنة وتوقيعها رقميًا. يجب أن يتحقق رمز التحديث من صحة التوقيع الرقمي للتحديث قبل تثبيت التحديث أو تنفيذه. | ✓ | ✓ | ✓ | 16 |
| **2.3.10** | تحقق من أن التطبيق يستخدم وسائل حماية السلامة integrity protections ، مثل توقيع الشيفرة المصدريةcode signing  أو سلامة المصدر الفرعي subresource integrity. يجب ألا يقوم التطبيق بتحميل أو تنفيذ تعليمات برمجية من مصادر غير موثوق بها ، مثل تحميل تضمينات includes، أو وحدات modules، أو مكونات إضافية plugins ، أو شيفرة مصدرية ، أو مكتبات من مصادر غير موثوق بها أو من الإنترنت. | ✓ | ✓ | ✓ | 353 |
| **3.3.10** | تحقق من أن التطبيق يتمتع بالحماية من عمليات الاستحواذ على النطاق الفرعي subdomain takeovers  إذا كان التطبيق يعتمد على إدخالات DNS (DNS Entries) أو نطاقات DNS الفرعية (DNS Subdomains)، مثل أسماء المجال منتهية الصلاحية ، أو مؤشرات DNS أو CNAMEs القديمة ، أو المشاريع منتهية الصلاحية في مستودع الشيفرة المصدرية العام public source code repos ، أو واجهات برمجة التطبيقات السحابية العابرة transient cloud APIs ، أو وظائف بدون خادم serverless functions ، أو دلاء التخزين storage buckets  (autogen-bucket-id.cloud.example.com) أو ما شابه ذلك. يمكن أن تشمل الحماية التأكد من أن أسماء DNS التي تستخدمها التطبيقات يتم فحصها بانتظام من أجل انتهاء الصلاحية أو التغيير. | ✓ | ✓ | ✓ | 350 |

## المراجع

* [Hostile Subdomain Takeover, Detectify Labs](https://labs.detectify.com/2014/10/21/hostile-subdomain-takeover-using-herokugithubdesk-more/)
* [Hijacking of abandoned subdomains part 2, Detectify Labs](https://labs.detectify.com/2014/12/08/hijacking-of-abandoned-subdomains-part-2/)
